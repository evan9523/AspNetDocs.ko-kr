---
uid: identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
title: 비어 있거나 기존 Web Forms 프로젝트에 ASP.NET Identity 추가-ASP.NET 4.x
author: raquelsa
description: 이 자습서에서는 ASP.NET 응용 프로그램에 ASP.NET Identity (ASP.NET에 대 한 멤버 자격 시스템)를 추가 하는 방법을 보여 줍니다. 새 Web Forms 또는 MVC를 만들 때 ...
ms.author: riande
ms.date: 01/22/2019
ms.assetid: 1cbc0ed2-5bd6-4b62-8d34-4c193dcd8b25
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/getting-started/adding-aspnet-identity-to-an-empty-or-existing-web-forms-project
msc.type: authoredcontent
ms.openlocfilehash: 8e82951d57f0b8052ee3f6530a7470be7d030206
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78471977"
---
# <a name="adding-aspnet-identity-to-an-empty-or-existing-web-forms-project"></a><span data-ttu-id="bf07b-104">비어 있는 또는 기존 Web Forms 프로젝트에 ASP.NET Identity 추가</span><span class="sxs-lookup"><span data-stu-id="bf07b-104">Adding ASP.NET Identity to an Empty or Existing Web Forms Project</span></span>

> <span data-ttu-id="bf07b-105">이 자습서에서는 ASP.NET 응용 프로그램에 [ASP.NET Identity](introduction-to-aspnet-identity.md) (ASP.NET에 대 한 새 멤버 자격 시스템)를 추가 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-105">This tutorial shows you how to add [ASP.NET Identity](introduction-to-aspnet-identity.md) (the new membership system for ASP.NET) to an ASP.NET application.</span></span>
> 
> <span data-ttu-id="bf07b-106">개별 계정으로 Visual Studio 2017 RTM에서 새 Web Forms 또는 MVC 프로젝트를 만들 때 Visual Studio는 필요한 모든 패키지를 설치 하 고 필요한 모든 클래스를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-106">When you create a new Web Forms or MVC project in Visual Studio 2017 RTM with Individual Accounts, Visual Studio will install all the required packages and add all necessary classes for you.</span></span> <span data-ttu-id="bf07b-107">이 자습서에서는 기존 Web Forms 프로젝트 또는 새 빈 프로젝트에 ASP.NET Identity 지원을 추가 하는 단계를 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-107">This tutorial will illustrate the steps to add ASP.NET Identity support to your existing Web Forms project or a new empty project.</span></span> <span data-ttu-id="bf07b-108">설치 해야 하는 모든 NuGet 패키지와 추가 해야 하는 클래스에 대해 간략하게 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-108">I will outline all the NuGet packages you need to install, and classes you need to add.</span></span> <span data-ttu-id="bf07b-109">사용자 관리 및 인증에 대 한 모든 주요 진입점 Api를 강조 표시 하는 동시에 새 사용자를 등록 하 고 로그인 하는 샘플 Web Forms에 대해 자세히 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-109">I will go over sample Web Forms for registering new users and logging in while highlighting all main entry point APIs for user management and authentication.</span></span> <span data-ttu-id="bf07b-110">이 샘플에서는 Entity Framework를 기반으로 하는 SQL 데이터 저장소에 대 한 ASP.NET Identity 기본 구현을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-110">This sample will use the ASP.NET Identity default implementation for SQL data storage which is built on Entity Framework.</span></span> <span data-ttu-id="bf07b-111">이 자습서에서는 SQL database에 대해 LocalDB를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-111">This tutorial, we will use LocalDB for the SQL database.</span></span>
> 

## <a name="get-started-with-aspnet-identity"></a><span data-ttu-id="bf07b-112">ASP.NET Identity 시작</span><span class="sxs-lookup"><span data-stu-id="bf07b-112">Get started with ASP.NET Identity</span></span>

1. <span data-ttu-id="bf07b-113">[Visual Studio 2017](https://visualstudio.microsoft.com/downloads/)을 설치 하 고 실행 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-113">Start by installing and running [Visual Studio 2017](https://visualstudio.microsoft.com/downloads/).</span></span>
2. <span data-ttu-id="bf07b-114">시작 페이지에서 **새 프로젝트** 를 선택 하거나 메뉴를 사용 하 여 **파일**, **새 프로젝트**를 차례로 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-114">Select **New Project** from the Start page, or you can use the menu and select **File**, and then **New Project**.</span></span>
3. <span data-ttu-id="bf07b-115">왼쪽 창에서 **시각적 개체 C#** 를 확장 한 다음 **웹**, **ASP.NET 웹 응용 프로그램 (.net Framework)** 을 차례로 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-115">In the left pane, expand **Visual C#**, then select **Web**, then **ASP.NET Web Application (.Net Framework)**.</span></span> <span data-ttu-id="bf07b-116">프로젝트 이름을 "WebFormsIdentity"로 선택 하 고 **확인을**선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-116">Name your project "WebFormsIdentity" and select **OK**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image17.png)
4. <span data-ttu-id="bf07b-117">**새 ASP.NET 프로젝트** 대화 상자에서 **빈** 템플릿을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-117">In the **New ASP.NET Project** dialog, select the **Empty** template.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image2.png)  
  
   <span data-ttu-id="bf07b-118">**인증 변경** 단추를 사용할 수 없으며이 템플릿에 인증 지원이 제공 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-118">Notice the **Change Authentication** button is disabled and no authentication support is provided in this template.</span></span> <span data-ttu-id="bf07b-119">Web Forms, MVC 및 Web API 템플릿을 사용 하 여 인증 방법을 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-119">The Web Forms, MVC and Web API templates allow you to select the authentication approach.</span></span>

## <a name="add-identity-packages-to-your-app"></a><span data-ttu-id="bf07b-120">앱에 Id 패키지 추가</span><span class="sxs-lookup"><span data-stu-id="bf07b-120">Add Identity packages to your app</span></span>

<span data-ttu-id="bf07b-121">솔루션 탐색기에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **NuGet 패키지 관리**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-121">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="bf07b-122">**Microsoft. n.** n e t. n e t. n e t.</span><span class="sxs-lookup"><span data-stu-id="bf07b-122">Search for and install the **Microsoft.AspNet.Identity.EntityFramework** package.</span></span> 
  
![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image15.png)
  
<span data-ttu-id="bf07b-123">이 패키지는 종속성 패키지를 설치 합니다. **Entityframework** 및 **Microsoft ASP.NET Identity Core**를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="bf07b-123">Note that this package will install the dependency packages: **EntityFramework** and **Microsoft ASP.NET Identity Core**.</span></span>

## <a name="add-a-web-form-to-register-users"></a><span data-ttu-id="bf07b-124">사용자를 등록 하는 웹 양식 추가</span><span class="sxs-lookup"><span data-stu-id="bf07b-124">Add a web form to register users</span></span>

1. <span data-ttu-id="bf07b-125">**솔루션 탐색기**에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **추가**를 선택한 다음 **Web Form**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-125">In **Solution Explorer**, right-click your project and select **Add**, and then **Web Form**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image4.png)
2. <span data-ttu-id="bf07b-126">**항목 이름 지정** 대화 상자에서 새 **웹 폼의**이름을 지정 하 고 **확인** 을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-126">In the **Specify Name for Item** dialog box, name the new web form **Register**, and then select **OK**</span></span>
3. <span data-ttu-id="bf07b-127">생성 된 *Register .aspx* 파일의 태그를 아래 코드로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-127">Replace the markup in the generated *Register.aspx* file with the code below.</span></span> <span data-ttu-id="bf07b-128">코드 변경 내용은 강조 표시되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-128">The code changes are highlighted.</span></span> 

    [!code-html[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample1.aspx?highlight=9,12-40)]

    > [!NOTE]
    > <span data-ttu-id="bf07b-129">이는 새 ASP.NET Web Forms 프로젝트를 만들 때 생성 되는 간단한 버전의 *Register .aspx* 파일 일 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-129">This is just a simplified version of the *Register.aspx* file that is created when you create a new ASP.NET Web Forms project.</span></span> <span data-ttu-id="bf07b-130">위의 태그는 양식 필드와 새 사용자를 등록 하는 단추를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-130">The markup above adds form fields and a button to register a new user.</span></span>
4. <span data-ttu-id="bf07b-131">*Register.aspx.cs* 파일을 열고 파일의 내용을 다음 코드로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-131">Open the *Register.aspx.cs* file and replace the contents of the file with the following code:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample2.cs)]

    > [!NOTE] 
    > 
    > 1. <span data-ttu-id="bf07b-132">위의 코드는 새 ASP.NET Web Forms 프로젝트를 만들 때 생성 되는 *Register.aspx.cs* 파일의 단순화 된 버전입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-132">The code above is a simplified version of the *Register.aspx.cs* file that is created when you create a new ASP.NET Web Forms project.</span></span>
    > 2. <span data-ttu-id="bf07b-133">*IdentityUser* 클래스는 *IUser* 인터페이스의 기본 entityframework 구현입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-133">The *IdentityUser* class is the default EntityFramework implementation of the *IUser* interface.</span></span> <span data-ttu-id="bf07b-134">*IUser* 인터페이스는 ASP.NET Identity Core의 사용자에 대 한 최소 인터페이스입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-134">*IUser* interface is the minimal interface for a user on ASP.NET Identity Core.</span></span>
    > 3. <span data-ttu-id="bf07b-135">*Userstore* 클래스는 사용자 저장소의 기본 entityframework 구현입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-135">The *UserStore* class is the default EntityFramework implementation of a user store.</span></span> <span data-ttu-id="bf07b-136">이 클래스는 ASP.NET Identity Core의 최소 인터페이스인 *Iuserstore*, *IUserLoginStore*, *Iuserclaimstore* 및 *iuserrolestore*를 구현 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-136">This class implements the ASP.NET Identity Core's minimal interfaces: *IUserStore*, *IUserLoginStore*, *IUserClaimStore* and *IUserRoleStore*.</span></span>
    > 4. <span data-ttu-id="bf07b-137">*Usermanager* 클래스는 *usermanager*에 변경 내용을 자동으로 저장 하는 사용자 관련 api를 노출 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-137">The *UserManager* class exposes user related APIs which will automatically save changes to the *UserStore*.</span></span>
    > 5. <span data-ttu-id="bf07b-138">*IdentityResult* 클래스는 id 작업의 결과를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-138">The *IdentityResult* class represents the result of an identity operation.</span></span>
5. <span data-ttu-id="bf07b-139">**솔루션 탐색기**에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **추가**를 선택 하 고, **ASP.NET 폴더를 추가** 하 고, **앱\_데이터**를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-139">In **Solution Explorer**, right-click your project and select **Add**, **Add ASP.NET Folder** and then **App\_Data**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image5.png)
6. <span data-ttu-id="bf07b-140">*Web.config* 파일을 열고 사용자 정보를 저장 하는 데 사용할 데이터베이스에 대 한 연결 문자열 항목을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-140">Open the *Web.config* file and add a connection string entry for the database we will use to store user information.</span></span> <span data-ttu-id="bf07b-141">데이터베이스는 Id 엔터티에 대 한 EntityFramework로 런타임에 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-141">The database will be created at runtime by EntityFramework for the Identity entities.</span></span> <span data-ttu-id="bf07b-142">연결 문자열은 새 Web Forms 프로젝트를 만들 때 만든 것과 비슷합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-142">The connection string is similar to one created for you when you create a new Web Forms project.</span></span> <span data-ttu-id="bf07b-143">강조 표시 된 코드는 추가 해야 하는 태그를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-143">The highlighted code shows the markup you should add:</span></span>

    [!code-xml[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample3.xml?highlight=11-14)]
    
    > [!NOTE] 
    > <span data-ttu-id="bf07b-144">Visual Studio 2015 이상에서는 `(localdb)\v11.0`을 연결 문자열의 `(localdb)\MSSQLLocalDB`으로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-144">For Visual Studio 2015 or higher, replace `(localdb)\v11.0` with `(localdb)\MSSQLLocalDB` in your connection string.</span></span>
    
7. <span data-ttu-id="bf07b-145">프로젝트에서 파일 *등록 .aspx* 을 마우스 오른쪽 단추로 클릭 하 고 **시작 페이지로 설정**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-145">Right click file *Register.aspx* in your project and select **Set as Start Page**.</span></span> <span data-ttu-id="bf07b-146">Ctrl + f 5를 눌러 웹 응용 프로그램을 빌드하고 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-146">Press Ctrl + F5 to build and run the web application.</span></span> <span data-ttu-id="bf07b-147">새 사용자 이름 및 암호를 입력 한 다음 **등록**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-147">Enter a new user name and password and then select **Register**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image6.png)  

    > [!NOTE]
    > <span data-ttu-id="bf07b-148">ASP.NET Identity 유효성 검사를 지원 하며이 샘플에서는 Id 코어 패키지에서 제공 되는 사용자 및 암호 유효성 검사기의 기본 동작을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-148">ASP.NET Identity has support for validation and in this sample you can verify the default behavior on User and Password validators that come from the Identity Core package.</span></span> <span data-ttu-id="bf07b-149">사용자 (`UserValidator`)에 대 한 기본 유효성 검사기에는 기본 값이 `true`로 설정 된 속성 `AllowOnlyAlphanumericUserNames` 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-149">The default validator for User (`UserValidator`) has a property `AllowOnlyAlphanumericUserNames` that has default value set to `true`.</span></span> <span data-ttu-id="bf07b-150">암호에 대 한 기본 유효성 검사기 (`MinimumLengthValidator`)는 암호의 6 자 이상이 되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-150">The default validator for Password (`MinimumLengthValidator`) ensures that password has at least 6 characters.</span></span> <span data-ttu-id="bf07b-151">이러한 유효성 검사기는 사용자 지정 유효성 검사를 수행 하려는 경우 재정의할 수 있는 `UserManager`의 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-151">These validators are properties on `UserManager` that can be overridden if you want to have custom validation,</span></span>

## <a name="verify-the-localdb-identity-database-and-tables-generated-by-entity-framework"></a><span data-ttu-id="bf07b-152">Entity Framework에서 생성 된 LocalDb Id 데이터베이스 및 테이블을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-152">Verify the LocalDb Identity database and tables generated by Entity Framework</span></span>

1. <span data-ttu-id="bf07b-153">**보기** 메뉴에서 **서버 탐색기**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-153">In the **View** menu, select **Server Explorer**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image7.png)
2. <span data-ttu-id="bf07b-154">**Defaultconnection (WebFormsIdentity)** 을 확장 하 고 **테이블**을 확장 한 다음 **AspNetUsers** 를 마우스 오른쪽 단추로 클릭 하 고 **테이블 데이터 표시**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-154">Expand **DefaultConnection (WebFormsIdentity)**, expand **Tables**, right-click **AspNetUsers** and then select **Show Table Data**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image8.png)  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image9.png)

## <a name="configure-the-application-for-owin-authentication"></a><span data-ttu-id="bf07b-155">OWIN 인증을 위한 응용 프로그램 구성</span><span class="sxs-lookup"><span data-stu-id="bf07b-155">Configure the application for OWIN authentication</span></span>

<span data-ttu-id="bf07b-156">이 시점에서 사용자 만들기에 대 한 지원도 추가 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-156">At this point we have only added support for creating users.</span></span> <span data-ttu-id="bf07b-157">이제 인증을 추가 하 여 사용자를 로그인 하는 방법을 설명 하겠습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-157">Now, we are going to demonstrate how we can add authentication to login a user.</span></span> <span data-ttu-id="bf07b-158">ASP.NET Identity는 폼 인증을 위해 Microsoft OWIN Authentication 미들웨어를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-158">ASP.NET Identity uses Microsoft OWIN Authentication middleware for forms authentication.</span></span> <span data-ttu-id="bf07b-159">OWIN 쿠키 인증은 [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) 또는 IIS에서 호스트 되는 프레임 워크에서 사용할 수 있는 쿠키 및 클레임 기반 인증 메커니즘입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-159">The OWIN Cookie Authentication is a cookie and claims based authentication mechanism that can be used by any framework hosted on [OWIN](https://msdn.microsoft.com/magazine/dn451439.aspx) or IIS.</span></span> <span data-ttu-id="bf07b-160">이 모델에서는 ASP.NET MVC 및 Web Forms을 포함 하 여 여러 프레임 워크에서 동일한 인증 패키지를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-160">With this model, the same authentication packages can be used across multiple frameworks including ASP.NET MVC and Web Forms.</span></span> <span data-ttu-id="bf07b-161">프로젝트 Katana에 대 한 자세한 내용과 호스트에서 미들웨어를 실행 하는 방법에 대 한 자세한 내용은 [Katana 프로젝트 시작](https://msdn.microsoft.com/magazine/dn451439.aspx)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="bf07b-161">For more information on project Katana and how to run middleware in a host agnostic see [Getting Started with the Katana Project](https://msdn.microsoft.com/magazine/dn451439.aspx).</span></span>

## <a name="install-authentication-packages-to-your-application"></a><span data-ttu-id="bf07b-162">응용 프로그램에 인증 패키지 설치</span><span class="sxs-lookup"><span data-stu-id="bf07b-162">Install authentication packages to your application</span></span>

1. <span data-ttu-id="bf07b-163">솔루션 탐색기에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **NuGet 패키지 관리**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-163">In Solution Explorer, right-click your project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="bf07b-164">***Owin*** 패키지를 검색 하 고 설치 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-164">Search for and install the ***Microsoft.AspNet.Identity.Owin*** package.</span></span> 
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image16.png)

2. <span data-ttu-id="bf07b-165">***Owin 웹*** 패키지를 검색 하 고 설치 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-165">Search for and install the ***Microsoft.Owin.Host.SystemWeb*** package.</span></span>

    > [!NOTE]
    > <span data-ttu-id="bf07b-166">**Owin** 패키지에는 ASP.NET Identity Core 패키지에서 사용 되는 Owin authentication 미들웨어를 관리 하 고 구성 하는 Owin 확장 클래스 집합이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-166">The **Microsoft.Aspnet.Identity.Owin** package contains a set of OWIN extension classes to manage and configure OWIN authentication middleware to be consumed by ASP.NET Identity Core packages.</span></span>
    > <span data-ttu-id="bf07b-167">**Owin 웹** 패키지에는 ASP.NET request 파이프라인을 사용 하 여 IIS에서 Owin 기반 응용 프로그램을 실행할 수 있도록 하는 Owin 서버가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-167">The **Microsoft.Owin.Host.SystemWeb** package contains an OWIN server that enables OWIN-based applications to run on IIS using the ASP.NET request pipeline.</span></span> <span data-ttu-id="bf07b-168">자세한 내용은 [OWIN 미들웨어에서 IIS 통합 파이프라인](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="bf07b-168">For more information see [OWIN Middleware in the IIS integrated pipeline](../../../aspnet/overview/owin-and-katana/owin-middleware-in-the-iis-integrated-pipeline.md).</span></span>

## <a name="add-owin-startup-and-authentication-configuration-classes"></a><span data-ttu-id="bf07b-169">OWIN 시작 및 인증 구성 클래스 추가</span><span class="sxs-lookup"><span data-stu-id="bf07b-169">Add OWIN startup and authentication configuration classes</span></span>

1. <span data-ttu-id="bf07b-170">**솔루션 탐색기**에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **추가**를 선택한 다음 **새 항목 추가**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-170">In **Solution Explorer**, right-click your project, select **Add**, and then **Add New Item**.</span></span> <span data-ttu-id="bf07b-171">검색 텍스트 상자 대화 상자에서 "*owin*"를 입력 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-171">In the search text box dialog, type "*owin*".</span></span> <span data-ttu-id="bf07b-172">클래스 이름을 "*Startup*"으로 선택 하 고 **추가**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-172">Name the class "*Startup*" and select **Add**.</span></span> 
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image11.png)
2. <span data-ttu-id="bf07b-173">Startup.cs 파일에서 아래에 표시 된 강조 표시 된 코드를 추가 하 여 OWIN 쿠키 인증을 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-173">In the Startup.cs file, add the highlighted code shown below to configure OWIN cookie authentication.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample4.cs?highlight=1,3,15-19)]

    > [!NOTE]
    > <span data-ttu-id="bf07b-174">이 클래스는 OWIN 시작 클래스를 지정 하기 위한 `OwinStartup` 특성을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-174">This class contains the `OwinStartup` attribute for specifying the OWIN startup class.</span></span> <span data-ttu-id="bf07b-175">모든 OWIN 응용 프로그램에는 응용 프로그램 파이프라인에 대 한 구성 요소를 지정 하는 startup 클래스가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-175">Every OWIN application has a startup class where you specify components for the application pipeline.</span></span> <span data-ttu-id="bf07b-176">이 모델에 대 한 자세한 내용은 [OWIN 시작 클래스 검색](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) 을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="bf07b-176">See [OWIN Startup Class Detection](../../../aspnet/overview/owin-and-katana/owin-startup-class-detection.md) for more info on this model.</span></span>

## <a name="add-web-forms-for-registering-and-signing-in-users"></a><span data-ttu-id="bf07b-177">사용자 등록 및 로그인을 위한 web forms 추가</span><span class="sxs-lookup"><span data-stu-id="bf07b-177">Add web forms for registering and signing in users</span></span>

1. <span data-ttu-id="bf07b-178">*Register.aspx.cs* 파일을 열고 등록이 성공 하면 사용자에 게 로그인 하는 다음 코드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-178">Open the *Register.aspx.cs* file and add the following code which signs in the user when registration succeeds.</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample5.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="bf07b-179">ASP.NET Identity 및 OWIN 쿠키 인증은 클레임 기반 시스템 이므로 프레임 워크를 사용 하려면 앱 개발자가 사용자에 대 한 [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) 를 생성 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-179">Since ASP.NET Identity and OWIN Cookie Authentication are claims based system, the framework requires the app developer to generate a [ClaimsIdentity](https://msdn.microsoft.com/library/microsoft.identitymodel.claims.claimsidentity.aspx) for the user.</span></span> <span data-ttu-id="bf07b-180">ClaimsIdentity에는 사용자가 속한 역할과 같은 사용자의 모든 클레임에 대 한 정보가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-180">ClaimsIdentity has information about all the claims for the user such as what Roles the user belongs to.</span></span> <span data-ttu-id="bf07b-181">이 단계에서 사용자에 게 더 많은 클레임을 추가할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-181">You can also add more claims for the user at this stage.</span></span>
    > - <span data-ttu-id="bf07b-182">AuthenticationManager에서 OWIN를 사용 하 고 `SignIn`를 호출 하 고 위와 같이 ClaimsIdentity를 전달 하 여 사용자에 게 로그인 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-182">You can sign in the user by using the AuthenticationManager from OWIN and calling `SignIn` and passing in the ClaimsIdentity as shown above.</span></span> <span data-ttu-id="bf07b-183">이 코드는 사용자를 로그인 하 고 쿠키도 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-183">This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="bf07b-184">이 호출은 [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) 모듈에서 사용 하는 [FormAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) 와 유사 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-184">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
2. <span data-ttu-id="bf07b-185">**솔루션 탐색기**에서 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **추가**를 선택한 다음 **Web Form**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-185">In **Solution Explorer**, right-click your project, select **Add**, and then **Web Form**.</span></span> <span data-ttu-id="bf07b-186">웹 폼 **로그인**의 이름을로 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-186">Name the web form **Login**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image12.png)
3. <span data-ttu-id="bf07b-187">*Login.aspx* 파일의 내용을 다음 코드로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-187">Replace the contents of the *Login.aspx* file with the following code:</span></span>

    [!code-aspx[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample6.aspx)]
4. <span data-ttu-id="bf07b-188">*Login.aspx.cs* 파일의 내용을 다음으로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-188">Replace the contents of the *Login.aspx.cs* file with the following:</span></span>

    [!code-csharp[Main](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/samples/sample7.cs)]

    > [!NOTE] 
    > 
    > - <span data-ttu-id="bf07b-189">`Page_Load` 현재 사용자의 상태를 확인 하 고 `Context.User.Identity.IsAuthenticated` 상태에 따라 조치를 취합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-189">The `Page_Load` now checks for the status of current user and takes action based on its `Context.User.Identity.IsAuthenticated` status.</span></span>
    >   <span data-ttu-id="bf07b-190">**로그인 한 사용자 이름 표시** : Microsoft ASP.NET Identity Framework는 로그인 한 사용자에 대 한 `UserName` 및 `UserId`를 가져올 수 있는 [IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) 에 확장 메서드를 추가 했습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-190">**Display Logged in User Name** : The Microsoft ASP.NET Identity Framework has added extension methods on [System.Security.Principal.IIdentity](https://msdn.microsoft.com/library/system.security.principal.iidentity.aspx) that allows you to get the `UserName` and `UserId`  for the logged in User.</span></span> <span data-ttu-id="bf07b-191">이러한 확장 메서드는 `Microsoft.AspNet.Identity.Core` 어셈블리에서 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-191">These extension methods are defined in the `Microsoft.AspNet.Identity.Core` assembly.</span></span> <span data-ttu-id="bf07b-192">이러한 확장 메서드는 [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) 에 대 한 대체 메서드입니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-192">These extension methods are the replacement for [HttpContext.User.Identity.Name](https://msdn.microsoft.com/library/system.web.httpcontext.user.aspx) .</span></span>
    > - <span data-ttu-id="bf07b-193">SignIn method: `This` 메서드는이 샘플의 이전 `CreateUser_Click` 메서드를 대체 하 고 사용자를 성공적으로 만든 후 사용자에 게 로그인 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-193">SignIn method: `This` method replaces the previous `CreateUser_Click` method in this sample and now signs in the user after successfully creating the user.</span></span>   
    >   <span data-ttu-id="bf07b-194">Microsoft OWIN Framework는 `IOwinContext`에 대 한 참조를 가져올 수 있는 `System.Web.HttpContext`에 확장 메서드를 추가 했습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-194">The Microsoft OWIN Framework has added extension methods on `System.Web.HttpContext` that allows you to get a reference to an `IOwinContext`.</span></span> <span data-ttu-id="bf07b-195">이러한 확장 메서드는 `Microsoft.Owin.Host.SystemWeb` 어셈블리에서 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-195">These extension methods are defined in `Microsoft.Owin.Host.SystemWeb` assembly.</span></span> <span data-ttu-id="bf07b-196">`OwinContext` 클래스는 현재 요청에서 사용 가능한 인증 미들웨어 기능을 나타내는 `IAuthenticationManager` 속성을 노출 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-196">The `OwinContext` class exposes an `IAuthenticationManager` property that represents the Authentication middleware functionality available on the current request.</span></span> <span data-ttu-id="bf07b-197">OWIN에서 `AuthenticationManager`를 사용 하 고 `SignIn`를 호출 하 고 위와 같이 `ClaimsIdentity`를 전달 하 여 사용자를 로그인 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-197">You can sign in the user by using the `AuthenticationManager` from OWIN and calling `SignIn` and passing in the `ClaimsIdentity` as shown above.</span></span> <span data-ttu-id="bf07b-198">ASP.NET Identity 및 OWIN 쿠키 인증은 클레임 기반 시스템 이므로 프레임 워크를 사용 하려면 앱에서 사용자에 대 한 `ClaimsIdentity`을 생성 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-198">Because ASP.NET Identity and OWIN Cookie Authentication are claims-based system, the framework requires the app to generate a `ClaimsIdentity` for the user.</span></span> <span data-ttu-id="bf07b-199">`ClaimsIdentity`에는 사용자가 속한 역할 등 사용자에 대 한 모든 클레임에 대 한 정보가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-199">The `ClaimsIdentity` has information about all the claims for the user, such as what roles the user belongs to.</span></span> <span data-ttu-id="bf07b-200">이 단계에서 사용자에 대 한 클레임을 더 추가할 수도 있습니다 .이 코드는 사용자에 게 로그인 하 고 쿠키도 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-200">You can also add more claims for the user at this stage This code will sign in the user and generate a cookie as well.</span></span> <span data-ttu-id="bf07b-201">이 호출은 [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) 모듈에서 사용 하는 [FormAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) 와 유사 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-201">This call is analogous to [FormAuthentication.SetAuthCookie](https://msdn.microsoft.com/library/system.web.security.formsauthentication.setauthcookie.aspx) used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
    > - <span data-ttu-id="bf07b-202">`SignOut` method: OWIN에서 `AuthenticationManager`에 대 한 참조를 가져오고 `SignOut`를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-202">`SignOut` method: Gets a reference to the `AuthenticationManager` from OWIN and calls `SignOut`.</span></span> <span data-ttu-id="bf07b-203">이는 [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) 모듈에서 사용 하는 [SignOut 메서드와 FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) 유사 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-203">This is analogous to [FormsAuthentication.SignOut](https://msdn.microsoft.com/library/system.web.security.formsauthentication.signout.aspx) method used by the [FormsAuthentication](https://msdn.microsoft.com/library/system.web.security.formsauthenticationmodule.aspx) module.</span></span>
5. <span data-ttu-id="bf07b-204">**Ctrl +** f 5를 눌러 웹 응용 프로그램을 빌드하고 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-204">Press **Ctrl + F5** to build and run the web application.</span></span> <span data-ttu-id="bf07b-205">새 사용자 이름 및 암호를 입력 한 다음 **등록**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-205">Enter a new user name and password and then select **Register**.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image13.png)  
   <span data-ttu-id="bf07b-206">참고: 이제 새 사용자가 만들어지고 로그인 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-206">Note: At this point, the new user is created and logged in.</span></span>
6. <span data-ttu-id="bf07b-207">**로그 아웃** 단추를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-207">Select the **Log out** button.</span></span> <span data-ttu-id="bf07b-208">로그인 폼으로 리디렉션됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-208">You are redirected to the Log in form.</span></span>
7. <span data-ttu-id="bf07b-209">잘못 된 사용자 이름 또는 암호를 입력 하 고 **로그인** 단추를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-209">Enter an invalid user name or password and select the **Log in** button.</span></span> 
   <span data-ttu-id="bf07b-210">`UserManager.Find` 메서드는 null을 반환 하 고 오류 메시지를 표시 합니다. " *잘못 된 사용자 이름 또는 암호* "가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="bf07b-210">The `UserManager.Find`  method will return null and the error message: " *Invalid user name or password* " will be displayed.</span></span>
  
    ![](adding-aspnet-identity-to-an-empty-or-existing-web-forms-project/_static/image14.png)

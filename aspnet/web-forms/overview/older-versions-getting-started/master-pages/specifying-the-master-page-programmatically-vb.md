---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
title: 프로그래밍 방식으로 마스터 페이지 지정 (VB) | Microsoft Docs
author: rick-anderson
description: PreInit 이벤트 처리기를 통해 프로그래밍 방식으로 콘텐츠 페이지의 마스터 페이지를 설정 하는 방법을 살펴봅니다.
ms.author: riande
ms.date: 07/28/2008
ms.assetid: 0edcd653-f24a-41aa-aef4-75f868fe5ac2
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-master-page-programmatically-vb
msc.type: authoredcontent
ms.openlocfilehash: 3b039b22bef38ae6ebf80be070820dc1638f87f4
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74618607"
---
# <a name="specifying-the-master-page-programmatically-vb"></a><span data-ttu-id="44b81-103">마스터 페이지를 프로그래밍 방식으로 지정(VB)</span><span class="sxs-lookup"><span data-stu-id="44b81-103">Specifying the Master Page Programmatically (VB)</span></span>

<span data-ttu-id="44b81-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="44b81-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="44b81-105">[코드 다운로드](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) 또는 [PDF 다운로드](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="44b81-105">[Download Code](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.zip) or [Download PDF](https://download.microsoft.com/download/d/6/6/d66ad554-afdd-409e-a5c3-201b774fbb31/ASPNET_MasterPages_Tutorial_09_VB.pdf)</span></span>

> <span data-ttu-id="44b81-106">PreInit 이벤트 처리기를 통해 프로그래밍 방식으로 콘텐츠 페이지의 마스터 페이지를 설정 하는 방법을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-106">Looks at setting the content page's master page programmatically via the PreInit event handler.</span></span>

## <a name="introduction"></a><span data-ttu-id="44b81-107">소개</span><span class="sxs-lookup"><span data-stu-id="44b81-107">Introduction</span></span>

<span data-ttu-id="44b81-108">개최 예제에서는 [*마스터 페이지를 사용 하 여 사이트 전체 레이아웃을 만들기*](creating-a-site-wide-layout-using-master-pages-vb.md)때문에 모든 콘텐츠 페이지에서 `@Page` 지시문의 `MasterPageFile` 특성을 통해 해당 마스터 페이지를 선언적으로 참조 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-108">Since the inaugural example in [*Creating a Site-Wide Layout Using Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md), all content pages have referenced their master page declaratively via the `MasterPageFile` attribute in the `@Page` directive.</span></span> <span data-ttu-id="44b81-109">예를 들어 다음 `@Page` 지시문은 콘텐츠 페이지를 마스터 페이지 `Site.master`에 연결 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-109">For example, the following `@Page` directive links the content page to the master page `Site.master`:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample1.aspx)]

<span data-ttu-id="44b81-110">`System.Web.UI` 네임 스페이스의 [`Page` 클래스](https://msdn.microsoft.com/library/system.web.ui.page.aspx) 에는 콘텐츠 페이지의 마스터 페이지에 대 한 경로를 반환 하는 [`MasterPageFile` 속성이](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) 포함 되어 있습니다. 이 속성은 `@Page` 지시문에 의해 설정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-110">The [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx) in the `System.Web.UI` namespace includes a [`MasterPageFile` property](https://msdn.microsoft.com/library/system.web.ui.page.masterpagefile.aspx) that returns the path to the content page's master page; it is this property that is set by the `@Page` directive.</span></span> <span data-ttu-id="44b81-111">이 속성은 콘텐츠 페이지의 마스터 페이지를 프로그래밍 방식으로 지정 하는 데에도 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-111">This property can also be used to programmatically specify the content page's master page.</span></span> <span data-ttu-id="44b81-112">이 방법은 페이지를 방문 하는 사용자와 같은 외부 요소를 기준으로 마스터 페이지를 동적으로 할당 하려는 경우에 유용 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-112">This approach is useful if you want to dynamically assign the master page based on external factors, such as the user visiting the page.</span></span>

<span data-ttu-id="44b81-113">이 자습서에서는 웹 사이트에 두 번째 마스터 페이지를 추가 하 고 런타임에 사용할 마스터 페이지를 동적으로 결정 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-113">In this tutorial we add a second master page to our website and dynamically decide which master page to use at runtime.</span></span>

## <a name="step-1-a-look-at-the-page-lifecycle"></a><span data-ttu-id="44b81-114">1 단계: 페이지 수명 주기 살펴보기</span><span class="sxs-lookup"><span data-stu-id="44b81-114">Step 1: A Look at the Page Lifecycle</span></span>

<span data-ttu-id="44b81-115">콘텐츠 페이지 ASP.NET 페이지에 대 한 요청이 웹 서버에 도착할 때마다 ASP.NET 엔진은 페이지의 콘텐츠 컨트롤을 마스터 페이지의 해당 ContentPlaceHolder 컨트롤에 퓨즈 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-115">Whenever a request arrives at the web server for an ASP.NET page that is a content page, the ASP.NET engine must fuse the page's Content controls into the master page's corresponding ContentPlaceHolder controls.</span></span> <span data-ttu-id="44b81-116">이 fusion은 일반적인 페이지 수명 주기를 진행할 수 있는 단일 컨트롤 계층 구조를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-116">This fusion creates a single control hierarchy that can then proceed through the typical page lifecycle.</span></span>

<span data-ttu-id="44b81-117">그림 1에서는이 fusion을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-117">Figure 1 illustrates this fusion.</span></span> <span data-ttu-id="44b81-118">그림 1의 1 단계에서는 초기 콘텐츠 및 마스터 페이지 컨트롤 계층 구조를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-118">Step 1 in Figure 1 shows the initial content and master page control hierarchies.</span></span> <span data-ttu-id="44b81-119">PreInit 스테이지의 비상 끝에서 페이지의 콘텐츠 컨트롤은 마스터 페이지의 해당 ContentPlaceHolders 표시자에 추가 됩니다 (2 단계).</span><span class="sxs-lookup"><span data-stu-id="44b81-119">At the tail end of the PreInit stage the Content controls in the page are added to the corresponding ContentPlaceHolders in the master page (Step 2).</span></span> <span data-ttu-id="44b81-120">이 퓨전 후에 마스터 페이지는 퓨즈 컨트롤 계층 구조의 루트로 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-120">After this fusion, the master page serves as the root of the fused control hierarchy.</span></span> <span data-ttu-id="44b81-121">그런 다음이 퓨즈 컨트롤 계층 구조를 페이지에 추가 하 여 완성 된 컨트롤 계층 구조를 생성 합니다 (3 단계).</span><span class="sxs-lookup"><span data-stu-id="44b81-121">This fused control hierarchy is then added to the page to produce the finalized control hierarchy (Step 3).</span></span> <span data-ttu-id="44b81-122">결과적으로 페이지의 컨트롤 계층 구조에는 퓨즈 컨트롤 계층 구조가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-122">The net result is that the page's control hierarchy includes the fused control hierarchy.</span></span>

<span data-ttu-id="44b81-123">[PreInit 단계에서 마스터 페이지 및 콘텐츠 페이지의 컨트롤 계층 구조를 함께 사용할 ![](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-123">[![The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage](specifying-the-master-page-programmatically-vb/_static/image2.png)](specifying-the-master-page-programmatically-vb/_static/image1.png)</span></span>

<span data-ttu-id="44b81-124">**그림 01**: 마스터 페이지 및 콘텐츠 페이지의 컨트롤 계층 구조가 PreInit 단계 중에 함께 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="44b81-124">**Figure 01**: The Master Page and Content Page's Control Hierarchies are Fused Together during the PreInit Stage ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image3.png))</span></span>

## <a name="step-2-setting-themasterpagefileproperty-from-code"></a><span data-ttu-id="44b81-125">2 단계: 코드에서`MasterPageFile`속성 설정</span><span class="sxs-lookup"><span data-stu-id="44b81-125">Step 2: Setting the`MasterPageFile`Property from Code</span></span>

<span data-ttu-id="44b81-126">이 fusion에서 사용 하는 마스터 페이지는 `Page` 개체의 `MasterPageFile` 속성 값에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-126">What master page partakes in this fusion depends on the value of the `Page` object's `MasterPageFile` property.</span></span> <span data-ttu-id="44b81-127">`@Page` 지시문에 `MasterPageFile` 특성을 설정 하면 페이지 수명 주기의 첫 단계인 초기화 단계에서 `Page`의 `MasterPageFile` 속성을 할당 하는 효과가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-127">Setting the `MasterPageFile` attribute in the `@Page` directive has the net effect of assigning the `Page`'s `MasterPageFile` property during the Initialization stage, which is the very first stage of the page's lifecycle.</span></span> <span data-ttu-id="44b81-128">또는 프로그래밍 방식으로이 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-128">We can alternatively set this property programmatically.</span></span> <span data-ttu-id="44b81-129">그러나 그림 1의 퓨전이 발생 하기 전에이 속성을 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-129">However, it is imperative that this property be set before the fusion in Figure 1 takes place.</span></span>

<span data-ttu-id="44b81-130">PreInit 스테이지가 시작 될 때 `Page` 개체는 [`PreInit` 이벤트](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) 를 발생 시키고 해당 [`OnPreInit` 메서드](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx)를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-130">At the start of the PreInit stage the `Page` object raises its [`PreInit` event](https://msdn.microsoft.com/library/system.web.ui.page.preinit.aspx) and calls its [`OnPreInit` method](https://msdn.microsoft.com/library/system.web.ui.page.onpreinit.aspx).</span></span> <span data-ttu-id="44b81-131">마스터 페이지를 프로그래밍 방식으로 설정 하려면 `PreInit` 이벤트에 대 한 이벤트 처리기를 만들거나 `OnPreInit` 메서드를 재정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-131">To set the master page programmatically, then, we can either create an event handler for the `PreInit` event or override the `OnPreInit` method.</span></span> <span data-ttu-id="44b81-132">두 가지 방법을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-132">Let's look at both approaches.</span></span>

<span data-ttu-id="44b81-133">먼저 사이트 홈페이지에 대 한 코드 지향 클래스 파일인 `Default.aspx.vb`를 엽니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-133">Start by opening `Default.aspx.vb`, the code-behind class file for our site's homepage.</span></span> <span data-ttu-id="44b81-134">다음 코드를 입력 하 여 페이지의 `PreInit` 이벤트에 대 한 이벤트 처리기를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-134">Add an event handler for the page's `PreInit` event by typing in the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample2.vb)]

<span data-ttu-id="44b81-135">여기에서 `MasterPageFile` 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-135">From here we can set the `MasterPageFile` property.</span></span> <span data-ttu-id="44b81-136">"~/Site.master" 값을 `MasterPageFile` 속성에 할당 하도록 코드를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-136">Update the code so that it assigns the value "~/Site.master" to the `MasterPageFile` property.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample3.vb)]

<span data-ttu-id="44b81-137">중단점을 설정 하 고 디버깅을 시작 하는 경우 `Default.aspx` 페이지를 방문할 때마다 또는이 페이지에 포스트백이 있을 때마다 `Page_PreInit` 이벤트 처리기가 실행 되 고 `MasterPageFile` 속성이 "~/Site.master"에 할당 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-137">If you set a breakpoint and start with debugging you'll see that whenever the `Default.aspx` page is visited or whenever there's a postback to this page, the `Page_PreInit` event handler executes and the `MasterPageFile` property is assigned to "~/Site.master".</span></span>

<span data-ttu-id="44b81-138">또는 `Page` 클래스의 `OnPreInit` 메서드를 재정의 하 고 여기서 `MasterPageFile` 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-138">Alternatively, you can override the `Page` class's `OnPreInit` method and set the `MasterPageFile` property there.</span></span> <span data-ttu-id="44b81-139">이 예에서는 특정 페이지에서 마스터 페이지를 설정 하지 않고 `BasePage`하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-139">For this example, let's not set the master page in a particular page, but rather from `BasePage`.</span></span> <span data-ttu-id="44b81-140">[*마스터 페이지 자습서에서 제목, 메타 태그 및 기타 HTML 헤더를 지정 하*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) 여 사용자 지정 기본 페이지 클래스 (`BasePage`)를 다시 만들었습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-140">Recall that we created a custom base page class (`BasePage`) back in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb.md) tutorial.</span></span> <span data-ttu-id="44b81-141">현재 `BasePage` `Page` 클래스의 `OnLoadComplete` 메서드를 재정의 합니다 .이 메서드는 사이트 맵 데이터를 기반으로 페이지의 `Title` 속성을 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-141">Currently `BasePage` overrides the `Page` class's `OnLoadComplete` method, where it sets the page's `Title` property based on the site map data.</span></span> <span data-ttu-id="44b81-142">`BasePage` 업데이트 하면 `OnPreInit` 메서드를 재정의 하 여 마스터 페이지를 프로그래밍 방식으로 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-142">Let's update `BasePage` to also override the `OnPreInit` method to programmatically specify the master page.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample4.vb)]

<span data-ttu-id="44b81-143">모든 콘텐츠 페이지가 `BasePage`에서 파생 되기 때문에 이제 모든 콘텐츠 페이지가 해당 마스터 페이지를 프로그래밍 방식으로 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-143">Because all our content pages derive from `BasePage`, all of them now have their master page programmatically assigned.</span></span> <span data-ttu-id="44b81-144">이 시점에서 `Default.aspx.vb`의 `PreInit` 이벤트 처리기는 불필요 합니다. 자유롭게 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-144">At this point the `PreInit` event handler in `Default.aspx.vb` is superfluous; feel free to remove it.</span></span>

### <a name="what-about-thepagedirective"></a><span data-ttu-id="44b81-145">`@Page`지시문은 무엇 인가요?</span><span class="sxs-lookup"><span data-stu-id="44b81-145">What About the`@Page`Directive?</span></span>

<span data-ttu-id="44b81-146">약간의 혼란 스 러 울 수 있는 것은 `BasePage` 클래스의 `OnPreInit` 메서드에서 프로그래밍 방식으로, 그리고 각 콘텐츠 페이지의 `@Page` 지시문에서 `MasterPageFile` 특성을 통해 콘텐츠 페이지의 `MasterPageFile` 속성을 두 위치에서 지정 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-146">What may be a little confusing is that the content pages' `MasterPageFile` properties are now being specified in two places: programmatically in the `BasePage` class's `OnPreInit` method as well as through the `MasterPageFile` attribute in each content page's `@Page` directive.</span></span>

<span data-ttu-id="44b81-147">페이지 수명 주기의 첫 번째 단계는 초기화 단계입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-147">The first stage in the page lifecycle is the Initialization stage.</span></span> <span data-ttu-id="44b81-148">이 단계에서 `Page` 개체의 `MasterPageFile` 속성에는 `@Page` 지시문 (제공 된 경우)의 `MasterPageFile` 특성 값이 할당 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-148">During this stage the `Page` object's `MasterPageFile` property is assigned the value of the `MasterPageFile` attribute in the `@Page` directive (if it is provided).</span></span> <span data-ttu-id="44b81-149">PreInit 단계는 초기화 단계를 따르고 `Page` 개체의 `MasterPageFile` 속성을 프로그래밍 방식으로 설정 하 여 `@Page` 지시문에서 할당 된 값을 덮어씁니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-149">The PreInit stage follows the Initialization stage, and it is here where we programmatically set the `Page` object's `MasterPageFile` property, thereby overwriting the value assigned from the `@Page` directive.</span></span> <span data-ttu-id="44b81-150">`Page` 개체의 `MasterPageFile` 속성을 프로그래밍 방식으로 설정 하기 때문에 최종 사용자 환경에 영향을 주지 않고 `@Page` 지시문에서 `MasterPageFile` 특성을 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-150">Because we are setting the `Page` object's `MasterPageFile` property programmatically, we could remove the `MasterPageFile` attribute from the `@Page` directive without affecting the end user's experience.</span></span> <span data-ttu-id="44b81-151">이를 이해 하려면 계속 해 서 `Default.aspx`의 `@Page` 지시문에서 `MasterPageFile` 특성을 제거한 다음 브라우저를 통해 페이지를 방문 하세요.</span><span class="sxs-lookup"><span data-stu-id="44b81-151">To convince yourself of this, go ahead and remove the `MasterPageFile` attribute from the `@Page` directive in `Default.aspx` and then visit the page through a browser.</span></span> <span data-ttu-id="44b81-152">짐작할 수 있듯이 출력은 특성이 제거 되기 전과 동일 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-152">As you would expect, the output is the same as before the attribute was removed.</span></span>

<span data-ttu-id="44b81-153">`MasterPageFile` 속성이 `@Page` 지시문을 통해 설정 되는지 아니면 프로그래밍 방식으로 최종 사용자 환경에 대해 중요 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-153">Whether the `MasterPageFile` property is set via the `@Page` directive or programmatically is inconsequential to the end user's experience.</span></span> <span data-ttu-id="44b81-154">그러나 `@Page` 지시문의 `MasterPageFile` 특성은 디자인 타임에 디자이너에서 WYSIWYG 뷰를 생성 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-154">However, the `MasterPageFile` attribute in the `@Page` directive is used by Visual Studio during design-time to produce the WYSIWYG view in the Designer.</span></span> <span data-ttu-id="44b81-155">Visual Studio에서 `Default.aspx`로 돌아가서 디자이너로 이동 하면 "마스터 페이지 오류: 페이지에 마스터 페이지 참조가 필요 하지만 아무것도 지정 되지 않은 컨트롤이 있습니다." 라는 메시지가 표시 됩니다 (그림 2 참조).</span><span class="sxs-lookup"><span data-stu-id="44b81-155">If you return to `Default.aspx` in Visual Studio and navigate to the Designer you'll see the message, "Master Page error: The page has controls that require a Master Page reference, but none is specified" (see Figure 2).</span></span>

<span data-ttu-id="44b81-156">즉, Visual Studio에서 다양 한 디자인 타임 환경을 이용 하려면 `MasterPageFile` 특성을 `@Page` 지시문에 남겨 두어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-156">In short, you need to leave the `MasterPageFile` attribute in the `@Page` directive to enjoy a rich design-time experience in Visual Studio.</span></span>

<span data-ttu-id="44b81-157">[![Visual Studio는 @Page 지시문의 MasterPageFile 특성을 사용 하 여 디자인 뷰를 렌더링 합니다.](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-157">[![Visual Studio Uses the @Page Directive's MasterPageFile Attribute to Render the Design View](specifying-the-master-page-programmatically-vb/_static/image5.png)](specifying-the-master-page-programmatically-vb/_static/image4.png)</span></span>

<span data-ttu-id="44b81-158">**그림 02**: Visual Studio에서는 `@Page` 지시문의 `MasterPageFile` 특성을 사용 하 여 디자인 뷰를 렌더링 합니다 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image6.png)).</span><span class="sxs-lookup"><span data-stu-id="44b81-158">**Figure 02**: Visual Studio Uses the `@Page` Directive's `MasterPageFile` Attribute to Render the Design View  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image6.png))</span></span>

## <a name="step-3-creating-an-alternative-master-page"></a><span data-ttu-id="44b81-159">3 단계: 대체 마스터 페이지 만들기</span><span class="sxs-lookup"><span data-stu-id="44b81-159">Step 3: Creating an Alternative Master Page</span></span>

<span data-ttu-id="44b81-160">런타임에 프로그래밍 방식으로 콘텐츠 페이지의 마스터 페이지를 설정할 수 있으므로 일부 외부 조건에 따라 특정 마스터 페이지를 동적으로 로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-160">Because a content page's master page can be set programmatically at runtime it's possible to dynamically load a particular master page based on some external criteria.</span></span> <span data-ttu-id="44b81-161">이 기능은 사용자에 따라 사이트의 레이아웃이 달라 야 하는 경우에 유용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-161">This functionality can be useful in situations where the site's layout needs to vary based on the user.</span></span> <span data-ttu-id="44b81-162">예를 들어 블로그 엔진 웹 응용 프로그램을 사용 하면 사용자가 블로그의 레이아웃을 선택할 수 있습니다. 여기서 각 레이아웃은 다른 마스터 페이지와 연결 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-162">For instance, a blog engine web application may allow its users to choose a layout for their blog, where each layout is associated with a different master page.</span></span> <span data-ttu-id="44b81-163">런타임에 방문자가 사용자의 블로그를 볼 때 웹 응용 프로그램은 블로그의 레이아웃을 결정 하 고 해당 마스터 페이지를 콘텐츠 페이지에 동적으로 연결 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-163">At runtime, when a visitor is viewing a user's blog, the web application would need to determine the blog's layout and dynamically associate the corresponding master page with the content page.</span></span>

<span data-ttu-id="44b81-164">일부 외부 조건에 따라 런타임에 마스터 페이지를 동적으로 로드 하는 방법을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-164">Let's examine how to dynamically load a master page at runtime based on some external criteria.</span></span> <span data-ttu-id="44b81-165">현재 웹 사이트에는 마스터 페이지 (`Site.master`)가 하나 뿐입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-165">Our website currently contains just one master page (`Site.master`).</span></span> <span data-ttu-id="44b81-166">런타임에 마스터 페이지를 선택 하는 방법을 설명 하는 다른 마스터 페이지가 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-166">We need another master page to illustrate choosing a master page at runtime.</span></span> <span data-ttu-id="44b81-167">이 단계에서는 새 마스터 페이지를 만들고 구성 하는 방법을 집중적으로 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-167">This step focuses on creating and configuring the new master page.</span></span> <span data-ttu-id="44b81-168">4 단계에서는 런타임에 사용할 마스터 페이지를 결정 하는 방법을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-168">Step 4 looks at determining what master page to use at runtime.</span></span>

<span data-ttu-id="44b81-169">`Alternate.master`이라는 루트 폴더에 새 마스터 페이지를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-169">Create a new master page in the root folder named `Alternate.master`.</span></span> <span data-ttu-id="44b81-170">또한 `AlternateStyles.css`이라는 웹 사이트에 새 스타일 시트를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-170">Also add a new style sheet to the website named `AlternateStyles.css`.</span></span>

<span data-ttu-id="44b81-171">[다른 마스터 페이지 및 CSS 파일을 웹 사이트에 추가 ![](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-171">[![Add Another Master Page and CSS File to the Website](specifying-the-master-page-programmatically-vb/_static/image8.png)](specifying-the-master-page-programmatically-vb/_static/image7.png)</span></span>

<span data-ttu-id="44b81-172">**그림 03**: 다른 마스터 페이지 및 CSS 파일을 웹 사이트에 추가 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="44b81-172">**Figure 03**: Add Another Master Page and CSS File to the Website  ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image9.png))</span></span>

<span data-ttu-id="44b81-173">페이지 맨 위에 제목을 표시 하 고 짙은 배경으로 표시 하도록 `Alternate.master` 마스터 페이지를 디자인 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-173">I've designed the `Alternate.master` master page to have the title displayed at the top of the page, centered and on a navy background.</span></span> <span data-ttu-id="44b81-174">왼쪽 열을 분배 된 해당 콘텐츠를 `MainContent` ContentPlaceHolder 컨트롤 아래로 이동 했으므로 이제 페이지의 전체 너비를 차지 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-174">I've dispensed of the left column and moved that content beneath the `MainContent` ContentPlaceHolder control, which now spans the entire width of the page.</span></span> <span data-ttu-id="44b81-175">또한 순서가 지정 되지 않은 단원 목록을 nixed `MainContent`위의 가로 목록으로 대체 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-175">Furthermore, I nixed the unordered Lessons list and replaced it with a horizontal list above `MainContent`.</span></span> <span data-ttu-id="44b81-176">마스터 페이지에서 사용 하는 글꼴 및 색 (및 확장, 해당 콘텐츠 페이지)도 업데이트 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-176">I also updated the fonts and colors used by the master page (and, by extension, its content pages).</span></span> <span data-ttu-id="44b81-177">그림 4는 `Alternate.master` 마스터 페이지를 사용할 때 `Default.aspx`을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-177">Figure 4 shows `Default.aspx` when using the `Alternate.master` master page.</span></span>

> [!NOTE]
> <span data-ttu-id="44b81-178">ASP.NET에는 *테마*를 정의 하는 기능이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-178">ASP.NET includes the ability to define *Themes*.</span></span> <span data-ttu-id="44b81-179">테마는 런타임에 페이지에 적용할 수 있는 이미지, CSS 파일 및 스타일 관련 웹 컨트롤 속성 설정의 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-179">A Theme is a collection of images, CSS files, and style-related Web control property settings that can be applied to a page at runtime.</span></span> <span data-ttu-id="44b81-180">테마는 사이트의 레이아웃이 표시 되는 이미지와 CSS 규칙에만 다른 경우에 사용할 수 있는 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-180">Themes are the way to go if your site's layouts differ only in the images displayed and by their CSS rules.</span></span> <span data-ttu-id="44b81-181">다른 웹 컨트롤을 사용 하거나 매우 다른 레이아웃을 사용 하는 경우와 같이 레이아웃이 훨씬 더 큰 경우에는 별도의 마스터 페이지를 사용 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-181">If the layouts differ more substantially, such as using different Web controls or having a radically different layout, then you will need to use separate master pages.</span></span> <span data-ttu-id="44b81-182">테마에 대 한 자세한 내용은이 자습서의 끝부분에 있는 추가 읽기 섹션을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="44b81-182">Consult the Further Reading section at the end of this tutorial for more information on Themes.</span></span>

<span data-ttu-id="44b81-183">[콘텐츠 페이지 ![이제 새로운 모양과 느낌을 사용할 수 있습니다.](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-183">[![Our Content Pages Can Now Use a New Look and Feel](specifying-the-master-page-programmatically-vb/_static/image11.png)](specifying-the-master-page-programmatically-vb/_static/image10.png)</span></span>

<span data-ttu-id="44b81-184">**그림 04**: 이제 콘텐츠 페이지에서 새로운 모양과 느낌을 사용할 수 있습니다 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image12.png)).</span><span class="sxs-lookup"><span data-stu-id="44b81-184">**Figure 04**: Our Content Pages Can Now Use a New Look and Feel ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image12.png))</span></span>

<span data-ttu-id="44b81-185">마스터 및 콘텐츠 페이지의 태그가 퓨즈 인 경우 `MasterPage` 클래스는 콘텐츠 페이지의 모든 콘텐츠 컨트롤이 마스터 페이지의 ContentPlaceHolder를 참조 하는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-185">When the master and content pages' markup are fused, the `MasterPage` class checks to ensure that every Content control in the content page references a ContentPlaceHolder in the master page.</span></span> <span data-ttu-id="44b81-186">존재 하지 않는 ContentPlaceHolder를 참조 하는 콘텐츠 컨트롤이 발견 되 면 예외가 throw 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-186">An exception is thrown if a Content control that references a non-existent ContentPlaceHolder is found.</span></span> <span data-ttu-id="44b81-187">즉, 콘텐츠 페이지에 할당 되는 마스터 페이지의 콘텐츠 페이지에는 각 콘텐츠 컨트롤에 대 한 ContentPlaceHolder가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-187">In other words, it is imperative that the master page being assigned to the content page have a ContentPlaceHolder for each Content control in the content page.</span></span>

<span data-ttu-id="44b81-188">`Site.master` 마스터 페이지에는 4 개의 ContentPlaceHolder 컨트롤이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-188">The `Site.master` master page includes four ContentPlaceHolder controls:</span></span>

- `head`
- `MainContent`
- `QuickLoginUI`
- `LeftColumnContent`

<span data-ttu-id="44b81-189">웹 사이트의 콘텐츠 페이지 중 일부에는 하나 또는 두 개의 콘텐츠 컨트롤만 포함 됩니다. 다른 항목에는 사용 가능한 각 ContentPlaceHolders 표시자에 대 한 콘텐츠 컨트롤이 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-189">Some of the content pages in our website include just one or two Content controls; others include a Content control for each of the available ContentPlaceHolders.</span></span> <span data-ttu-id="44b81-190">`Site.master`의 모든 ContentPlaceHolders 표시자에 대 한 콘텐츠 컨트롤을 포함 하는 콘텐츠 페이지에 새 마스터 페이지 (`Alternate.master`)를 할당 하는 경우에도 `Site.master`와 동일한 ContentPlaceHolder 컨트롤을 `Alternate.master` 하는 것이 중요 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-190">If our new master page (`Alternate.master`) may ever be assigned to those content pages that have Content controls for all of the ContentPlaceHolders in `Site.master` then it is essential that `Alternate.master` also include the same ContentPlaceHolder controls as `Site.master`.</span></span>

<span data-ttu-id="44b81-191">`Alternate.master` 마스터 페이지가 광산과 비슷하게 보이도록 하려면 (그림 4 참조) `AlternateStyles.css` 스타일 시트에서 마스터 페이지의 스타일을 정의 하는 것부터 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-191">To get your `Alternate.master` master page to look similar to mine (see Figure 4), start by defining the master page's styles in the `AlternateStyles.css` style sheet.</span></span> <span data-ttu-id="44b81-192">`AlternateStyles.css`에 다음 규칙을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-192">Add the following rules into `AlternateStyles.css`:</span></span>

[!code-css[Main](specifying-the-master-page-programmatically-vb/samples/sample5.css)]

<span data-ttu-id="44b81-193">그런 다음 `Alternate.master`에 다음 선언적 태그를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-193">Next, add the following declarative markup to `Alternate.master`.</span></span> <span data-ttu-id="44b81-194">여기에서 볼 수 있듯이 `Alternate.master`에는 `Site.master`의 ContentPlaceHolder 컨트롤과 동일한 `ID` 값을 가진 4 개의 ContentPlaceHolder 컨트롤이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-194">As you can see, `Alternate.master` contains four ContentPlaceHolder controls with the same `ID` values as the ContentPlaceHolder controls in `Site.master`.</span></span> <span data-ttu-id="44b81-195">또한 ASP.NET AJAX 프레임 워크를 사용 하는 웹 사이트의 해당 페이지에 필요한 ScriptManager 컨트롤을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-195">Moreover, it includes a ScriptManager control, which is necessary for those pages in our website that use the ASP.NET AJAX framework.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample6.aspx)]

### <a name="testing-the-new-master-page"></a><span data-ttu-id="44b81-196">새 마스터 페이지 테스트</span><span class="sxs-lookup"><span data-stu-id="44b81-196">Testing the New Master Page</span></span>

<span data-ttu-id="44b81-197">이 새 마스터 페이지를 테스트 하려면 `MasterPageFile` 속성에 `"~/Alternate.maser"` 값이 할당 되도록 `BasePage` 클래스의 `OnPreInit` 메서드를 업데이트 한 후 웹 사이트를 방문 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-197">To test this new master page update the `BasePage` class's `OnPreInit` method so that the `MasterPageFile` property is assigned the value `"~/Alternate.maser"` and then visit the website.</span></span> <span data-ttu-id="44b81-198">`~/Admin/AddProduct.aspx` 및 `~/Admin/Products.aspx`를 제외 하 고 모든 페이지가 오류 없이 작동 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-198">Every page should function without error except for two: `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="44b81-199">`~/Admin/AddProduct.aspx`에서 DetailsView에 제품을 추가 하면 마스터 페이지의 `GridMessageText` 속성을 설정 하려고 시도 하는 코드 줄에서 `NullReferenceException` 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-199">Adding a product to the DetailsView in `~/Admin/AddProduct.aspx` results in a `NullReferenceException` from the line of code that attempts to set the master page's `GridMessageText` property.</span></span> <span data-ttu-id="44b81-200">`~/Admin/Products.aspx` 방문할 때 "'\_.ASP ' 형식의 개체를 ' .asp\_master ' 형식으로 캐스팅할 수 없습니다." 라는 메시지와 함께 페이지 로드 시 `InvalidCastException` throw 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-200">When visiting `~/Admin/Products.aspx` an `InvalidCastException` is thrown on page load with the message: "Unable to cast object of type 'ASP.alternate\_master' to type 'ASP.site\_master'."</span></span>

<span data-ttu-id="44b81-201">이러한 오류는 `Site.master` 코드 숨김이 `Alternate.master`에 정의 되지 않은 공용 이벤트, 속성 및 메서드를 포함 하기 때문에 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-201">These errors occur because the `Site.master` code-behind class includes public events, properties, and methods that are not defined in `Alternate.master`.</span></span> <span data-ttu-id="44b81-202">이러한 두 페이지의 태그 부분에는 `Site.master` 마스터 페이지를 참조 하는 `@MasterType` 지시문이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-202">The markup portion of these two pages have a `@MasterType` directive that references the `Site.master` master page.</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample7.aspx)]

<span data-ttu-id="44b81-203">또한 `~/Admin/AddProduct.aspx`의 DetailsView의 `ItemInserted` 이벤트 처리기에는 느슨하게 형식화 된 `Page.Master` 속성을 `Site`형식의 개체로 캐스팅 하는 코드가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-203">Also, the DetailsView's `ItemInserted` event handler in `~/Admin/AddProduct.aspx` includes code that casts the loosely-typed `Page.Master` property to an object of type `Site`.</span></span> <span data-ttu-id="44b81-204">`@MasterType` 지시문 (이러한 방식으로 사용 됨) 및 `ItemInserted` 이벤트 처리기의 캐스팅은 `~/Admin/AddProduct.aspx` 및 `~/Admin/Products.aspx` 페이지를 `Site.master` 마스터 페이지로 긴밀 하 게 결합.</span><span class="sxs-lookup"><span data-stu-id="44b81-204">The `@MasterType` directive (used this way) and the cast in the `ItemInserted` event handler tightly couples the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to the `Site.master` master page.</span></span>

<span data-ttu-id="44b81-205">이 밀접 한 결합을 중단 하기 위해 `Site.master` 하 고 공용 멤버에 대 한 정의를 포함 하는 공통 기본 클래스에서 파생 `Alternate.master` 파생 시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-205">To break this tight coupling we can have `Site.master` and `Alternate.master` derive from a common base class that contains definitions for the public members.</span></span> <span data-ttu-id="44b81-206">다음에는이 공통 기본 형식을 참조 하도록 `@MasterType` 지시어를 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-206">Following that, we can update the `@MasterType` directive to reference this common base type.</span></span>

### <a name="creating-a-custom-base-master-page-class"></a><span data-ttu-id="44b81-207">사용자 지정 기본 마스터 페이지 클래스 만들기</span><span class="sxs-lookup"><span data-stu-id="44b81-207">Creating a Custom Base Master Page Class</span></span>

<span data-ttu-id="44b81-208">`BaseMasterPage.vb` 이라는 `App_Code` 폴더에 새 클래스 파일을 추가 하 고 `System.Web.UI.MasterPage`에서 파생 되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-208">Add a new class file to the `App_Code` folder named `BaseMasterPage.vb` and have it derive from `System.Web.UI.MasterPage`.</span></span> <span data-ttu-id="44b81-209">`BaseMasterPage`에서 `RefreshRecentProductsGrid` 메서드와 `GridMessageText` 속성을 정의 해야 하지만 `Site.master`에서 해당 멤버를 이동할 수 없습니다. 이러한 멤버는 `Site.master` 마스터 페이지 (`RecentProducts` GridView 및 `GridMessage` 레이블)와 관련 된 웹 컨트롤에서 작동 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-209">We need to define the `RefreshRecentProductsGrid` method and the `GridMessageText` property in `BaseMasterPage`, but we can't simply move them there from `Site.master` because these members work with Web controls that are specific to the `Site.master` master page (the `RecentProducts` GridView and `GridMessage` Label).</span></span>

<span data-ttu-id="44b81-210">이러한 멤버는 이러한 멤버를 정의 하지만 실제로는 `BaseMasterPage`의 파생 클래스 (`Site.master` 및 `Alternate.master`)에 의해 구현 되는 방식으로 `BaseMasterPage` 구성 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-210">What we need to do is configure `BaseMasterPage` in such a way that these members are defined there, but are actually implemented by `BaseMasterPage`'s derived classes (`Site.master` and `Alternate.master`).</span></span> <span data-ttu-id="44b81-211">이 유형의 상속은 클래스를 `MustInherit`으로 표시 하 고 해당 멤버를 `MustOverride`으로 표시 하 여 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-211">This type of inheritance is possible by marking the class as `MustInherit` and its members as `MustOverride`.</span></span> <span data-ttu-id="44b81-212">간단히 말해서 이러한 키워드를 클래스에 추가 하 고 해당 두 개의 멤버가 `BaseMasterPage` `RefreshRecentProductsGrid` 및 `GridMessageText`구현 되지 않았지만 파생 된 클래스에 대해이를 알립니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-212">In short, adding these keywords to the class and its two members announces that `BaseMasterPage` hasn't implemented `RefreshRecentProductsGrid` and `GridMessageText`, but that its derived classes will.</span></span>

<span data-ttu-id="44b81-213">또한 `BaseMasterPage`에서 `PricesDoubled` 이벤트를 정의 하 고 파생 클래스에서 이벤트를 발생 시킬 수 있는 수단을 제공 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-213">We also need to define the `PricesDoubled` event in `BaseMasterPage` and provide a means by the derived classes to raise the event.</span></span> <span data-ttu-id="44b81-214">이 동작을 용이 하 게 하기 위해 .NET Framework에 사용 되는 패턴은 기본 클래스에서 공용 이벤트를 만들고 `OnEventName`라는 보호 된 재정의 가능한 메서드를 추가 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-214">The pattern used in the .NET Framework to facilitate this behavior is to create a public event in the base class and add a protected, overridable method named `OnEventName`.</span></span> <span data-ttu-id="44b81-215">그런 다음 파생 된 클래스는이 메서드를 호출 하 여 이벤트를 발생 시키거나 이벤트 발생 전후에 코드를 즉시 실행 하도록 재정의할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-215">Derived classes can then call this method to raise the event or can override it to execute code immediately before or after the event is raised.</span></span>

<span data-ttu-id="44b81-216">다음 코드를 포함 하도록 `BaseMasterPage` 클래스를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-216">Update your `BaseMasterPage` class so that it contains the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample8.vb)]

<span data-ttu-id="44b81-217">그런 다음 `Site.master` 코드 숨김으로 클래스로 이동 하 여 `BaseMasterPage`에서 파생 시킵니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-217">Next, go to the `Site.master` code-behind class and have it derive from `BaseMasterPage`.</span></span> <span data-ttu-id="44b81-218">`BaseMasterPage`에 `MustOverride` 표시 된 멤버가 포함 되어 있으므로 `Site.master`에서 해당 멤버를 재정의 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-218">Because `BaseMasterPage` contains members marked `MustOverride` we need to override those members here in `Site.master`.</span></span> <span data-ttu-id="44b81-219">메서드 및 속성 정의에 `Overrides` 키워드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-219">Add the `Overrides` keyword to the method and property definitions.</span></span> <span data-ttu-id="44b81-220">또한 기본 클래스의 `OnPricesDoubled` 메서드를 호출 하 여 `DoublePrice` 단추의 `Click` 이벤트 처리기에서 `PricesDoubled` 이벤트를 발생 시키는 코드를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-220">Also update the code that raises the `PricesDoubled` event in the `DoublePrice` Button's `Click` event handler with a call to the base class's `OnPricesDoubled` method.</span></span>

<span data-ttu-id="44b81-221">이러한 수정 후 `Site.master` 코드를 포함 하는 클래스는 다음 코드를 포함 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-221">After these modifications the `Site.master` code-behind class should contain the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample9.vb)]

<span data-ttu-id="44b81-222">`BaseMasterPage`에서 파생 하 고 두 개의 `MustOverride` 멤버를 재정의 하려면 `Alternate.master`의 코드 숨김이 클래스도 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-222">We also need to update `Alternate.master`'s code-behind class to derive from `BaseMasterPage` and override the two `MustOverride` members.</span></span> <span data-ttu-id="44b81-223">그러나 `Alternate.master`에는 최신 제품을 나열 하는 GridView와 새 제품이 데이터베이스에 추가 된 후 메시지를 표시 하는 레이블이 포함 되지 않기 때문에 이러한 메서드는 아무것도 수행할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-223">But because `Alternate.master` does not contain a GridView that lists the most recent products nor a Label that displays a message after a new product is added to the database, these methods do not need to do anything.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample10.vb)]

### <a name="referencing-the-base-master-page-class"></a><span data-ttu-id="44b81-224">기본 마스터 페이지 클래스 참조</span><span class="sxs-lookup"><span data-stu-id="44b81-224">Referencing the Base Master Page Class</span></span>

<span data-ttu-id="44b81-225">이제 `BaseMasterPage` 클래스를 완료 하 고 두 개의 마스터 페이지가 확장 되었으므로 최종 단계는이 공통 형식을 참조 하도록 `~/Admin/AddProduct.aspx` 및 `~/Admin/Products.aspx` 페이지를 업데이트 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-225">Now that we have completed the `BaseMasterPage` class and have our two master pages extending it, our final step is to update the `~/Admin/AddProduct.aspx` and `~/Admin/Products.aspx` pages to refer to this common type.</span></span> <span data-ttu-id="44b81-226">에서 두 페이지의 `@MasterType` 지시어를 변경 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-226">Start by changing the `@MasterType` directive in both pages from:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample11.aspx)]

<span data-ttu-id="44b81-227">받는 사람:</span><span class="sxs-lookup"><span data-stu-id="44b81-227">To:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample12.aspx)]

<span data-ttu-id="44b81-228">`@MasterType` 속성은 파일 경로를 참조 하는 대신 기본 형식 (`BaseMasterPage`)을 참조 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-228">Rather than referencing a file path, the `@MasterType` property now references the base type (`BaseMasterPage`).</span></span> <span data-ttu-id="44b81-229">결과적으로, 두 페이지의 코드 숨김이 클래스에서 사용 되는 강력한 형식의 `Master` 속성은 이제 `Site`형식이 아닌 `BaseMasterPage` 형식입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-229">Consequently, the strongly-typed `Master` property used in both pages' code-behind classes is now of type `BaseMasterPage` (instead of type `Site`).</span></span> <span data-ttu-id="44b81-230">이렇게 변경 하면 `~/Admin/Products.aspx`다시 시작 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-230">With this change in place revisit `~/Admin/Products.aspx`.</span></span> <span data-ttu-id="44b81-231">이전에는 페이지가 `Alternate.master` 마스터 페이지를 사용 하도록 구성 되어 있지만 `@MasterType` 지시문이 `Site.master` 파일을 참조 하기 때문에 캐스팅 오류가 발생 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-231">Previously, this resulted in a casting error because the page is configured to use the `Alternate.master` master page, but the `@MasterType` directive referenced the `Site.master` file.</span></span> <span data-ttu-id="44b81-232">그러나 이제 페이지는 오류 없이 렌더링 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-232">But now the page renders without error.</span></span> <span data-ttu-id="44b81-233">이는 `Alternate.master` 마스터 페이지가 확장 된 후 `BaseMasterPage` 형식의 개체로 캐스팅 될 수 있기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-233">This is because the `Alternate.master` master page can be cast to an object of type `BaseMasterPage` (since it extends it).</span></span>

<span data-ttu-id="44b81-234">`~/Admin/AddProduct.aspx`에서 수행 해야 하는 작은 변경 내용이 하나 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-234">There's one small change that needs to be made in `~/Admin/AddProduct.aspx`.</span></span> <span data-ttu-id="44b81-235">DetailsView 컨트롤의 `ItemInserted` 이벤트 처리기는 강력한 형식의 `Master` 속성과 느슨하게 형식화 된 `Page.Master` 속성을 모두 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-235">The DetailsView control's `ItemInserted` event handler uses both the strongly-typed `Master` property and the loosely-typed `Page.Master` property.</span></span> <span data-ttu-id="44b81-236">`@MasterType` 지시어를 업데이트할 때 강력한 형식의 참조를 수정 했지만 느슨하게 형식화 된 참조를 업데이트 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-236">We fixed the strongly-typed reference when we updated the `@MasterType` directive, but we still need to update the loosely-typed reference.</span></span> <span data-ttu-id="44b81-237">다음 코드 줄을 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-237">Replace the following line of code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample13.vb)]

<span data-ttu-id="44b81-238">다음을 사용 하 여 `Page.Master` 기본 형식으로 캐스팅 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-238">With the following, which casts `Page.Master` to the base type:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample14.vb)]

## <a name="step-4-determining-what-master-page-to-bind-to-the-content-pages"></a><span data-ttu-id="44b81-239">4 단계: 콘텐츠 페이지에 바인딩할 마스터 페이지 결정</span><span class="sxs-lookup"><span data-stu-id="44b81-239">Step 4: Determining What Master Page to Bind to the Content Pages</span></span>

<span data-ttu-id="44b81-240">`BasePage` 클래스는 현재 페이지 수명 주기의 PreInit 단계에서 하드 코드 된 값으로 모든 콘텐츠 페이지의 `MasterPageFile` 속성을 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-240">Our `BasePage` class currently sets all content pages' `MasterPageFile` properties to a hard-coded value in the PreInit stage of the page lifecycle.</span></span> <span data-ttu-id="44b81-241">이 코드를 업데이트 하 여 일부 외부 요소에서 마스터 페이지의 기반이 되도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-241">We can update this code to base the master page on some external factor.</span></span> <span data-ttu-id="44b81-242">로드할 마스터 페이지는 현재 로그온 한 사용자의 기본 설정에 따라 달라 집니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-242">Perhaps the master page to load depends on the preferences of the currently logged on user.</span></span> <span data-ttu-id="44b81-243">이 경우 현재 방문한 사용자의 마스터 페이지 기본 설정을 조회 하는 `BasePage`의 `OnPreInit` 메서드에서 코드를 작성 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-243">In that case, we'd need to write code in the `OnPreInit` method in `BasePage` that looks up the currently visiting user's master page preferences.</span></span>

<span data-ttu-id="44b81-244">사용자가 `Site.master` 또는 `Alternate.master`를 사용 하 여 마스터 페이지를 선택 하 고이 선택 항목을 세션 변수에 저장할 수 있는 웹 페이지를 만들어 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-244">Let's create a web page that allows the user to choose which master page to use - `Site.master` or `Alternate.master` - and save this choice in a Session variable.</span></span> <span data-ttu-id="44b81-245">`ChooseMasterPage.aspx`이라는 루트 디렉터리에 새 웹 페이지를 만들어 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-245">Start by creating a new web page in the root directory named `ChooseMasterPage.aspx`.</span></span> <span data-ttu-id="44b81-246">이 페이지 또는 다른 콘텐츠 페이지 예측이를 만들 때 마스터 페이지가 `BasePage`에서 프로그래밍 방식으로 설정 되기 때문에 마스터 페이지에 바인딩할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-246">When creating this page (or any other content pages henceforth) you don't need to bind it to a master page because the master page is set programmatically in `BasePage`.</span></span> <span data-ttu-id="44b81-247">그러나 새 페이지를 마스터 페이지에 바인딩하지 않으면 새 페이지의 기본 선언적 태그에 웹 폼 및 마스터 페이지에서 제공 하는 다른 콘텐츠가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-247">However, if you do not bind the new page to a master page then the new page's default declarative markup contains a Web Form and other content supplied by the master page.</span></span> <span data-ttu-id="44b81-248">이 태그를 적절 한 콘텐츠 컨트롤로 수동으로 바꾸어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-248">You'll need to manually replace this markup with the appropriate Content controls.</span></span> <span data-ttu-id="44b81-249">이러한 이유로 새 ASP.NET 페이지를 마스터 페이지에 바인딩하는 것이 더 쉽습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-249">For that reason, I find it easier to bind the new ASP.NET page to a master page.</span></span>

> [!NOTE]
> <span data-ttu-id="44b81-250">`Site.master` 및 `Alternate.master`는 ContentPlaceHolder 컨트롤 집합이 동일 하기 때문에 새 콘텐츠 페이지를 만들 때 어떤 마스터 페이지를 선택 하 든 상관 없습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-250">Because `Site.master` and `Alternate.master` have the same set of ContentPlaceHolder controls it doesn't matter what master page you choose when creating the new content page.</span></span> <span data-ttu-id="44b81-251">일관성을 위해 `Site.master`를 사용 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-251">For consistency, I'd suggest using `Site.master`.</span></span>

<span data-ttu-id="44b81-252">[웹 사이트에 새 콘텐츠 페이지를 추가 ![](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-252">[![Add a New Content Page to the Website](specifying-the-master-page-programmatically-vb/_static/image14.png)](specifying-the-master-page-programmatically-vb/_static/image13.png)</span></span>

<span data-ttu-id="44b81-253">**그림 05**: 웹 사이트에 새 콘텐츠 페이지 추가 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="44b81-253">**Figure 05**: Add a New Content Page to the Website ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image15.png))</span></span>

<span data-ttu-id="44b81-254">이 단원에 대 한 항목을 포함 하도록 `Web.sitemap` 파일을 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-254">Update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="44b81-255">Master Pages 및 ASP.NET AJAX 단원의 `<siteMapNode>` 아래에 다음 태그를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-255">Add the following markup beneath the `<siteMapNode>` for the Master Pages and ASP.NET AJAX lesson:</span></span>

[!code-xml[Main](specifying-the-master-page-programmatically-vb/samples/sample15.xml)]

<span data-ttu-id="44b81-256">`ChooseMasterPage.aspx` 페이지에 콘텐츠를 추가 하기 전에 페이지의 코드 숨김이 클래스를 업데이트 하 여 `BasePage` (`System.Web.UI.Page`아닌)에서 파생 되도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-256">Before adding any content to the `ChooseMasterPage.aspx` page take a moment to update the page's code-behind class so that it derives from `BasePage` (rather than `System.Web.UI.Page`).</span></span> <span data-ttu-id="44b81-257">그런 다음 페이지에 DropDownList 컨트롤을 추가 하 고, 해당 `ID` 속성을 `MasterPageChoice`로 설정 하 고, "~/Site.master" 및 "~/Alternate.master"의 `Text` 값을 사용 하 여 두 개의 ListItems를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-257">Next, add a DropDownList control to the page, set its `ID` property to `MasterPageChoice`, and add two ListItems with the `Text` values of "~/Site.master" and "~/Alternate.master".</span></span>

<span data-ttu-id="44b81-258">단추 웹 컨트롤을 페이지에 추가 하 고 해당 `ID` 및 `Text` 속성을 `SaveLayout` 및 "레이아웃 선택 저장"으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-258">Add a Button Web control to the page and set its `ID` and `Text` properties to `SaveLayout` and "Save Layout Choice", respectively.</span></span> <span data-ttu-id="44b81-259">이 시점에서 페이지의 선언 태그는 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-259">At this point your page's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](specifying-the-master-page-programmatically-vb/samples/sample16.aspx)]

<span data-ttu-id="44b81-260">페이지를 처음 방문할 때 사용자의 현재 선택 된 마스터 페이지를 표시 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-260">When the page is first visited we need to display the user's currently selected master page choice.</span></span> <span data-ttu-id="44b81-261">`Page_Load` 이벤트 처리기를 만들고 다음 코드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-261">Create a `Page_Load` event handler and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample17.vb)]

<span data-ttu-id="44b81-262">위의 코드는 첫 번째 페이지 방문 에서만 실행 되며 이후 포스트백에는 실행 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-262">The above code executes only on the first page visit (and not on subsequent postbacks).</span></span> <span data-ttu-id="44b81-263">먼저 세션 변수가 `MyMasterPage` 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-263">It first checks to see if the Session variable `MyMasterPage` exists.</span></span> <span data-ttu-id="44b81-264">이 경우 `MasterPageChoice` DropDownList에서 일치 하는 ListItem을 찾으려고 시도 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-264">If it does, it attempts to find the matching ListItem in the `MasterPageChoice` DropDownList.</span></span> <span data-ttu-id="44b81-265">일치 하는 ListItem이 있으면 해당 `Selected` 속성이 `True`로 설정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-265">If a matching ListItem is found, its `Selected` property is set to `True`.</span></span>

<span data-ttu-id="44b81-266">또한 사용자의 선택 항목을 `MyMasterPage` 세션 변수에 저장 하는 코드도 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-266">We also need code that saves the user's choice into the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="44b81-267">`SaveLayout` 단추의 `Click` 이벤트에 대 한 이벤트 처리기를 만들고 다음 코드를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-267">Create an event handler for the `SaveLayout` Button's `Click` event and add the following code:</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample18.vb)]

> [!NOTE]
> <span data-ttu-id="44b81-268">다시 게시 될 때 `Click` 이벤트 처리기가 실행 될 때 마스터 페이지가 이미 선택 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-268">By the time the `Click` event handler executes on postback, the master page has already been selected.</span></span> <span data-ttu-id="44b81-269">따라서 사용자의 드롭다운 목록 선택은 다음 페이지가 방문할 때까지 적용 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-269">Therefore, the user's drop-down list selection won't be in effect until the next page visit.</span></span> <span data-ttu-id="44b81-270">`Response.Redirect`는 브라우저가 `ChooseMasterPage.aspx`를 다시 요청 하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-270">The `Response.Redirect` forces the browser to re-request `ChooseMasterPage.aspx`.</span></span>

<span data-ttu-id="44b81-271">`ChooseMasterPage.aspx` 페이지가 완료 되 면 최종 작업에서 `MyMasterPage` 세션 변수의 값을 기반으로 `MasterPageFile` 속성을 할당 `BasePage` 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-271">With the `ChooseMasterPage.aspx` page complete, our final task is to have `BasePage` assign the `MasterPageFile` property based on the value of the `MyMasterPage` Session variable.</span></span> <span data-ttu-id="44b81-272">세션 변수가 설정 되지 않은 경우 `BasePage` 기본값을 `Site.master`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-272">If the Session variable is not set have `BasePage` default to `Site.master`.</span></span>

[!code-vb[Main](specifying-the-master-page-programmatically-vb/samples/sample19.vb)]

> [!NOTE]
> <span data-ttu-id="44b81-273">`Page` 개체의 `MasterPageFile` 속성을 할당 하는 코드를 `OnPreInit` 이벤트 처리기와 두 개의 개별 메서드로 이동 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-273">I moved the code that assigns the `Page` object's `MasterPageFile` property out of the `OnPreInit` event handler and into two separate methods.</span></span> <span data-ttu-id="44b81-274">이 첫 번째 메서드인 `SetMasterPageFile`는 두 번째 메서드인 `GetMasterPageFileFromSession`에서 반환 된 값에 `MasterPageFile` 속성을 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-274">This first method, `SetMasterPageFile`, assigns the `MasterPageFile` property to the value returned by the second method, `GetMasterPageFileFromSession`.</span></span> <span data-ttu-id="44b81-275">`BasePage`를 확장 하는 이후 클래스가 필요한 경우 사용자 지정 논리를 구현 하기 위해 선택적으로 재정의할 수 있도록 `SetMasterPageFile` 메서드 `Overridable` 표시 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-275">I marked the `SetMasterPageFile` method `Overridable` so that future classes that extend `BasePage` can optionally override it to implement custom logic, if needed.</span></span> <span data-ttu-id="44b81-276">다음 자습서에서 `BasePage`의 `SetMasterPageFile` 속성을 재정의 하는 예제가 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-276">We'll see an example of overriding `BasePage`'s `SetMasterPageFile` property in the next tutorial.</span></span>

<span data-ttu-id="44b81-277">이 코드가 준비 되 면 `ChooseMasterPage.aspx` 페이지를 방문 하세요.</span><span class="sxs-lookup"><span data-stu-id="44b81-277">With this code in place, visit the `ChooseMasterPage.aspx` page.</span></span> <span data-ttu-id="44b81-278">처음에는 `Site.master` 마스터 페이지가 선택 되어 있습니다 (그림 6 참조). 그러나 사용자는 드롭다운 목록에서 다른 마스터 페이지를 선택할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-278">Initially, the `Site.master` master page is selected (see Figure 6), but the user can pick a different master page from the drop-down list.</span></span>

<span data-ttu-id="44b81-279">[![콘텐츠 페이지는 사이트 마스터 페이지를 사용 하 여 표시 됩니다.](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-279">[![Content Pages are Displayed Using the Site.master Master Page](specifying-the-master-page-programmatically-vb/_static/image17.png)](specifying-the-master-page-programmatically-vb/_static/image16.png)</span></span>

<span data-ttu-id="44b81-280">**그림 06**: `Site.master` 마스터 페이지를 사용 하 여 콘텐츠 페이지가 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="44b81-280">**Figure 06**: Content Pages are Displayed Using the `Site.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image18.png))</span></span>

<span data-ttu-id="44b81-281">[이제 대체 마스터 페이지를 사용 하 여 콘텐츠 페이지 ![표시 됩니다.](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="44b81-281">[![Content Pages are Now Displayed Using the Alternate.master Master Page](specifying-the-master-page-programmatically-vb/_static/image20.png)](specifying-the-master-page-programmatically-vb/_static/image19.png)</span></span>

<span data-ttu-id="44b81-282">**그림 07**: 이제 `Alternate.master` 마스터 페이지를 사용 하 여 콘텐츠 페이지가 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](specifying-the-master-page-programmatically-vb/_static/image21.png)).</span><span class="sxs-lookup"><span data-stu-id="44b81-282">**Figure 07**: Content Pages are Now Displayed Using the `Alternate.master` Master Page ([Click to view full-size image](specifying-the-master-page-programmatically-vb/_static/image21.png))</span></span>

## <a name="summary"></a><span data-ttu-id="44b81-283">요약</span><span class="sxs-lookup"><span data-stu-id="44b81-283">Summary</span></span>

<span data-ttu-id="44b81-284">콘텐츠 페이지를 방문 하면 해당 콘텐츠 컨트롤은 마스터 페이지의 ContentPlaceHolder 컨트롤을 사용 하 여 퓨즈 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-284">When a content page is visited, its Content controls are fused with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="44b81-285">콘텐츠 페이지의 마스터 페이지는 `Page` 클래스의 `MasterPageFile` 속성으로 표시 됩니다 .이 속성은 초기화 단계에서 `@Page` 지시문의 `MasterPageFile` 특성에 할당 됩니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-285">The content page's master page is denoted by the `Page` class's `MasterPageFile` property, which is assigned to the `@Page` directive's `MasterPageFile` attribute during the Initialization stage.</span></span> <span data-ttu-id="44b81-286">이 자습서에 설명 된 대로 PreInit 단계를 완료 하기 전에 `MasterPageFile` 속성에 값을 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-286">As this tutorial showed, we can assign a value to the `MasterPageFile` property as long as we do so before the end of the PreInit stage.</span></span> <span data-ttu-id="44b81-287">마스터 페이지를 프로그래밍 방식으로 지정할 수 있으면 외부 요소에 따라 콘텐츠 페이지를 마스터 페이지에 동적으로 바인딩하는 것과 같은 고급 시나리오를 위한 도어가 열립니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-287">Being able to programmatically specify the master page opens the door for more advanced scenarios, such as dynamically binding a content page to a master page based on external factors.</span></span>

<span data-ttu-id="44b81-288">행복 한 프로그래밍</span><span class="sxs-lookup"><span data-stu-id="44b81-288">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="44b81-289">추가 정보</span><span class="sxs-lookup"><span data-stu-id="44b81-289">Further Reading</span></span>

<span data-ttu-id="44b81-290">이 자습서에서 설명 하는 항목에 대 한 자세한 내용은 다음 리소스를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="44b81-290">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="44b81-291">ASP.NET 페이지 수명 주기 다이어그램</span><span class="sxs-lookup"><span data-stu-id="44b81-291">ASP.NET Page Lifecycle Diagram</span></span>](http://emanish.googlepages.com/Asp.Net2.0Lifecycle.PNG)
- [<span data-ttu-id="44b81-292">ASP.NET 페이지 수명 주기 개요</span><span class="sxs-lookup"><span data-stu-id="44b81-292">ASP.NET Page Lifecycle Overview</span></span>](https://msdn.microsoft.com/library/ms178472.aspx)
- [<span data-ttu-id="44b81-293">ASP.NET 테마 및 스킨 개요</span><span class="sxs-lookup"><span data-stu-id="44b81-293">ASP.NET Themes and Skins Overview</span></span>](https://msdn.microsoft.com/library/ykzx33wh.aspx)
- [<span data-ttu-id="44b81-294">마스터 페이지: 팁, 요령 및 트랩</span><span class="sxs-lookup"><span data-stu-id="44b81-294">Master Pages: Tips, Tricks, and Traps</span></span>](http://www.odetocode.com/articles/450.aspx)
- [<span data-ttu-id="44b81-295">ASP.NET의 테마</span><span class="sxs-lookup"><span data-stu-id="44b81-295">Themes in ASP.NET</span></span>](http://www.odetocode.com/articles/423.aspx)

### <a name="about-the-author"></a><span data-ttu-id="44b81-296">작성자 정보</span><span class="sxs-lookup"><span data-stu-id="44b81-296">About the Author</span></span>

<span data-ttu-id="44b81-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)는 여러 ASP/ASP. NET books의 작성자와 4GuysFromRolla.com의 창립자가 1998부터 Microsoft 웹 기술을 사용 하 여 작업 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-297">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="44b81-298">Scott은 독립 컨설턴트, 강사 및 기록기로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-298">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="44b81-299">최신 책은 [*24 시간 이내에 ASP.NET 3.5을 sams teach yourself*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)것입니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-299">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="44b81-300">Scott은 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) 또는 [http://ScottOnWriting.NET](http://scottonwriting.net/)의 블로그를 통해 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-300">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="44b81-301">특별히 감사 합니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-301">Special Thanks To</span></span>

<span data-ttu-id="44b81-302">이 자습서 시리즈는 많은 유용한 검토자가 검토 했습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-302">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="44b81-303">이 자습서의 리드 검토자는 Suchi Banerjee.</span><span class="sxs-lookup"><span data-stu-id="44b81-303">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="44b81-304">예정 된 MSDN 문서를 검토 하는 데 관심이 있나요?</span><span class="sxs-lookup"><span data-stu-id="44b81-304">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="44b81-305">그렇다면 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) 에 줄을 놓습니다.</span><span class="sxs-lookup"><span data-stu-id="44b81-305">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="44b81-306">[이전](master-pages-and-asp-net-ajax-vb.md)
> [다음](nested-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="44b81-306">[Previous](master-pages-and-asp-net-ajax-vb.md)
[Next](nested-master-pages-vb.md)</span></span>

---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: GridView의 바닥글에서 새 레코드 삽입 (VB) | Microsoft Docs
author: rick-anderson
description: GridView 컨트롤은 데이터의 새 레코드 삽입에 대 한 기본 제공 지원을 제공 하지 않지만이 자습서에서는 다음을 포함 하도록 GridView를 확대 하는 방법을 보여 줍니다.
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 67ef370a90bc843f5c2da80bb43c8ef8de216b51
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78477413"
---
# <a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="59367-103">GridView의 바닥글에서 새 레코드 삽입(VB)</span><span class="sxs-lookup"><span data-stu-id="59367-103">Inserting a New Record from the GridView's Footer (VB)</span></span>

<span data-ttu-id="59367-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="59367-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="59367-105">[샘플 앱 다운로드](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) 또는 [PDF 다운로드](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="59367-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="59367-106">GridView 컨트롤이 새 데이터 레코드 삽입에 대 한 기본 제공 지원을 제공 하지 않지만이 자습서에서는 삽입 인터페이스를 포함 하도록 GridView를 확대 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="59367-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="59367-107">소개</span><span class="sxs-lookup"><span data-stu-id="59367-107">Introduction</span></span>

<span data-ttu-id="59367-108">[데이터 삽입, 업데이트 및 삭제](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) 자습서의 개요에 설명 된 대로 GridView, DetailsView 및 FormView 웹 컨트롤에는 기본적으로 제공 되는 데이터 수정 기능이 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="59367-109">선언적 데이터 소스 컨트롤과 함께 사용 하는 경우이 세 가지 웹 컨트롤을 빠르고 쉽게 구성 하 여 코드를 한 줄도 작성할 필요 없이 시나리오에서 데이터를 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="59367-110">아쉽게도 DetailsView 및 FormView 컨트롤만 기본 제공 되는 삽입, 편집 및 삭제 기능을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="59367-111">GridView는 편집 및 삭제 지원만 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="59367-112">그러나 작은 엘 보 그리스를 사용 하면 삽입 인터페이스를 포함 하도록 GridView를 확대할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="59367-113">GridView에 삽입 기능을 추가 하는 경우 새 레코드를 추가 하는 방법, 삽입 인터페이스를 만드는 방법 및 새 레코드를 삽입 하는 코드를 작성 하는 방법을 결정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="59367-114">이 자습서에서는 GridView 바닥글 행에 삽입 인터페이스를 추가 하는 방법을 살펴봅니다 (그림 1 참조).</span><span class="sxs-lookup"><span data-stu-id="59367-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="59367-115">각 열에 대 한 바닥글 셀에는 적절 한 데이터 컬렉션 사용자 인터페이스 요소 (제품 이름에 대 한 텍스트 상자, 공급자에 대 한 DropDownList 등)가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="59367-116">또한 클릭 하면 다시 게시를 발생 하 고 바닥글 행에 제공 된 값을 사용 하 여 `Products` 테이블에 새 레코드를 삽입 하는 추가 단추에 대 한 열이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>

<span data-ttu-id="59367-117">[바닥글 행 ![새 제품을 추가 하기 위한 인터페이스를 제공 합니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="59367-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="59367-118">**그림 1**: 바닥글 행이 새 제품을 추가 하기 위한 인터페이스를 제공 합니다 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png)).</span><span class="sxs-lookup"><span data-stu-id="59367-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>

## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="59367-119">1 단계: GridView에서 제품 정보 표시</span><span class="sxs-lookup"><span data-stu-id="59367-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="59367-120">GridView의 바닥글에 삽입 인터페이스를 만드는 것을 고려 하기 전에 먼저 데이터베이스의 제품을 나열 하는 페이지에 GridView를 추가 하는 데 중점을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="59367-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="59367-121">먼저 `EnhancedGridView` 폴더에서 `InsertThroughFooter.aspx` 페이지를 열고 gridview를 도구 상자에서 디자이너로 끌어와 GridView s `ID` 속성을 `Products`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="59367-122">그런 다음 GridView s 스마트 태그를 사용 하 여 `ProductsDataSource`라는 새 ObjectDataSource에 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>

<span data-ttu-id="59367-123">[ProductsDataSource 라는 새 ObjectDataSource를 만들 ![](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="59367-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="59367-124">**그림 2**: `ProductsDataSource` 라는 새 ObjectDataSource 만들기 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="59367-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>

<span data-ttu-id="59367-125">`ProductsBLL` 클래스 s `GetProducts()` 메서드를 사용 하 여 제품 정보를 검색 하도록 ObjectDataSource를 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="59367-126">이 자습서에서는 편집 및 삭제에 대해 걱정할 필요 없이 삽입 기능을 추가 하는 데 중점을 둡니다.</span><span class="sxs-lookup"><span data-stu-id="59367-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="59367-127">따라서 삽입 탭의 드롭다운 목록이 `AddProduct()`로 설정 되어 있고 업데이트 및 삭제 탭의 드롭다운 목록이 (없음)로 설정 되어 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>

<span data-ttu-id="59367-128">[AddProduct 메서드를 ObjectDataSource s Insert () 메서드에 매핑합니다 ![](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="59367-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="59367-129">**그림 3**: `AddProduct` 메서드를 ObjectDataSource s `Insert()` 메서드에 매핑 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="59367-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>

<span data-ttu-id="59367-130">[![업데이트 및 삭제 탭 드롭다운 목록을 (없음)으로 설정 합니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="59367-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="59367-131">**그림 4**: 업데이트 및 삭제 탭 드롭다운 목록을 (없음)로 설정 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="59367-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>

<span data-ttu-id="59367-132">ObjectDataSource의 데이터 소스 구성 마법사를 완료 한 후 Visual Studio에서 해당 하는 각 데이터 필드에 대 한 필드를 GridView에 자동으로 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="59367-133">지금은 Visual Studio에서 추가한 모든 필드를 그대로 둡니다.</span><span class="sxs-lookup"><span data-stu-id="59367-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="59367-134">이 자습서의 뒷부분에서는 새 레코드를 추가할 때 값을 지정 해야 하는 일부 필드를 다시 시작 하 고 제거 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="59367-135">데이터베이스에는 80 개 제품이 있으므로 사용자는 새 레코드를 추가 하기 위해 웹 페이지의 맨 아래로 스크롤해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="59367-136">따라서를 사용 하 여 삽입 인터페이스를 더 잘 표시 하 고 액세스할 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="59367-137">페이징을 켜려면 GridView의 스마트 태그에서 페이징 사용 확인란을 선택 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="59367-138">이제 GridView와 ObjectDataSource의 선언적 태그가 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]

<span data-ttu-id="59367-139">[![모든 제품 데이터 필드가 페이징된 GridView에 표시 됩니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="59367-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="59367-140">**그림 5**: 모든 제품 데이터 필드가 페이징된 GridView에 표시 됨 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="59367-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="59367-141">2 단계: 바닥글 행 추가</span><span class="sxs-lookup"><span data-stu-id="59367-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="59367-142">GridView는 머리글 및 데이터 행과 함께 바닥글 행을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="59367-143">머리글 및 바닥글 행은 GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) 의 값과 [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) 속성에 따라 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="59367-144">바닥글 행을 표시 하려면 `ShowFooter` 속성을 `True`로 설정 하기만 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="59367-145">그림 6에 나와 있는 것 처럼 `ShowFooter` 속성을 `True`로 설정 하면 바닥글 행이 표에 추가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>

<span data-ttu-id="59367-146">[바닥글 행을 표시 ![ShowFooter를 True로 설정 합니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="59367-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="59367-147">**그림 6**: 바닥글 행을 표시 하려면 `ShowFooter` `True`으로 설정 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="59367-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>

<span data-ttu-id="59367-148">바닥글 행에는 짙은 빨간색 배경색이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="59367-149">이는 ObjectDataSource 자습서를 사용 하 여 [데이터를 표시](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) 하는 모든 페이지에 다시 만들고 적용 한 DataWebControls 테마 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="59367-150">특히 `GridView.skin` 파일은에서 `FooterStyle` CSS 클래스를 사용 하는 `FooterStyle` 속성을 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="59367-151">`FooterStyle` 클래스는 `Styles.css` 다음과 같이 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>

[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="59367-152">이전 자습서에서 GridView s 바닥글 행을 사용 하 여 탐색 했습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="59367-153">필요한 경우 리프레셔에 대 한 [GridView 바닥글 자습서의 요약 정보 표시](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) 를 다시 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="59367-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>

<span data-ttu-id="59367-154">`ShowFooter` 속성을 `True`로 설정한 후 잠시 시간을 내 서 브라우저의 출력을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="59367-155">현재 바닥글 행에는 텍스트 또는 웹 컨트롤이 포함 되어 있지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="59367-156">3 단계에서는 적절 한 삽입 인터페이스가 포함 되도록 각 GridView 필드의 바닥글을 수정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>

<span data-ttu-id="59367-157">[빈 바닥글 행 ![페이징 인터페이스 컨트롤 위에 표시 됩니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="59367-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="59367-158">**그림 7**: 빈 바닥글 행이 페이징 인터페이스 컨트롤 위에 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png)).</span><span class="sxs-lookup"><span data-stu-id="59367-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>

## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="59367-159">3 단계: 바닥글 행 사용자 지정</span><span class="sxs-lookup"><span data-stu-id="59367-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="59367-160">[GridView 컨트롤의 템플릿 필드 사용](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) 자습서에서 BoundFields 또는 CheckBoxFields가 아닌 템플릿 필드를 사용 하 여 특정 GridView 열의 표시를 크게 사용자 지정 하는 방법을 살펴보았습니다. [데이터 수정 인터페이스 사용자 지정](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) 에서 서식 필드를 사용 하 여 GridView의 편집 인터페이스를 사용자 지정 하는 방법을 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="59367-161">Templatefield로 변환은 특정 형식의 행에 사용 되는 태그, 웹 컨트롤 및 데이터 바인딩 구문의 혼합을 정의 하는 여러 템플릿으로 구성 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="59367-162">예를 들어 `ItemTemplate`은 읽기 전용 행에 사용 되는 템플릿을 지정 하는 반면, `EditItemTemplate`은 편집 가능한 행의 템플릿을 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="59367-163">`ItemTemplate` 및 `EditItemTemplate`와 함께 Templatefield로 변환에는 바닥글 행에 대 한 콘텐츠를 지정 하는 `FooterTemplate`도 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="59367-164">따라서 인터페이스를 삽입 하는 각 필드에 필요한 웹 컨트롤을 `FooterTemplate`에 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="59367-165">시작 하려면 GridView의 모든 필드를 템플릿 필드로 변환 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="59367-166">이렇게 하려면 GridView의 스마트 태그에서 열 편집 링크를 클릭 하 고 왼쪽 아래 모퉁이의 각 필드를 선택한 다음이 필드를 Templatefield로 변환으로 변환 링크를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>

![각 필드를 Templatefield로 변환 변환](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="59367-168">**그림 8**: 각 필드를 templatefield로 변환 변환</span><span class="sxs-lookup"><span data-stu-id="59367-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>

<span data-ttu-id="59367-169">이 필드를 Templatefield로 변환 변환을 클릭 하면 현재 필드 형식이 해당 Templatefield로 변환으로 변환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="59367-170">예를 들어 각 BoundField는 해당 데이터 필드를 표시 하는 레이블과 텍스트 상자에 데이터 필드를 표시 하는 `EditItemTemplate`를 포함 하는 `ItemTemplate` Templatefield로 변환로 바뀝니다.</span><span class="sxs-lookup"><span data-stu-id="59367-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="59367-171">`ProductName` BoundField는 다음 Templatefield로 변환 태그로 변환 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="59367-172">마찬가지로 `Discontinued` CheckBoxField는 `ItemTemplate`와 `EditItemTemplate`에 CheckBox 웹 컨트롤 (`ItemTemplate` s 확인란을 사용 하지 않도록 설정 됨)이 포함 되어 있는 Templatefield로 변환로 변환 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="59367-173">읽기 전용 `ProductID` BoundField는 `ItemTemplate` 및 `EditItemTemplate`모두에 레이블 컨트롤이 있는 Templatefield로 변환으로 변환 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="59367-174">간단히 말해서 기존 GridView 필드를 Templatefield로 변환으로 변환 하는 것은 기존 필드 기능을 잃지 않고 보다 사용자 지정 가능한 Templatefield로 변환로 전환 하는 빠르고 쉬운 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="59367-175">에서 작업을 수행 하는 GridView는 편집을 지원 하지 않으므로 각 Templatefield로 변환에서 `EditItemTemplate`를 제거 하 여 `ItemTemplate`만 남겨 보세요.</span><span class="sxs-lookup"><span data-stu-id="59367-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="59367-176">이 작업을 수행한 후 GridView의 선언 태그는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-176">After doing this, your GridView s declarative markup should look like the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="59367-177">이제 각 GridView 필드가 Templatefield로 변환로 변환 되었으므로 `FooterTemplate`각 필드에 적절 한 삽입 인터페이스를 입력할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="59367-178">일부 필드에는 삽입 인터페이스가 없습니다 (예를 들어`ProductID`). 다른 항목은 새 제품 정보를 수집 하는 데 사용 되는 웹 컨트롤에 따라 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="59367-179">편집 인터페이스를 만들려면 GridView의 스마트 태그에서 템플릿 편집 링크를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="59367-180">그런 다음 드롭다운 목록에서 적절 한 필드 `FooterTemplate`를 선택 하 고 도구 상자의 적절 한 컨트롤을 디자이너로 끌어 옵니다.</span><span class="sxs-lookup"><span data-stu-id="59367-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>

<span data-ttu-id="59367-181">[![각 필드에 적절 한 삽입 인터페이스를 추가 합니다. FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="59367-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="59367-182">**그림 9**: 각 필드 `FooterTemplate`에 적절 한 삽입 인터페이스 추가 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="59367-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>

<span data-ttu-id="59367-183">다음 글머리 기호 목록은 추가할 인터페이스를 지정 하 여 GridView 필드를 열거 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="59367-184">없음을 `ProductID` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-184">`ProductID` none.</span></span>
- <span data-ttu-id="59367-185">`ProductName` 텍스트 상자를 추가 하 고 해당 `ID`를 `NewProductName`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="59367-186">사용자가 새 제품 이름에 대 한 값을 입력할 수 있도록 RequiredFieldValidator 컨트롤을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="59367-187">없음을 `SupplierID` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-187">`SupplierID` none.</span></span>
- <span data-ttu-id="59367-188">없음을 `CategoryID` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-188">`CategoryID` none.</span></span>
- <span data-ttu-id="59367-189">텍스트 상자를 추가 `QuantityPerUnit` `ID`를 `NewQuantityPerUnit`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="59367-190">입력 한 값이 0 보다 크거나 같은 통화 값 인지 확인 하는 `NewUnitPrice` 라는 텍스트 상자와 CompareValidator를 추가 `UnitPrice` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="59367-191">`ID` `NewUnitsInStock`으로 설정 된 텍스트 상자를 사용 `UnitsInStock` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="59367-192">입력 한 값이 0 보다 크거나 같은 정수 값 인지 확인 하는 CompareValidator를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="59367-193">`ID` `NewUnitsOnOrder`으로 설정 된 텍스트 상자를 사용 `UnitsOnOrder` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="59367-194">입력 한 값이 0 보다 크거나 같은 정수 값 인지 확인 하는 CompareValidator를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="59367-195">`ID` `NewReorderLevel`으로 설정 된 텍스트 상자를 사용 `ReorderLevel` 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="59367-196">입력 한 값이 0 보다 크거나 같은 정수 값 인지 확인 하는 CompareValidator를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="59367-197">확인란을 추가 `Discontinued` `ID`를 `NewDiscontinued`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="59367-198">`CategoryName` DropDownList을 추가 하 고 해당 `ID`를 `NewCategoryID`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="59367-199">`CategoriesDataSource` 새 ObjectDataSource에 바인딩하고 `CategoriesBLL` 클래스 s `GetCategories()` 메서드를 사용 하도록 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="59367-200">`CategoryID` 데이터 필드를 값으로 사용 하 여 `ListItem` s에 `CategoryName` 데이터 필드를 표시 하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="59367-201">`SupplierName` DropDownList을 추가 하 고 해당 `ID`를 `NewSupplierID`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="59367-202">`SuppliersDataSource` 새 ObjectDataSource에 바인딩하고 `SuppliersBLL` 클래스 s `GetSuppliers()` 메서드를 사용 하도록 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="59367-203">`SupplierID` 데이터 필드를 값으로 사용 하 여 `ListItem` s에 `CompanyName` 데이터 필드를 표시 하도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="59367-204">각 유효성 검사 컨트롤에 대해 `FooterStyle` CSS 클래스의 흰색 전경색이 기본값 빨강 대신 사용 되도록 `ForeColor` 속성을 지웁니다.</span><span class="sxs-lookup"><span data-stu-id="59367-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="59367-205">또한 자세한 설명에는 `ErrorMessage` 속성을 사용 하 고 `Text` 속성은 별표로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="59367-206">유효성 검사 컨트롤의 텍스트에서 삽입 인터페이스를 두 줄로 래핑할 수 없도록 하려면 유효성 검사 컨트롤을 사용 하는 각 `FooterTemplate`에 대해 `FooterStyle` s `Wrap` 속성을 false로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="59367-207">마지막으로 GridView 아래에 ValidationSummary 컨트롤을 추가 하 고 해당 `ShowMessageBox` 속성을 `True`로 설정 하 고 `ShowSummary` 속성을 `False`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="59367-208">새 제품을 추가할 때 `CategoryID` 및 `SupplierID`를 제공 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="59367-209">이 정보는 `CategoryName` 및 `SupplierName` 필드에 대 한 바닥글 셀의 Dropdownlist을 통해 캡처됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="59367-210">`CategoryID` 및 `SupplierID` 템플릿 필드와는 달리 이러한 필드를 사용 하도록 선택 했습니다. 그리드 s 데이터 행에서 사용자는 ID 값이 아닌 범주 및 공급자 이름을 보는 데 더 관심이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="59367-211">`CategoryID` 및 `SupplierID` 값은 이제 `CategoryName` 및 `SupplierName` 필드의 삽입 인터페이스에 캡처되고 있으므로 GridView에서 `CategoryID` 및 `SupplierID` 템플릿 필드를 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="59367-212">마찬가지로 `ProductID`는 새 제품을 추가할 때 사용 되지 않으므로 `ProductID` Templatefield로 변환 제거 될 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="59367-213">그러나 `ProductID` 필드를 모눈에 남겨 둡니다.</span><span class="sxs-lookup"><span data-stu-id="59367-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="59367-214">삽입 인터페이스를 구성 하는 텍스트 상자, Dropdownlist, 확인란 및 유효성 검사 컨트롤 외에도, 클릭 하면 데이터베이스에 새 제품을 추가 하는 논리를 수행 하는 추가 단추도 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="59367-215">4 단계에서는 `ProductID` Templatefield로 변환 s `FooterTemplate`의 삽입 인터페이스에 추가 단추를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="59367-216">자유롭게 다양 한 GridView 필드의 모양을 개선 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="59367-217">예를 들어 `UnitPrice` 값의 서식을 통화로 지정 하 고, `UnitsInStock`, `UnitsOnOrder`및 `ReorderLevel` 필드를 오른쪽에 맞추고, 템플릿 필드의 `HeaderText` 값을 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="59367-218">`FooterTemplate` s에 인터페이스를 삽입 하는 slew을 만들고, `SupplierID`를 제거 하 고, 템플릿 필드를 `CategoryID` 하 고, 템플릿 필드를 정렬 하 고 서식을 지정 하 여 그리드의 미관를 향상 시키고, GridView의 선언적 태그는 다음과 유사 하 게 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="59367-219">브라우저를 통해 볼 때 GridView s 바닥글 행에는 완성 된 삽입 인터페이스가 포함 됩니다 (그림 10 참조).</span><span class="sxs-lookup"><span data-stu-id="59367-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="59367-220">이 시점에서 삽입 인터페이스에는 사용자가 새 제품에 대 한 데이터를 입력 하 고 데이터베이스에 새 레코드를 삽입 하 려 함을 나타낼 수 있는 방법이 포함 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="59367-221">또한 바닥글에 입력 한 데이터를 `Products` 데이터베이스의 새 레코드로 변환 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="59367-222">4 단계에서 삽입 인터페이스에 추가 단추를 포함 하는 방법 및 클릭 하면 다시 게시 시 코드를 실행 하는 방법을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="59367-223">5 단계에서는 바닥글의 데이터를 사용 하 여 새 레코드를 삽입 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="59367-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>

<span data-ttu-id="59367-224">[![GridView 바닥글은 새 레코드를 추가 하기 위한 인터페이스를 제공 합니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="59367-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="59367-225">**그림 10**: GridView 바닥글은 새 레코드를 추가 하기 위한 인터페이스를 제공 합니다 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="59367-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>

## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="59367-226">4 단계: 삽입 인터페이스에 추가 단추 포함</span><span class="sxs-lookup"><span data-stu-id="59367-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="59367-227">바닥글 행 s 삽입 인터페이스에는 현재 사용자가 새 제품 정보 입력을 완료 했음을 나타낼 수 있는 방법이 없으므로 삽입 인터페이스에 추가 단추를 포함 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="59367-228">기존 `FooterTemplate` s 중 하나에 배치 하거나이 목적을 위해 표에 새 열을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="59367-229">이 자습서에서는 `ProductID` Templatefield로 변환 s `FooterTemplate`에 추가 단추를 놓습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="59367-230">디자이너에서 GridView s 스마트 태그의 템플릿 편집 링크를 클릭 한 다음 드롭다운 목록에서 `ProductID` 필드 `FooterTemplate`를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="59367-231">단추 웹 컨트롤 (또는 원하는 경우 LinkButton 또는 ImageButton)을 템플릿에 설정 하 고, 해당 ID를 `AddProduct`로 설정 하 고, `CommandName` 삽입 하 고, `Text` 속성을 그림 11과 같이 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>

<span data-ttu-id="59367-232">[![ProductID Templatefield로 변환 s FooterTemplate에 추가 단추를 놓습니다.](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="59367-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="59367-233">**그림 11**: `ProductID` templatefield로 변환 s `FooterTemplate`에 추가 단추를 놓습니다 ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png)).</span><span class="sxs-lookup"><span data-stu-id="59367-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>

<span data-ttu-id="59367-234">추가 단추를 포함 한 후에는 브라우저에서 페이지를 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="59367-235">삽입 인터페이스에 잘못 된 데이터가 포함 된 추가 단추를 클릭할 때 포스트백은 짧은 short-circuit이 고 ValidationSummary 컨트롤은 잘못 된 데이터를 나타냅니다 (그림 12 참조).</span><span class="sxs-lookup"><span data-stu-id="59367-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="59367-236">적절 한 데이터를 입력 하면 추가 단추를 클릭 하면 포스트백이 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="59367-237">그러나 데이터베이스에는 레코드가 추가 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-237">No record is added to the database, however.</span></span> <span data-ttu-id="59367-238">실제로 삽입을 수행 하려면 약간의 코드를 작성 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-238">We will need to write a bit of code to actually perform the insert.</span></span>

<span data-ttu-id="59367-239">[삽입 인터페이스에 잘못 된 데이터가 있는 경우 추가 단추를 다시 게시 하는 것이 짧은 Short-circuit ![](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="59367-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="59367-240">**그림 12**: 삽입 인터페이스에 잘못 된 데이터가 있는 경우 추가 단추 s 포스트백은 짧은 short-circuit ([전체 크기 이미지를 보려면 클릭](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="59367-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>

> [!NOTE]
> <span data-ttu-id="59367-241">삽입 인터페이스의 유효성 검사 컨트롤이 유효성 검사 그룹에 할당 되지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="59367-242">이는 삽입 인터페이스가 페이지의 유일한 유효성 검사 컨트롤 집합인 경우에만 제대로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="59367-243">그러나 페이지에 다른 유효성 검사 컨트롤이 있는 경우 (예: 그리드 s 편집 인터페이스의 유효성 검사 컨트롤) 삽입 인터페이스 및 추가 단추 `ValidationGroup` 속성의 유효성 검사 컨트롤에는 이러한 컨트롤과 특정 유효성 검사 그룹을 연결 하기 위해 동일한 값이 할당 되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="59367-244">페이지의 유효성 검사 컨트롤 및 단추를 유효성 검사 그룹으로 분할 하는 방법에 대 한 자세한 내용은 [ASP.NET 2.0의 유효성 검사 컨트롤 개로 나누어서을](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="59367-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>

## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="59367-245">5 단계:`Products`테이블에 새 레코드 삽입</span><span class="sxs-lookup"><span data-stu-id="59367-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="59367-246">Gridview의 기본 제공 편집 기능을 활용 하는 경우 GridView는 업데이트를 수행 하는 데 필요한 모든 작업을 자동으로 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="59367-247">특히 업데이트 단추를 클릭 하면 편집 인터페이스에서 입력 한 값이 ObjectDataSource s `UpdateParameters` 컬렉션의 매개 변수에 복사 되 고 ObjectDataSource s `Update()` 메서드를 호출 하 여 업데이트가 시작 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="59367-248">GridView는 이러한 기본 제공 기능을 삽입 하는 기능을 제공 하지 않으므로 ObjectDataSource s `Insert()` 메서드를 호출 하는 코드를 구현 하 고 삽입 인터페이스의 값을 ObjectDataSource s `InsertParameters` 컬렉션에 복사 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="59367-249">이 삽입 논리는 추가 단추를 클릭 한 후에 실행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="59367-250">GridView의 단추 [추가 및 응답](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) 에 설명 된 대로 Gridview의 단추, LinkButton 또는 ImageButton이 클릭 될 때마다 gridview s `RowCommand` 이벤트가 다시 게시 될 때 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="59367-251">이 이벤트는 단추, LinkButton 또는 ImageButton이 바닥글 행의 추가 단추와 같이 명시적으로 추가 되었거나 GridView에서 자동으로 추가 된 경우 (예: 정렬을 사용 하도록 설정 된 경우 각 열의 맨 위에 있는 Linkbutton 또는 페이징 사용이 선택 된 경우 페이징 인터페이스의 Linkbutton를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="59367-252">따라서 사용자에 게 추가 단추를 클릭 하 여 응답 하려면 GridView s `RowCommand` 이벤트에 대 한 이벤트 처리기를 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="59367-253">이 이벤트는 GridView의 *단추,* LinkButton 또는 ImageButton을 클릭할 때마다 발생 하므로 이벤트 처리기에 전달 된 `CommandName` 속성이 추가 단추 (Insert)의 `CommandName` 값에 매핑되는 경우에만 삽입 논리를 진행 하는 것이 중요 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="59367-254">또한 유효성 검사 컨트롤이 유효한 데이터를 보고 하는 경우에만 계속 진행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="59367-255">이를 위해 다음 코드를 사용 하 여 `RowCommand` 이벤트에 대 한 이벤트 처리기를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="59367-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="59367-256">이벤트 처리기가 `Page.IsValid` 속성을 bothers 확인 하는 이유가 궁금할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="59367-257">그 후에는 삽입 인터페이스에 잘못 된 데이터가 제공 된 경우 포스트백이 억제 되지 않습니까?</span><span class="sxs-lookup"><span data-stu-id="59367-257">After all, won't the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="59367-258">이 가정은 사용자가 JavaScript를 사용 하지 않도록 설정 하거나 클라이언트 쪽 유효성 검사 논리를 우회 하는 단계를 수행한 경우에만 올바릅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="59367-259">간단히 말해서 클라이언트 쪽 유효성 검사를 엄격 하 게 사용 하면 안 됩니다. 데이터를 사용 하기 전에 서버 쪽 유효성 검사를 항상 수행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>

<span data-ttu-id="59367-260">1 단계에서는 `Insert()` 메서드가 `ProductsBLL` 클래스의 `AddProduct` 메서드에 매핑되도록 `ProductsDataSource` ObjectDataSource를 만들었습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="59367-261">`Products` 테이블에 새 레코드를 삽입 하려면 ObjectDataSource s `Insert()` 메서드를 호출 하기만 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="59367-262">`Insert()` 메서드를 호출 했으므로 이제는 삽입 인터페이스에서 `ProductsBLL` 클래스 s `AddProduct` 메서드에 전달 된 매개 변수에 값을 복사 하는 것만 남았습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="59367-263">[삽입, 업데이트 및 삭제 자습서와 관련 된 이벤트를 검사](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) 하는 방법에 대 한 자세한 내용은 ObjectDataSource s `Inserting` 이벤트를 통해 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="59367-264">`Inserting` 이벤트에서 `Products` GridView s 바닥글 행의 컨트롤을 프로그래밍 방식으로 참조 하 고 `e.InputParameters` 컬렉션에 해당 값을 할당 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="59367-265">사용자가 `ReorderLevel` 텍스트 상자를 비워 두는 것과 같은 값을 생략 한 경우에는 데이터베이스에 삽입 된 값을 `NULL`하도록 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="59367-266">`AddProducts` 메서드는 nullable 데이터베이스 필드에 nullable 형식을 허용 하므로 사용자 입력이 생략 된 경우 nullable 형식을 사용 하 고 해당 값을 `Nothing`로 설정 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="59367-267">`Inserting` 이벤트 처리기가 완료 되 면 GridView 바닥글 행을 통해 `Products` 데이터베이스 테이블에 새 레코드를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="59367-268">계속 해 서 몇 가지 새 제품을 추가 해 보세요.</span><span class="sxs-lookup"><span data-stu-id="59367-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="59367-269">추가 작업 향상 및 사용자 지정</span><span class="sxs-lookup"><span data-stu-id="59367-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="59367-270">현재 추가 단추를 클릭 하 여 데이터베이스 테이블에 새 레코드를 추가 하지만 레코드가 성공적으로 추가 되었다는 시각적 피드백은 제공 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="59367-271">이상적인 경우 레이블 웹 컨트롤 또는 클라이언트 쪽 경고 상자는 삽입이 성공 상태로 완료 되었음을 사용자에 게 알립니다.</span><span class="sxs-lookup"><span data-stu-id="59367-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="59367-272">독자를 위한 연습으로 남겨 둡니다.</span><span class="sxs-lookup"><span data-stu-id="59367-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="59367-273">이 자습서에 사용 된 GridView는 나열 된 제품에 정렬 순서를 적용 하지 않으며 최종 사용자가 데이터를 정렬할 수 없도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="59367-274">따라서 레코드는 기본 키 필드에 따라 데이터베이스에 있는 것 처럼 정렬 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="59367-275">각 새 레코드에는 마지막 값 보다 큰 `ProductID` 값이 있으므로 새 제품이 추가 될 때마다 표 끝에 누적 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="59367-276">따라서 새 레코드를 추가한 후 GridView의 마지막 페이지에 사용자를 자동으로 보낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="59367-277">이 작업을 수행 하려면 `RowCommand` 이벤트 처리기에서 `ProductsDataSource.Insert()`를 호출한 후 다음 코드 줄을 추가 하 여 데이터를 GridView에 바인딩한 후 사용자를 마지막 페이지로 보내야 함을 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="59367-278">`SendUserToLastPage`은 `False`값이 처음 할당 된 페이지 수준 부울 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="59367-279">GridView s `DataBound` 이벤트 처리기에서 `SendUserToLastPage`이 false 이면 `PageIndex` 속성이 업데이트 되어 사용자를 마지막 페이지로 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>

[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="59367-280">`DataBound` 이벤트 처리기에서 `PageIndex` 속성이 설정 된 이유 (`RowCommand` 이벤트 처리기와는 달리)는 `RowCommand` 이벤트 처리기가 실행 될 때 `Products` 데이터베이스 테이블에 새 레코드를 추가 하기 때문에 발생 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="59367-281">따라서 `RowCommand` 이벤트 처리기에서 마지막 페이지 인덱스 (`PageCount - 1`)는 새 제품이 추가 *되기 전의* 마지막 페이지 인덱스를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="59367-282">대부분 추가 되는 제품의 경우 새 제품을 추가한 후 마지막 페이지 인덱스는 동일 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="59367-283">그러나 추가 된 제품이 새 마지막 페이지 인덱스를 사용 하는 경우 `RowCommand` 이벤트 처리기에서 `PageIndex`를 잘못 업데이트 하면 마지막 페이지 인덱스와는 달리 마지막 페이지 (새 제품을 추가 하기 전의 마지막 페이지 인덱스)로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="59367-284">`DataBound` 이벤트 처리기는 새 제품이 추가 된 후에 실행 되 고 데이터가 그리드로 다시 바인딩 되었으므로 `PageIndex` 속성을 설정 하 여 올바른 마지막 페이지 인덱스를 다시 가져오는 것을 알 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="59367-285">마지막으로,이 자습서에 사용 된 GridView는 새 제품을 추가 하기 위해 수집 해야 하는 필드의 수로 인해 상당히 광범위 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="59367-286">이 너비로 인해 DetailsView의 세로 레이아웃을 선호 하는 경우가 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="59367-287">적은 수의 입력을 수집 하 여 GridView의 전체 너비를 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="59367-288">새 제품을 추가할 때 `UnitsOnOrder`, `UnitsInStock`및 `ReorderLevel` 필드를 수집할 필요가 없습니다 .이 경우 GridView에서 이러한 필드를 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="59367-289">수집 된 데이터를 조정 하기 위해 다음 두 가지 방법 중 하나를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="59367-290">`UnitsOnOrder`, `UnitsInStock`및 `ReorderLevel` 필드에 대 한 값이 필요한 `AddProduct` 메서드를 계속 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="59367-291">`Inserting` 이벤트 처리기에서 삽입 인터페이스에서 제거 된 이러한 입력에 사용할 하드 코드 된 기본값을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="59367-292">`ProductsBLL` 클래스에서 `UnitsOnOrder`, `UnitsInStock`및 `ReorderLevel` 필드의 입력을 허용 하지 않는 `AddProduct` 메서드의 새 오버 로드를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="59367-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="59367-293">그런 다음 ASP.NET 페이지에서이 새 오버 로드를 사용 하도록 ObjectDataSource를 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="59367-294">두 옵션 모두 동일 하 게 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-294">Either option will work equally as well.</span></span> <span data-ttu-id="59367-295">이전 자습서에서는 두 번째 옵션을 사용 하 여 `ProductsBLL` 클래스 `UpdateProduct` 메서드에 대해 여러 오버 로드를 생성 했습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="59367-296">요약</span><span class="sxs-lookup"><span data-stu-id="59367-296">Summary</span></span>

<span data-ttu-id="59367-297">GridView는 DetailsView 및 FormView에 있는 기본 제공 삽입 기능을 제공 하지 않지만 삽입 인터페이스를 바닥글 행에 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="59367-298">GridView에 바닥글 행을 표시 하려면 단순히 해당 `ShowFooter` 속성을 `True`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="59367-299">필드를 Templatefield로 변환 변환 하 고 삽입 인터페이스를 `FooterTemplate`에 추가 하 여 각 필드에 대해 바닥글 행 콘텐츠를 사용자 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="59367-300">이 자습서에서 살펴본 것 처럼 `FooterTemplate`에는 데이터 기반 웹 컨트롤 (예: Dropdownlist) 및 유효성 검사 컨트롤을 채울 수 있는 단추, 텍스트 상자, Dropdownlist, 확인란, 데이터 소스 컨트롤이 포함 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="59367-301">사용자 입력을 수집 하는 컨트롤과 함께 추가 단추, LinkButton 또는 ImageButton이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="59367-302">추가 단추를 클릭 하면 삽입 워크플로를 시작 하기 위해 ObjectDataSource s `Insert()` 메서드가 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="59367-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="59367-303">그런 다음 ObjectDataSource는 구성 된 삽입 메서드 (이 자습서에서는 `ProductsBLL` 클래스 `AddProduct` 메서드)를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="59367-304">삽입 메서드를 호출 하기 전에 GridView s 삽입 인터페이스의 값을 ObjectDataSource s `InsertParameters` 컬렉션에 복사 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="59367-305">이렇게 하려면 ObjectDataSource s `Inserting` 이벤트 처리기에서 인터페이스 삽입 웹 컨트롤을 프로그래밍 방식으로 참조 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="59367-306">이 자습서에서는 GridView의 모양을 향상 시키는 방법을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="59367-307">다음 자습서 집합에서는 이미지, Pdf, Word 문서 등의 이진 데이터를 사용 하는 방법과 데이터 웹 컨트롤을 사용 하는 방법을 살펴봅니다.</span><span class="sxs-lookup"><span data-stu-id="59367-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="59367-308">행복 한 프로그래밍</span><span class="sxs-lookup"><span data-stu-id="59367-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="59367-309">저자 정보</span><span class="sxs-lookup"><span data-stu-id="59367-309">About the Author</span></span>

<span data-ttu-id="59367-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(7 개의 ASP/ASP. NET books 및 [4GuysFromRolla.com](http://www.4guysfromrolla.com)창립자)은 1998부터 Microsoft 웹 기술을 사용 하 여 작업 했습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="59367-311">Scott은 독립 컨설턴트, 강사 및 기록기로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="59367-312">최신 책은 [*24 시간 이내에 ASP.NET 2.0을 sams teach yourself*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)것입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="59367-313">mitchell@4GuysFromRolla.com에 도달할 수 있습니다 [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="59367-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="59367-314">또는 블로그를 통해 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)에서 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="59367-315">특별히 감사 합니다.</span><span class="sxs-lookup"><span data-stu-id="59367-315">Special Thanks To</span></span>

<span data-ttu-id="59367-316">이 자습서 시리즈는 많은 유용한 검토자가 검토 했습니다.</span><span class="sxs-lookup"><span data-stu-id="59367-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="59367-317">이 자습서의 리드 검토자는 Bernadette Leigh입니다.</span><span class="sxs-lookup"><span data-stu-id="59367-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="59367-318">예정 된 MSDN 문서를 검토 하는 데 관심이 있나요?</span><span class="sxs-lookup"><span data-stu-id="59367-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="59367-319">그렇다면mitchell@4GuysFromRolla.com에서 줄을 삭제 [합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="59367-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="59367-320">이전</span><span class="sxs-lookup"><span data-stu-id="59367-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)

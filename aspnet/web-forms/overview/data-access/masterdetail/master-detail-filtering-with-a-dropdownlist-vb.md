---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: DropDownList를 사용 하 여 마스터/세부 정보 필터링 (VB) | Microsoft Docs
author: rick-anderson
description: 이 자습서에서는 GridView에서 마스터 레코드를 표시 하는 방법과 GridView에서 선택한 목록 항목의 세부 정보를 표시 하는 방법을 알아봅니다.
ms.author: riande
ms.date: 03/31/2010
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 62cd296a3f36e1779666a6b5db15b0ce2488d0e4
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78424487"
---
# <a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="b0853-103">DropDownList 한 개로 마스터/세부 정보 필터링(VB)</span><span class="sxs-lookup"><span data-stu-id="b0853-103">Master/Detail Filtering With a DropDownList (VB)</span></span>

<span data-ttu-id="b0853-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b0853-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b0853-105">[샘플 앱 다운로드](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) 또는 [PDF 다운로드](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b0853-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="b0853-106">이 자습서에서는 GridView에서 마스터 레코드를 표시 하는 방법과 GridView에서 선택한 목록 항목의 세부 정보를 표시 하는 방법을 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="b0853-107">소개</span><span class="sxs-lookup"><span data-stu-id="b0853-107">Introduction</span></span>

<span data-ttu-id="b0853-108">일반 보고서 유형으로는 *마스터/세부 정보 보고서*가 있습니다 .이 보고서는 보고서가 "마스터" 레코드 집합을 표시 하는 것으로 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="b0853-109">그러면 사용자가 마스터 레코드 중 하나로 드릴 다운 하 여 해당 마스터 레코드의 "세부 정보"를 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="b0853-110">마스터/세부 정보 보고서는 모든 범주를 표시 하는 보고서와 같이 사용자가 특정 범주를 선택 하 고 연결 된 제품을 표시할 수 있도록 하는 일대다 관계를 시각화 하는 데 적합 한 옵션입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="b0853-111">또한 마스터/세부 정보 보고서는 특히 많은 열을 포함 하는 테이블의 세부 정보를 표시 하는 데 유용 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="b0853-112">예를 들어 마스터/세부 보고서의 "마스터" 수준에는 데이터베이스에 있는 제품의 제품 이름 및 단가만 표시 되 고 특정 제품으로 드릴 다운 하면 추가 제품 필드 (범주, 공급자, 단위당 수량 등)가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="b0853-113">마스터/세부 정보 보고서를 구현할 수 있는 여러 가지 방법이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="b0853-114">이를 통해 다음 세 가지 자습서에서는 다양 한 마스터/세부 정보 보고서를 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="b0853-115">이 자습서에서는 GridView에서 마스터 [레코드를 표시](https://msdn.microsoft.com/library/dtx91y0z.aspx) 하는 방법과 GridView에서 선택한 목록 항목의 세부 정보를 표시 하는 방법을 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="b0853-116">특히이 자습서의 마스터/세부 정보 보고서에는 범주 및 제품 정보가 나열 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="b0853-117">1 단계: DropDownList에 범주 표시</span><span class="sxs-lookup"><span data-stu-id="b0853-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="b0853-118">마스터/세부 정보 보고서에는 선택한 목록 항목의 제품이 GridView의 페이지 아래쪽에 표시 되는 DropDownList의 범주가 나열 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="b0853-119">앞서 첫 번째 작업은 범주를 DropDownList에 표시 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="b0853-120">`Filtering` 폴더에서 `FilterByDropDownList.aspx` 페이지를 열고 도구 상자에서 페이지의 디자이너로 DropDownList를 끌어서 `ID` 속성을 `Categories`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="b0853-121">다음으로, DropDownList의 스마트 태그에서 데이터 소스 선택 링크를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="b0853-122">그러면 데이터 소스 구성 마법사가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-122">This will display the Data Source Configuration wizard.</span></span>

<span data-ttu-id="b0853-123">[DropDownList의 데이터 원본을 지정 ![](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="b0853-124">**그림 1**: DropDownList의 데이터 원본 지정 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>

<span data-ttu-id="b0853-125">`CategoriesBLL` 클래스의 `GetCategories()` 메서드를 호출 하는 `CategoriesDataSource` 라는 새 ObjectDataSource를 추가 하도록 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>

<span data-ttu-id="b0853-126">[새 ObjectDataSource 명명 된 범주 Datasource를 추가 ![](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="b0853-127">**그림 2**: 이름이 `CategoriesDataSource` 새 ObjectDataSource 추가 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>

<span data-ttu-id="b0853-128">[![범주 Bll 클래스를 사용 하도록 선택 합니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="b0853-129">**그림 3**: `CategoriesBLL` 클래스를 사용 하도록 선택 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>

<span data-ttu-id="b0853-130">[GetCategories () 메서드를 사용 하도록 ObjectDataSource를 구성 ![](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="b0853-131">**그림 4**: `GetCategories()` 메서드를 사용 하도록 ObjectDataSource 구성 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>

<span data-ttu-id="b0853-132">ObjectDataSource를 구성한 후에는 DropDownList에 표시 해야 하는 데이터 원본 필드와 목록 항목의 값으로 연결 해야 하는 데이터 원본 필드를 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="b0853-133">`CategoryName` 필드를 표시 하 고 각 목록 항목의 값으로 `CategoryID` 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>

<span data-ttu-id="b0853-134">[DropDownList에서 범주 필드를 표시 하 고 CategoryID를 값으로 사용 ![](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="b0853-135">**그림 5**: DropDownList에 `CategoryName` 필드가 표시 되 고 `CategoryID` 값으로 사용 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>

<span data-ttu-id="b0853-136">이 시점에서 `Categories` 테이블의 레코드를 사용 하 여 채워진 DropDownList 컨트롤이 있습니다 (약 6 초 후에 수행 됨).</span><span class="sxs-lookup"><span data-stu-id="b0853-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="b0853-137">그림 6에서는 브라우저를 통해 볼 때의 진행률을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>

<span data-ttu-id="b0853-138">[드롭다운 목록에서 현재 범주를 ![합니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="b0853-139">**그림 6**: 드롭다운 목록에 현재 범주가 나열 됩니다 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="b0853-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>

## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="b0853-140">2 단계: Products GridView 추가</span><span class="sxs-lookup"><span data-stu-id="b0853-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="b0853-141">마스터/세부 정보 보고서의 마지막 단계는 선택한 범주와 관련 된 제품을 나열 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="b0853-142">이를 수행 하려면 페이지에 GridView를 추가 하 고 이름이 `productsDataSource`인 새 ObjectDataSource를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="b0853-143">`productsDataSource` 컨트롤이 `ProductsBLL` 클래스의 `GetProductsByCategoryID(categoryID)` 메서드에서 데이터를 추려내 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>

<span data-ttu-id="b0853-144">[![GetProductsByCategoryID (categoryID) 메서드를 선택 합니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="b0853-145">**그림 7**: `GetProductsByCategoryID(categoryID)` 방법 선택 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>

<span data-ttu-id="b0853-146">이 메서드를 선택 하면 ObjectDataSource 마법사에서 메서드의 *`categoryID`* 매개 변수에 대 한 값을 묻는 메시지를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="b0853-147">선택한 `categories` DropDownList 항목의 값을 사용 하려면 매개 변수 소스를 제어 하 고 ControlID를 `Categories`설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>

<span data-ttu-id="b0853-148">[categoryID 매개 변수를 DropDownList 범주의 값으로 설정 ![합니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="b0853-149">**그림 8**: *`categoryID`* 매개 변수를 `Categories` DropDownList 값으로 설정 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>

<span data-ttu-id="b0853-150">잠시 후 브라우저에서 진행 상황을 확인해 보세요.</span><span class="sxs-lookup"><span data-stu-id="b0853-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="b0853-151">페이지를 처음 방문 하면 선택 된 범주 (음료)에 속하는 해당 제품이 표시 됩니다 (그림 9에 표시 된 것 처럼). 그러나 DropDownList를 변경 해도 데이터가 업데이트 되지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="b0853-152">이는 GridView를 업데이트 하기 위해 포스트백이 수행 되어야 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="b0853-153">이를 위해 다음 두 가지 옵션을 사용할 수 없습니다 (코드를 작성 해야 하는 것은 아님).</span><span class="sxs-lookup"><span data-stu-id="b0853-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="b0853-154">**범주 DropDownList의**[AutoPostBack 속성](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)을**True로** 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="b0853-155">이는 DropDownList의 스마트 태그에서 Enable AutoPostBack 옵션을 선택 하 여 수행할 수 있습니다. 이렇게 하면 사용자가 DropDownList의 선택 된 항목을 변경할 때마다 포스트백이 트리거됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="b0853-156">따라서 사용자가 DropDownList에서 새 범주를 선택 하면 포스트백이 뒤따르게 되 고 새로 선택한 범주에 대 한 제품으로 GridView가 업데이트 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="b0853-157">이 방법은이 자습서에서 사용한 방법입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="b0853-158">**DropDownList 옆에 단추 웹 컨트롤을 추가 합니다.**</span><span class="sxs-lookup"><span data-stu-id="b0853-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="b0853-159">`Text` 속성을 새로 고침으로 설정 하거나 비슷한 항목으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="b0853-160">이 방법에서는 사용자가 새 범주를 선택 하 고 단추를 클릭 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="b0853-161">단추를 클릭 하면 포스트백이 발생 하 고 GridView를 업데이트 하 여 선택한 범주의 제품이 나열 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="b0853-162">그림 9와 10은 마스터/세부 보고서를 실행 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>

<span data-ttu-id="b0853-163">[페이지를 처음 방문할 때 ![음료 제품이 표시 됩니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="b0853-164">**그림 9**: 페이지를 처음 방문할 때 음료 제품이 표시 됩니다 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png)).</span><span class="sxs-lookup"><span data-stu-id="b0853-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>

<span data-ttu-id="b0853-165">[새 제품 (생성)을 선택 ![자동으로 포스트백이 발생 하 고 GridView가 업데이트 됩니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="b0853-166">**그림 10**: 새 제품 (생성)을 선택 하면 자동으로 다시 게시 되 고 GridView가 업데이트 됩니다 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png)).</span><span class="sxs-lookup"><span data-stu-id="b0853-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>

## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="b0853-167">"--범주 선택--" 목록 항목 추가</span><span class="sxs-lookup"><span data-stu-id="b0853-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="b0853-168">`FilterByDropDownList.aspx` 페이지를 처음 방문 하면 범주 DropDownList의 첫 번째 목록 항목 (음료)이 기본적으로 선택 되어 GridView의 음료 제품이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="b0853-169">첫 번째 범주의 제품을 표시 하는 대신 "--범주 선택--"과 같은 항목을 선택 하는 DropDownList 항목을 대신 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="b0853-170">DropDownList에 새 목록 항목을 추가 하려면 속성 창로 이동 하 여 `Items` 속성에서 줄임표를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="b0853-171">`Text` "--범주 선택--"과 `Value` `-1`를 사용 하 여 새 목록 항목을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>

<span data-ttu-id="b0853-172">[a를 추가 ![--범주 선택--목록 항목](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="b0853-173">**그림 11**: a--범주 선택--목록 항목 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>

<span data-ttu-id="b0853-174">또는 다음 태그를 DropDownList에 추가 하 여 목록 항목을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>

[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="b0853-175">또한 범주를 ObjectDataSource에서 DropDownList에 바인딩할 때 `AppendDataBoundItems` True가 아니면 수동으로 추가 된 목록 항목을 덮어쓰도록 `AppendDataBoundItems` DropDownList 컨트롤의을 True로 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>

![AppendDataBoundItems 속성을 True로 설정 합니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="b0853-177">**그림 12**: `AppendDataBoundItems` 속성을 True로 설정</span><span class="sxs-lookup"><span data-stu-id="b0853-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>

<span data-ttu-id="b0853-178">이러한 변경 후 페이지를 처음 방문 하면 "--범주 선택--" 옵션이 선택 되 고 제품이 표시 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>

<span data-ttu-id="b0853-179">[초기 페이지 로드에 ![표시 되는 제품이 없습니다.](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="b0853-180">**그림 13**: 초기 페이지 로드에서 제품이 표시 되지 않음 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="b0853-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>

<span data-ttu-id="b0853-181">"--범주 선택--" 목록 항목을 선택 했기 때문에 제품이 표시 되지 않습니다. "목록 항목을 선택 했기 때문 `-1``CategoryID` `-1`입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="b0853-182">이 동작을 원하는 경우이 시점에서 작업을 수행 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="b0853-183">그러나 "--범주 선택--" 목록 항목을 선택할 때 *모든* 범주를 표시 하려는 경우 `ProductsBLL` 클래스로 돌아가서 전달 된 *`categoryID`* 매개 변수가 0 보다 작은 경우 `GetProducts()` 메서드를 호출 하도록 `GetProductsByCategoryID(categoryID)` 메서드를 사용자 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>

[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="b0853-184">여기서 사용 되는 기법은 모든 공급자를 [선언적 매개 변수](../basic-reporting/declarative-parameters-cs.md) 자습서에 다시 표시 하는 데 사용 하는 방법과 비슷합니다 .이 예에서는 `-1` 값을 사용 하 여 `Nothing`와는 반대로 모든 레코드를 검색 해야 함을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="b0853-185">이는 `GetProductsByCategoryID(categoryID)` 메서드의 *`categoryID`* 매개 변수에 정수 값이 전달 될 것으로 예상 하는 반면 선언적 매개 변수 자습서에서는 문자열 입력 매개 변수를 전달 하기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="b0853-186">그림 14에서는 "--범주 선택--" 옵션이 선택 되어 있는 `FilterByDropDownList.aspx`의 스크린샷을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="b0853-187">여기서는 모든 제품이 기본적으로 표시 되며, 사용자는 특정 범주를 선택 하 여 표시 범위를 좁힐 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>

<span data-ttu-id="b0853-188">[이제 모든 제품이 기본적으로 나열 ![](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="b0853-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="b0853-189">**그림 14**: 이제 모든 제품이 기본적으로 나열 됩니다 ([전체 크기 이미지를 보려면 클릭](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png)).</span><span class="sxs-lookup"><span data-stu-id="b0853-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>

## <a name="summary"></a><span data-ttu-id="b0853-190">요약</span><span class="sxs-lookup"><span data-stu-id="b0853-190">Summary</span></span>

<span data-ttu-id="b0853-191">계층적으로 관련 된 데이터를 표시 하는 경우 사용자가 계층의 맨 위에서 데이터를 확인 하 고 세부 정보로 드릴 다운할 수 있는 마스터/세부 정보 보고서를 사용 하 여 데이터를 표시 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="b0853-192">이 자습서에서는 선택한 범주의 제품을 보여 주는 간단한 마스터/세부 정보 보고서 작성을 검토 했습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="b0853-193">이는 범주 목록에 대해 DropDownList을 사용 하 고 선택한 범주에 속한 제품에 대해 GridView를 사용 하 여 수행 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="b0853-194">[다음 자습서](master-detail-filtering-with-two-dropdownlists-vb.md) 에서는 두 개의 dropdownlist를 사용 하 여 DropDownList 인터페이스를 한 단계 더 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="b0853-195">행복 한 프로그래밍</span><span class="sxs-lookup"><span data-stu-id="b0853-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b0853-196">저자 정보</span><span class="sxs-lookup"><span data-stu-id="b0853-196">About the Author</span></span>

<span data-ttu-id="b0853-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(7 개의 ASP/ASP. NET books 및 [4GuysFromRolla.com](http://www.4guysfromrolla.com)창립자)은 1998부터 Microsoft 웹 기술을 사용 하 여 작업 했습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b0853-198">Scott은 독립 컨설턴트, 강사 및 기록기로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b0853-199">최신 책은 [*24 시간 이내에 ASP.NET 2.0을 sams teach yourself*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)것입니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b0853-200">mitchell@4GuysFromRolla.com에 도달할 수 있습니다 [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b0853-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b0853-201">또는 블로그를 통해 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)에서 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b0853-201">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="b0853-202">[이전](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
> [다음](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="b0853-202">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>

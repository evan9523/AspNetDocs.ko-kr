---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
title: 삽입, 업데이트 및 삭제 (VB) SqlDataSource 사용 하 여 데이터 | Microsoft Docs
author: rick-anderson
description: 이전 자습서에서 삽입, 업데이트 및 데이터 삭제에 대 한 ObjectDataSource 컨트롤을 허용 하는 방법을 알게 되었습니다. SqlDataSource 컨트롤 지원 t...
ms.author: riande
ms.date: 02/20/2007
ms.assetid: 9673bef3-892c-45ba-a7d8-0da3d6f48ec5
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: a52f5db8dbda2ec8f556d2627271f53ffbcc3045
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/06/2019
ms.locfileid: "65115074"
---
# <a name="inserting-updating-and-deleting-data-with-the-sqldatasource-vb"></a><span data-ttu-id="c762c-104">SqlDataSource를 사용하여 데이터 삽입, 업데이트 및 삭제(VB)</span><span class="sxs-lookup"><span data-stu-id="c762c-104">Inserting, Updating, and Deleting Data with the SqlDataSource (VB)</span></span>

<span data-ttu-id="c762c-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c762c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c762c-106">[샘플 앱을 다운로드](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) 또는 [PDF 다운로드](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c762c-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span></span>

> <span data-ttu-id="c762c-107">이전 자습서에서 삽입, 업데이트 및 데이터 삭제에 대 한 ObjectDataSource 컨트롤을 허용 하는 방법을 알게 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="c762c-108">SqlDataSource 컨트롤 같은 연산을 지원 하지만 방법은 다른 및이 자습서에서는 삽입, 업데이트 및 데이터를 삭제 하려면 SqlDataSource를 구성 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>

## <a name="introduction"></a><span data-ttu-id="c762c-109">소개</span><span class="sxs-lookup"><span data-stu-id="c762c-109">Introduction</span></span>

<span data-ttu-id="c762c-110">에 설명 된 대로 [An 개요의 삽입, 업데이트 및 삭제](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)GridView 컨트롤 기본 제공 업데이트를 제공 하며 함께 삽입 FormView 및 DetailsView 컨트롤을 포함 하는 동안 삭제 기능을 지원 합니다. 편집 및 삭제 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="c762c-111">이러한 데이터 수정 기능 쓸 필요 없이 코드 줄을 하지 않고 데이터 소스 컨트롤에 직접 연결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="c762c-112">[개요의 삽입, 업데이트 및 삭제](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) ObjectDataSource를 사용 하 여 삽입, 업데이트 및 GridView, DetailsView 및 FormView 컨트롤을 사용 하 여 삭제를 용이 하 게 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="c762c-113">또는, SqlDataSource ObjectDataSource 대신 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="c762c-114">삽입, 업데이트 및 ObjectDataSource에서는 필요한 삽입을 수행 하기 위해 호출 하 여 개체 계층 메서드를 지정 하려면 업데이트 또는 삭제 작업을 사용 하 여 삭제를 지원 하려면을 기억 하십시오.</span><span class="sxs-lookup"><span data-stu-id="c762c-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="c762c-115">SqlDataSource를 사용 하 여 제공 해야 `INSERT`, `UPDATE`, 및 `DELETE` SQL 문 또는 저장된 프로시저 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="c762c-116">이 자습서에서 살펴보겠지만 이러한 문을 수동으로 만들 수 있습니다 또는 SqlDataSource의 데이터 소스 구성 마법사에서 자동으로 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-117">이후로 ve 설명한 삽입, 편집 및 삭제 DetailsView GridView의 기능 및 FormView 컨트롤,이 자습서는 이러한 작업을 지 원하는 SqlDataSource 컨트롤 구성 중점을 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="c762c-118">사용 방법을 복습 GridView, DetailsView 및 FormView 돌아갑니다 편집, 삽입, 및 데이터 삭제 자습서에서 이러한 기능을 구현 해야 할 경우부터 [An 개요의 삽입, 업데이트 및 삭제](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span></span>

## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="c762c-119">1단계: 지정`INSERT`,`UPDATE`, 및`DELETE`문</span><span class="sxs-lookup"><span data-stu-id="c762c-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="c762c-120">대로 ve 해야 SqlDataSource 컨트롤에서 데이터를 검색할 지난 두 자습서 에서처럼 두 속성을 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="c762c-121">`ConnectionString`무엇을 하는 쿼리를 보내는 데이터베이스를 지정 하 고</span><span class="sxs-lookup"><span data-stu-id="c762c-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="c762c-122">`SelectCommand`를 임시 SQL 문 또는 저장된 프로시저 결과를 반환할 실행 이름을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="c762c-123">에 대 한 `SelectCommand` 매개 변수를 사용 하 여 값, 값 SqlDataSource s를 통해 지정 된 매개 변수 `SelectParameters` 컬렉션 하드 코드 된 값을 일반 매개 변수 원본 값을 포함할 수 있습니다 (쿼리 문자열 필드에 세션 변수를 웹 컨트롤 값 및 등등)에서 또는 프로그래밍 방식으로 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="c762c-124">SqlDataSource s를 제어 하는 경우 `Select()` 메서드 프로그래밍 방식으로 또는 자동으로 데이터 웹 컨트롤에서에서 데이터베이스에 연결 되어, 매개 변수 값 쿼리에 할당 되 고 명령에 해제 shuttled 되는 데이터베이스입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="c762c-125">S 컨트롤의 값에 따라 데이터 집합 또는 DataReader 결과 다음 반환 `DataSourceMode` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="c762c-126">데이터 선택, 함께 SqlDataSource 컨트롤 수를 삽입, 업데이트 및 제공 하 여 데이터를 삭제 `INSERT`, `UPDATE`, 및 `DELETE` 비슷하게에서 SQL 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="c762c-127">할당 하기만 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 속성을 `INSERT`를 `UPDATE`, 및 `DELETE` SQL 문을 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="c762c-128">(로 항상 가장) 문을 매개 변수를 사용할 경우에 포함할 합니다 `InsertParameters`, `UpdateParameters`, 및 `DeleteParameters` 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="c762c-129">한 번을 `InsertCommand`, `UpdateCommand`, 또는 `DeleteCommand` 값 지정 된 경우, 해당 데이터 웹 컨트롤 s 스마트 태그의에서 삽입을 사용 하도록 설정, 사용 하도록 설정 편집 또는 삭제 사용 옵션을 사용할 수 있게 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="c762c-130">Let s이 예의 예제를 수행 합니다 `Querying.aspx` 에서 만든 페이지를 [SqlDataSource 컨트롤을 사용 하 여 데이터 쿼리](querying-data-with-the-sqldatasource-control-vb.md) 자습서를 포함 하도록 삭제 기능 보강 하 여 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="c762c-131">열어서 시작 합니다 `InsertUpdateDelete.aspx` 하 고 `Querying.aspx` 에서 페이지를 `SqlDataSource` 폴더.</span><span class="sxs-lookup"><span data-stu-id="c762c-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="c762c-132">디자이너에서 합니다 `Querying.aspx` 페이지에서 첫 번째 예제에서 SqlDataSource 및 GridView를 선택 (합니다 `ProductsDataSource` 및 `GridView1` 컨트롤).</span><span class="sxs-lookup"><span data-stu-id="c762c-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="c762c-133">두 컨트롤을 선택한 후 편집 메뉴 및 복사를 선택 (또는 Ctrl + C를 누르면 방금).</span><span class="sxs-lookup"><span data-stu-id="c762c-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="c762c-134">디자이너를 이동한 다음 `InsertUpdateDelete.aspx` 컨트롤에 붙여넣습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="c762c-135">두 개의 이동한 후 `InsertUpdateDelete.aspx`, 브라우저에서 페이지를 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="c762c-136">값을 표시 합니다 `ProductID`, `ProductName`, 및 `UnitPrice` 열에 있는 레코드의 모든를 `Products` 데이터베이스 테이블.</span><span class="sxs-lookup"><span data-stu-id="c762c-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>

<span data-ttu-id="c762c-137">[![모든 제품이 나열 된 ProductID에 따라 정렬](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="c762c-138">**그림 1**: 모든 제품이 나열 된 정렬할 `ProductID` ([큰 이미지를 보려면 클릭](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span></span>

## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="c762c-139">SqlDataSource s 추가`DeleteCommand`고`DeleteParameters`속성</span><span class="sxs-lookup"><span data-stu-id="c762c-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="c762c-140">SqlDataSource에서 레코드를 모두 반환 하는 것이 시점에서 `Products` 테이블 및이 데이터를 렌더링 하는 GridView입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="c762c-141">목표는 GridView 통해 제품을 삭제할 수 있도록이 예제를 확장 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="c762c-142">SqlDataSource 컨트롤 s에 대 한 값을 지정 해야이 위해 `DeleteCommand` 및 `DeleteParameters` 속성 한 다음 삭제를 지원 하려면 GridView를 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="c762c-143">합니다 `DeleteCommand` 및 `DeleteParameters` 속성 다양 한 방법으로 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="c762c-144">선언적 구문을 통해</span><span class="sxs-lookup"><span data-stu-id="c762c-144">Through the declarative syntax</span></span>
- <span data-ttu-id="c762c-145">디자이너에서 속성 창에서</span><span class="sxs-lookup"><span data-stu-id="c762c-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="c762c-146">지정 된 SQL 문이나 저장된 프로시저를 사용자 지정 화면에서 데이터 소스 구성 마법사</span><span class="sxs-lookup"><span data-stu-id="c762c-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="c762c-147">보기 화면에서 데이터 소스 구성 마법사의 테이블에서 열 지정에서에서 고급 단추를 통해는 실제로 자동으로 생성 됩니다는 `DELETE` 에서 사용 되는 SQL 문 및 매개 변수 컬렉션을 `DeleteCommand` 및 `DeleteParameters` 속성</span><span class="sxs-lookup"><span data-stu-id="c762c-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="c762c-148">자동으로 포함 하는 방법을 살펴보겠습니다는 `DELETE` 2 단계에서에서 만든 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="c762c-149">이제 데이터 소스 구성 마법사 또는 선언적 구문 옵션 작동할 것도 가능 하지만 디자이너에서 속성 창을 사용 하 여 s 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="c762c-150">디자이너에서 `InsertUpdateDelete.aspx`를 클릭 합니다 `ProductsDataSource` SqlDataSource 및 속성 창을 표시 한 다음 (보기 메뉴에서 속성 창을 선택 하거나 f4 키를 누르면 됩니다).</span><span class="sxs-lookup"><span data-stu-id="c762c-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="c762c-151">줄임표의 집합을 가져오는 DeleteQuery 속성을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>

![속성 창에서 DeleteQuery 속성을 선택 합니다.](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.gif)

<span data-ttu-id="c762c-153">**그림 2**: 속성 창에서 DeleteQuery 속성을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-154">SqlDataSource 만들어지고 t DeleteQuery 속성을 가집니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="c762c-155">아니라 DeleteQuery 결합 한 것을 `DeleteCommand` 및 `DeleteParameters` 속성 및 디자이너를 통해 창을 표시 하는 경우 속성 창에 나열만 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="c762c-156">소스 뷰에서 속성 창에서 찾으려는 경우 있습니다를 `DeleteCommand` 속성 대신 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>

<span data-ttu-id="c762c-157">명령 및 매개 변수 편집기 대화 상자를 표시 DeleteQuery 속성에서 줄임표 상자 (그림 3 참조)를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="c762c-158">이 대화 상자에서 지정할 수 있습니다는 `DELETE` SQL 문의 매개 변수를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="c762c-159">다음 쿼리를 입력 합니다 `DELETE` 명령 텍스트 상자에 붙여넣습니다 (하거나 수동으로 또는 원하는 경우 쿼리 작성기를 사용 하 여):</span><span class="sxs-lookup"><span data-stu-id="c762c-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="c762c-160">다음으로, 추가할 매개 변수 새로 고침 단추를 클릭 합니다 `@ProductID` 아래 매개 변수 목록에 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>

<span data-ttu-id="c762c-161">[![속성 창에서 DeleteQuery 속성을 선택 합니다.](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="c762c-162">**그림 3**: 속성 창에서 DeleteQuery 속성 선택 ([클릭 하 여 큰 이미지 보기](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="c762c-163">수행할 *되지* 이 매개 변수 (의 매개 변수는 원본 위치 없음 상태로 유지 함)에 대 한 값을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="c762c-164">GridView에 삭제 지원을 추가 하기 면 GridView는 자동으로 적용이 매개 변수 값의 값을 사용 하 여 해당 `DataKeys` 있는 삭제 단추를 클릭 한 행에 대 한 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-165">사용 되는 매개 변수 이름 합니다 `DELETE` 쿼리 *해야 합니다* 의 이름이 같을 수는 `DataKeyNames` GridView, DetailsView 또는 FormView 값.</span><span class="sxs-lookup"><span data-stu-id="c762c-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="c762c-166">즉, 매개 변수를 `DELETE` 문을 의도적으로 이름이 `@ProductID` (대신 예를 들어, `@ID`) 이므로 Products 테이블 (및 따라서 GridView DataKeyNames 값)의 기본 키 열 이름이 `ProductID`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>

<span data-ttu-id="c762c-167">경우 매개 변수 이름 및 `DataKeyNames` 값 만들어지고 t 일치 하는 GridView 할당할 수 없습니다 자동으로 매개 변수에서 값을 `DataKeys` 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="c762c-168">명령 및 매개 변수 편집기 대화 상자에는 삭제 관련 정보를 입력 한 후 확인을 클릭 하 고 결과 선언적 태그를 검사 하 여 원본 뷰로 이동:</span><span class="sxs-lookup"><span data-stu-id="c762c-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="c762c-169">추가 된 `DeleteCommand` 속성 뿐만 `<DeleteParameters>` 섹션과 명명 된 매개 변수 개체 `productID`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="c762c-170">삭제 하기 위한 GridView 구성</span><span class="sxs-lookup"><span data-stu-id="c762c-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="c762c-171">사용 하 여는 `DeleteCommand` 속성이 추가 GridView가 스마트 태그는 이제 삭제 사용 옵션을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="c762c-172">계속 해 서이 확인란을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="c762c-173">에 설명 된 대로 [는 개요의 삽입, 업데이트 및 삭제](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)를 사용 하 여 CommandField 추가할 GridView이로 인해 해당 `ShowDeleteButton` 속성이로 설정 `True`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `True`.</span></span> <span data-ttu-id="c762c-174">그림 4에서는, 브라우저를 통해 해당 페이지를 방문 하는 경우 처럼 삭제 단추가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="c762c-175">일부 제품을 삭제 하 여이 페이지 출력을 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-175">Test this page out by deleting some products.</span></span>

<span data-ttu-id="c762c-176">[![각 GridView 행에는 이제 삭제 단추](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="c762c-177">**그림 4**: 각 GridView 행에는 이제 삭제 단추가 포함 됩니다 ([클릭 하 여 큰 이미지 보기](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span></span>

<span data-ttu-id="c762c-178">삭제 단추를 클릭 하면 포스트백이 발생할 GridView 할당 합니다 `ProductID` 매개 변수 값의 합니다 `DataKeys` 해당 삭제 단추 클릭 되었는지 및 SqlDataSource s 호출 행의 컬렉션 값 `Delete()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="c762c-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="c762c-179">SqlDataSource 컨트롤에서 그런 다음 데이터베이스에 연결 하 고 실행 된 `DELETE` 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="c762c-180">GridView는 SqlDataSource를 다시 시작 하 고 (포함 하는 더 이상만 삭제 된 레코드) 제품의 현재 집합을 표시 하려면 다음 다시 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-181">GridView를 사용 하므로 해당 `DataKeys` SqlDataSource 매개 변수를 채울 컬렉션입니다이 중요 한 s는 GridView s `DataKeyNames` 하 고 기본 키를 구성 하는 열에 속성을 설정할 수 SqlDataSource의 `SelectCommand` 반환 이러한 열입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="c762c-182">또한 해당가 SqlDataSource에서 매개 변수 이름을 지정 하는 중요 `DeleteCommand` 로 설정 된 `@ProductID`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="c762c-183">경우는 `DataKeyNames` 속성이 설정 되어 있지 않거나 매개 변수 이름이 지정 되지 않은 `@ProductsID`, 포스트백을 발생 하지만 실제로 모든 레코드를 삭제 하지 않습니다 삭제 단추를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won't actually delete any record.</span></span>

<span data-ttu-id="c762c-184">그림 5이 상호이 작용을 그래픽으로 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="c762c-185">다시 참조를 [삽입, 업데이트 및 삭제와 관련 된 이벤트 검사](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) 삽입, 업데이트 및 데이터 웹 컨트롤에서에서 삭제와 관련 된 이벤트 체인에 더 자세히 알아보려면 자습서입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>

![SqlDataSource s delete () 메서드를 호출 하는 GridView에서 삭제 단추를 클릭](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.gif)

<span data-ttu-id="c762c-187">**그림 5**: SqlDataSource s를 호출 하는 GridView에서 삭제 단추를 클릭 `Delete()` 메서드</span><span class="sxs-lookup"><span data-stu-id="c762c-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>

## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="c762c-188">2단계: 자동으로 생성 합니다`INSERT`,`UPDATE`, 및`DELETE`문</span><span class="sxs-lookup"><span data-stu-id="c762c-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="c762c-189">검사 1 단계와 `INSERT`, `UPDATE`, 및 `DELETE` 속성 창이 나 컨트롤 s 선언적 구문을 통해 SQL 문을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="c762c-190">그러나이 접근 방식에서는 수동으로 작성 SQL 문을 직접 단조로운 하 고 오류가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="c762c-191">데이터 소스 구성 마법사가 하는 옵션을 제공 하는 다행 스럽게도 합니다 `INSERT`, `UPDATE`, 및 `DELETE` 보기 화면의 테이블에서 열 지정을 사용 하는 경우 자동으로 생성 하는 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="c762c-192">가이 자동 생성 옵션을 탐색할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="c762c-193">디자이너는 DetailsView 추가할 `InsertUpdateDelete.aspx` 설정 및 해당 `ID` 속성을 `ManageProducts`입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="c762c-194">그런 다음 DetailsView가 스마트 태그에서 라는 SqlDataSource를 만들고 새 데이터 원본을 만들려면 선택 `ManageProductsDataSource`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>

<span data-ttu-id="c762c-195">[![ManageProductsDataSource 라는 새 SqlDataSource 만들기](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="c762c-196">**그림 6**: 명명 된 새 SqlDataSource 만들려면 `ManageProductsDataSource` ([큰 이미지를 보려면 클릭](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="c762c-197">데이터 소스 구성 마법사에서 사용 하도록 선택 된 `NORTHWINDConnectionString` 연결 문자열 하 고 다음을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="c762c-198">Select 문 화면 구성에서 선택한 테이블 또는 뷰 라디오 단추에서 지정 열을 그대로 두고 및 선택은 `Products` 드롭 다운 목록에서 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="c762c-199">선택 된 `ProductID`, `ProductName`를 `UnitPrice`, 및 `Discontinued` 확인란 목록에서 열.</span><span class="sxs-lookup"><span data-stu-id="c762c-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>

<span data-ttu-id="c762c-200">[![ProductID, ProductName, UnitPrice, 및 지원 되지 않는 열을 반환할 Products 테이블 사용](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="c762c-201">**그림 7**: 사용 하 여는 `Products` 테이블을 반환 합니다 `ProductID`를 `ProductName`, `UnitPrice`, 및 `Discontinued` 열 ([전체 크기 이미지를 보려면 클릭](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="c762c-202">자동으로 생성 `INSERT`, `UPDATE`, 및 `DELETE` 선택한 테이블 및 열을 기반으로 하는 문을 고급 단추를 클릭 하 고 생성을 확인 `INSERT`를 `UPDATE`, 및 `DELETE` 문 확인란을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>

![확인란 삽입 생성, 업데이트 및 삭제 문을 확인 합니다.](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.gif)

<span data-ttu-id="c762c-204">**그림 8**: 생성을 확인 `INSERT`, `UPDATE`, 및 `DELETE` 문을 확인란</span><span class="sxs-lookup"><span data-stu-id="c762c-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>

<span data-ttu-id="c762c-205">생성 `INSERT`, `UPDATE`, 및 `DELETE` 문을 확인란 수 들면 선택한 테이블에 기본 키 및 기본 키 열 (또는 열)은 반환 된 열 목록에 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="c762c-206">사용 하 여 낙관적 동시성 확인란을 선택할 수 있게 하는 한 번 생성 `INSERT`, `UPDATE`, 및 `DELETE` 문을 확인란이 선택 되어 보강 됩니다 합니다 `WHERE` 결과 절 `UPDATE` 및 `DELETE` 낙관적 동시성 제어를 제공 하는 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="c762c-207">이제 둡니다이 확인란을 선택 취소 합니다. 다음 자습서에서 SqlDataSource 컨트롤을 사용 하 여 낙관적 동시성을 검사 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="c762c-208">생성을 확인 한 후 `INSERT`, `UPDATE`, 및 `DELETE` 문 확인란을 Select 문 구성 화면으로 돌아간 후 다음을 클릭 확인 클릭 하 고 완료 한 후 데이터 소스 구성 마법사를 완료 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="c762c-209">마법사를 완료 하면 Visual Studio 추가할 BoundFields에 대 한 DetailsView 합니다 `ProductID`, `ProductName`, 및 `UnitPrice` 열과에 대 한 CheckBoxField는 `Discontinued` 열입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="c762c-210">이 페이지를 방문 하는 사용자는 제품을 단계별로 실행할 수 있도록 DetailsView가 스마트 태그에서 페이징 사용 옵션을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="c762c-211">또한 DetailsView s 지울 `Width` 고 `Height` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="c762c-212">스마트 태그에 삽입을 사용 하도록 설정, 사용 하도록 설정 편집 및 삭제 사용 옵션을 사용할 수 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="c762c-213">SqlDataSource에 대 한 값을 포함 하기 때문에이 해당 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand`처럼 선언적 구문을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="c762c-214">SqlDataSource 컨트롤에 자동으로 설정 된 값을 가진 하는 방법을 참고 해당 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="c762c-215">참조 된 열 집합이 `InsertCommand` 하 고 `UpdateCommand` 속성에 기반한는 `SELECT` 문.</span><span class="sxs-lookup"><span data-stu-id="c762c-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="c762c-216">즉, 대신 *모든* 제품 열에는 `InsertCommand` 및 `UpdateCommand`에 지정 된 열만을 가지는 `SelectCommand` (적은 `ProductID`, 때문에 생략 되는 것 s는 [ `IDENTITY` 열](http://www.sqlteam.com/item.asp?ItemID=102), 편집 하는 경우 해당 값을 변경할 수 없습니다 및 삽입 하는 경우를 자동으로 할당 되는).</span><span class="sxs-lookup"><span data-stu-id="c762c-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="c762c-217">또한 각 매개 변수에 대해를 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 에서 해당 매개 변수는 속성을 `InsertParameters`, `UpdateParameters`, 및 `DeleteParameters` 컬렉션.</span><span class="sxs-lookup"><span data-stu-id="c762c-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="c762c-218">DetailsView의 데이터 수정 기능을 켜려면 삽입 사용, 편집 사용 및 삭제 사용 옵션에서 스마트 태그를 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="c762c-219">이 추가 사용 하 여 CommandField 해당 `ShowInsertButton`, `ShowEditButton`, 및 `ShowDeleteButton` 속성으로 설정 `True`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `True`.</span></span>

<span data-ttu-id="c762c-220">브라우저에서 페이지를 방문 하 고 편집, 삭제 및 DetailsView에 포함 된 새 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="c762c-221">DetailsView 각 BoundField 표시 하는 편집 모드로 설정 편집 단추를 클릭 하면 해당 `ReadOnly` 속성이 `False` (기본값) 텍스트 상자 및 확인란으로 CheckBoxField.</span><span class="sxs-lookup"><span data-stu-id="c762c-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `False` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>

<span data-ttu-id="c762c-222">[![DetailsView s 기본 편집 인터페이스](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="c762c-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="c762c-223">**그림 9**: DetailsView s 기본 편집 인터페이스 ([클릭 하 여 큰 이미지 보기](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="c762c-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span></span>

<span data-ttu-id="c762c-224">마찬가지로, 현재 선택 된 제품 삭제 수도 있고 시스템에 새 제품을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="c762c-225">때문를 `InsertCommand` 문을 에서만 작동 합니다 `ProductName`, `UnitPrice`, 및 `Discontinued` 열을 다른 열에도 하거나 `NULL` 또는 기본값으로 삽입 시 데이터베이스에서 할당.</span><span class="sxs-lookup"><span data-stu-id="c762c-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="c762c-226">와 마찬가지로 ObjectDataSource가 하는 경우는 `InsertCommand` 데이터베이스 테이블 t 있는 열 수 없습니다 `NULL` s 및 안 기본값이, SQL 오류가 발생 실행 하려고 할 때를 `INSERT` 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-227">DetailsView s 삽입 하 고 편집 인터페이스 사용자 지정 또는 유효성 검사의 부족 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="c762c-228">유효성 검사 컨트롤을 추가 하거나 인터페이스를 사용자 지정 하는 BoundFields TemplateFields 변환 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="c762c-229">참조를 [편집 및 삽입 인터페이스에 유효성 검사 컨트롤 추가](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) 하 고 [데이터 수정 인터페이스 사용자 지정](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) 자세한 자습서입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorials for more information.</span></span>

<span data-ttu-id="c762c-230">또한 염두에 업데이트 및 삭제, DetailsView는 현재 제품 s `DataKey` 만 값을 `DataKeyNames` 속성이 구성 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="c762c-231">아무 효과도 없는 나타나면 편집 하거나 삭제 했는지를 `DataKeyNames` 속성을 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="c762c-232">SQL 문을 자동으로 생성 하는 제한 사항</span><span class="sxs-lookup"><span data-stu-id="c762c-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="c762c-233">생성 이후에 `INSERT`, `UPDATE`, 및 `DELETE` 직접 작성 해야 하는 복잡 한 쿼리에 대 한 테이블에서 열을 선택 하는 경우에 문 옵션을 사용할 수만 `INSERT`를 `UPDATE`, 및 `DELETE` 1 단계에서에서 수행한 것과 같이 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="c762c-234">일반적으로 SQL `SELECT` 문을 사용 하 여 `JOIN` 표시에 하나 이상의 조회 테이블에서 데이터 다시 가져오기를 (다시 수행한 합니다 `Categories` s 테이블 `CategoryName` 제품 정보를 표시할 때 필드).</span><span class="sxs-lookup"><span data-stu-id="c762c-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="c762c-235">동시에, 하고자 할 수 있습니다 사용자 편집, 업데이트 또는 core 테이블로 데이터를 삽입 하도록 허용 (`Products`,이 경우).</span><span class="sxs-lookup"><span data-stu-id="c762c-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="c762c-236">동안 합니다 `INSERT`, `UPDATE`, 및 `DELETE` 문을 수동으로 입력할 수 있습니다,이 시간을 절약 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="c762c-237">처음에 데이터를 방금 다시 가져오는 있도록 SqlDataSource를 설정 합니다 `Products` 테이블입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="c762c-238">자동으로 생성할 수 있도록 테이블 또는 뷰 화면에서 데이터 소스 구성 마법사가의 지정 열을 사용 합니다 `INSERT`, `UPDATE`, 및 `DELETE` 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="c762c-239">그런 다음 마법사를 완료 한 후 속성 창에서 SelectQuery 구성 하도록 선택 (하거나, 또는 돌아가서 데이터 소스 구성 마법사를 사용 하 여 지정 된 사용자 지정 SQL 문 또는 저장된 프로시저 옵션).</span><span class="sxs-lookup"><span data-stu-id="c762c-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="c762c-240">그런 다음 업데이트를 `SELECT` 포함 하도록 문을 `JOIN` 구문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="c762c-241">이 기술은 자동으로 생성 된 SQL 문이 시간 절약 혜택을 제공 하 고 더 사용자 지정 허용 `SELECT` 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="c762c-242">자동으로 생성 하는 또 다른 제한은 `INSERT`, `UPDATE`, 및 `DELETE` 문을 열에는 `INSERT` 및 `UPDATE` 문을 기반으로 하 여 반환 되는 열을 `SELECT` 문.</span><span class="sxs-lookup"><span data-stu-id="c762c-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="c762c-243">그러나 더 많거나 적은 필드를 삽입 하거나 업데이트할 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="c762c-244">예를 들어, 2 단계에서에서 예제에서는 아마도 하고자 합니다 `UnitPrice` BoundField 읽기 전용으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="c762c-245">이 경우에 표시 하지 않아야 합니다 `UpdateCommand`합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-245">In that case, it shouldn't appear in the `UpdateCommand`.</span></span> <span data-ttu-id="c762c-246">또는 GridView에서 표시 되지 않는 테이블 필드의 값을 설정 하는 것이 좋겠습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="c762c-247">예를 들어, 새 추가 하는 경우 레코드 좋겠습니다는 `QuantityPerUnit` 값 TODO로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="c762c-248">이러한 사용자 지정이 필요한 경우 속성 창, 사용자 지정 SQL 문 지정 또는 마법사에서 또는 선언적 구문을 통해 저장된 프로시저 옵션을 통해 이러한 수동으로 수행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="c762c-249">데이터의 해당 필드가 없는 매개 변수 추가 웹 컨트롤 때 이러한 매개 변수 값은 몇 가지 방식으로 값을 할당할 수 해야 하는 염두에 둡니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="c762c-250">이러한 값은: 하드 코드에서 직접 합니다 `InsertCommand` 또는 `UpdateCommand`; (쿼리 문자열, 세션 상태, 페이지 및 등의 웹 컨트롤); 일부 미리 정의 된 소스에서 가져올 수 있습니다 또는 이전 자습서에서 살펴본 대로 프로그래밍 방식으로 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="c762c-251">요약</span><span class="sxs-lookup"><span data-stu-id="c762c-251">Summary</span></span>

<span data-ttu-id="c762c-252">순서 대로 데이터에 대 한 자신의 기본 삽입, 편집 및 삭제 기능을 활용 하려면 웹 컨트롤에 바인딩되어 있는 데이터 소스 컨트롤 이러한 기능을 제공 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="c762c-253">SqlDataSource에 대 한 즉 `INSERT`, `UPDATE`, 및 `DELETE` SQL 문을에 할당 되어야 합니다는 `InsertCommand`, `UpdateCommand`, 및 `DeleteCommand` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="c762c-254">이러한 속성 및 해당 매개 변수 컬렉션 수동으로 추가 하거나 데이터 소스 구성 마법사를 통해 자동으로 생성 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="c762c-255">이 자습서에서는 두 가지 방법을 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="c762c-256">ObjectDataSource를 사용 하 여 낙관적 동시성을 사용 하 여 검사할 합니다 [낙관적 동시성 구현](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) 자습서입니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial.</span></span> <span data-ttu-id="c762c-257">SqlDataSource 컨트롤 낙관적 동시성 지원도 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="c762c-258">자동으로 생성 하는 경우 2 단계에서에서 설명한 것 처럼 합니다 `INSERT`, `UPDATE`, 및 `DELETE` 문, 마법사를 사용 하 여 낙관적 동시성 옵션을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="c762c-259">다음 자습서에서 살펴보겠지만 SqlDataSource를 사용 하 여 낙관적 동시성을 사용 하 여 수정 합니다 `WHERE` 절을 `UPDATE` 및 `DELETE` 문은 데이터를 마지막으로 하므로 다른 열에 대 한 값을 변경 하지 않은 확인 하기 위해 페이지에 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven't changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="c762c-260">즐거운 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="c762c-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c762c-261">저자 소개</span><span class="sxs-lookup"><span data-stu-id="c762c-261">About the Author</span></span>

<span data-ttu-id="c762c-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 7 ASP/ASP.NET 서적의 저자 이자 설립자입니다 [4GuysFromRolla.com](http://www.4guysfromrolla.com), 1998 Microsoft 웹 기술을 사용 하 여 왔습니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c762c-263">Scott는 독립 컨설턴트, 강사, 그리고 기록기로 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c762c-264">최근 저서는 [ *Sams 설명 직접 ASP.NET 2.0 24 시간 동안의*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c762c-265">그에 도달할 수 있습니다 [ mitchell@4GuysFromRolla.com합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c762c-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c762c-266">찾을 수 있는 저자의 블로그를 통해 또는 [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)합니다.</span><span class="sxs-lookup"><span data-stu-id="c762c-266">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c762c-267">[이전](using-parameterized-queries-with-the-sqldatasource-vb.md)
> [다음](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c762c-267">[Previous](using-parameterized-queries-with-the-sqldatasource-vb.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span></span>

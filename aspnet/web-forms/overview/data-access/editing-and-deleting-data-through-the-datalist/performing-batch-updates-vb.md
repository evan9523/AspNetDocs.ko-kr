---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
title: 일괄 처리 업데이트 수행 (VB) | Microsoft Docs
author: rick-anderson
description: 모든 항목이 편집 모드에 있고 해당 값을 저장할 수 있는 완전히 편집 가능한 DataList를 만드는 방법에 대 한 자세한 내용은 ...
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 8dac22a7-91de-4e3b-888f-a4c438b03851
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/performing-batch-updates-vb
msc.type: authoredcontent
ms.openlocfilehash: e54c9fc12da278492b54164cf657eea142a3dae6
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/28/2019
ms.locfileid: "74632579"
---
# <a name="performing-batch-updates-vb"></a><span data-ttu-id="dcbc6-103">일괄 처리 업데이트 수행(VB)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-103">Performing Batch Updates (VB)</span></span>

<span data-ttu-id="dcbc6-104">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="dcbc6-105">[샘플 앱 다운로드](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) 또는 [PDF 다운로드](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-105">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_37_VB.exe) or [Download PDF](performing-batch-updates-vb/_static/datatutorial37vb1.pdf)</span></span>

> <span data-ttu-id="dcbc6-106">모든 항목이 편집 모드에 있고 페이지의 "모두 업데이트" 단추를 클릭 하 여 값을 저장할 수 있는 완전히 편집 가능한 DataList를 만드는 방법에 대해 알아봅니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-106">Learn how to create a fully-editable DataList where all of its items are in edit mode and whose values can be saved by clicking an "Update All" button on the page.</span></span>

## <a name="introduction"></a><span data-ttu-id="dcbc6-107">소개</span><span class="sxs-lookup"><span data-stu-id="dcbc6-107">Introduction</span></span>

<span data-ttu-id="dcbc6-108">[이전 자습서](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) 에서는 항목 수준 DataList를 만드는 방법을 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-108">In the [preceding tutorial](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md) we examined how to create an item-level DataList.</span></span> <span data-ttu-id="dcbc6-109">표준 편집 가능한 GridView와 마찬가지로 DataList의 각 항목에는 클릭 하면 항목을 편집할 수 있도록 하는 편집 단추가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-109">Like the standard editable GridView, each item in the DataList included an Edit button that, when clicked, would make the item editable.</span></span> <span data-ttu-id="dcbc6-110">이러한 항목 수준 편집은 가끔씩만 업데이트 되는 데이터에 적합 하지만 특정 사용 사례 시나리오에서는 사용자가 많은 레코드를 편집 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-110">While this item-level editing works well for data that is only updated occasionally, certain use case scenarios require the user to edit many records.</span></span> <span data-ttu-id="dcbc6-111">사용자가 수십 개의 레코드를 편집 해야 하 고 편집을 클릭 하 고 편집을 클릭 한 다음 각 항목에 대해 업데이트를 클릭 하면 클릭의 양이 생산성을 저하 시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-111">If a user needs to edit dozens of records and is forced to click Edit, make their changes, and click Update for each one, the amount of clicking can hamper her productivity.</span></span> <span data-ttu-id="dcbc6-112">이러한 경우에는 완전히 편집 가능한 DataList를 제공 하는 것이 좋습니다 .이 경우 *모든* 항목이 편집 모드에 있고 페이지의 모두 업데이트 단추를 클릭 하 여 값을 편집할 수 있습니다 (그림 1 참조).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-112">In such situations, a better option is to provide a fully-editable DataList, one where *all* of its items are in edit mode and whose values can be edited by clicking an Update All button on the page (see Figure 1).</span></span>

<span data-ttu-id="dcbc6-113">[완전히 편집 가능한 DataList의 각 항목 ![수정할 수 있습니다.](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-113">[![Each Item in a Fully Editable DataList can be Modified](performing-batch-updates-vb/_static/image2.png)](performing-batch-updates-vb/_static/image1.png)</span></span>

<span data-ttu-id="dcbc6-114">**그림 1**: 완전히 편집 가능한 DataList의 각 항목을 수정할 수 있습니다 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image3.png)).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-114">**Figure 1**: Each Item in a Fully Editable DataList can be Modified ([Click to view full-size image](performing-batch-updates-vb/_static/image3.png))</span></span>

<span data-ttu-id="dcbc6-115">이 자습서에서는 사용자가 완전히 편집 가능한 DataList를 사용 하 여 공급자 주소 정보를 업데이트할 수 있도록 하는 방법을 살펴보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-115">In this tutorial we'll examine how to enable users to update suppliers address information using a fully editable DataList.</span></span>

## <a name="step-1-create-the-editable-user-interface-in-the-datalist-s-itemtemplate"></a><span data-ttu-id="dcbc6-116">1 단계: DataList s ItemTemplate에서 편집 가능한 사용자 인터페이스 만들기</span><span class="sxs-lookup"><span data-stu-id="dcbc6-116">Step 1: Create the Editable User Interface in the DataList s ItemTemplate</span></span>

<span data-ttu-id="dcbc6-117">이전 자습서에서 표준 항목 수준 편집 가능 DataList를 만드는 경우 다음 두 가지 템플릿을 사용 했습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-117">In the preceding tutorial, where we creating a standard, item-level editable DataList, we used two templates:</span></span>

- <span data-ttu-id="dcbc6-118">`ItemTemplate`에는 읽기 전용 사용자 인터페이스 (각 제품의 이름과 가격을 표시 하기 위한 레이블 웹 컨트롤)가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-118">`ItemTemplate` contained the read-only user interface (the Label Web controls for displaying each product s name and price).</span></span>
- <span data-ttu-id="dcbc6-119">`EditItemTemplate`에는 편집 모드 사용자 인터페이스 (두 TextBox 웹 컨트롤)가 포함 되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-119">`EditItemTemplate` contained the edit mode user interface (the two TextBox Web controls).</span></span>

<span data-ttu-id="dcbc6-120">DataList s `EditItemIndex` 속성은 `EditItemTemplate`을 사용 하 여 렌더링 되는 `DataListItem` (있는 경우)을 결정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-120">The DataList s `EditItemIndex` property dictates what `DataListItem` (if any) is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="dcbc6-121">특히 `ItemIndex` 값이 DataList s `EditItemIndex` 속성과 일치 하는 `DataListItem` `EditItemTemplate`를 사용 하 여 렌더링 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-121">In particular, the `DataListItem` whose `ItemIndex` value matches the DataList s `EditItemIndex` property is rendered using the `EditItemTemplate`.</span></span> <span data-ttu-id="dcbc6-122">이 모델은 한 번에 하나의 항목만 편집할 수 있지만 완전히 편집 가능한 DataList를 만드는 경우에는 잘 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-122">This model works well when only one item can be edited at a time, but falls apart when creating a fully-editable DataList.</span></span>

<span data-ttu-id="dcbc6-123">완전히 편집 가능한 DataList의 경우 편집 가능한 인터페이스를 사용 하 여 *모든* `DataListItem`를 렌더링 하려고 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-123">For a fully editable DataList, we want *all* of the `DataListItem` s to render using the editable interface.</span></span> <span data-ttu-id="dcbc6-124">이를 수행 하는 가장 간단한 방법은 `ItemTemplate`에서 편집 가능한 인터페이스를 정의 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-124">The simplest way to accomplish this is to define the editable interface in the `ItemTemplate`.</span></span> <span data-ttu-id="dcbc6-125">공급자 주소 정보를 수정 하기 위해 편집 가능한 인터페이스에는 공급자 이름이 텍스트로 포함 되 고 주소, 구/군/시 및 국가 값의 텍스트 상자가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-125">For modifying the suppliers address information, the editable interface contains the supplier name as text and then TextBoxes for the address, city, and country values.</span></span>

<span data-ttu-id="dcbc6-126">먼저 `BatchUpdate.aspx` 페이지를 열고 DataList 컨트롤을 추가 하 고 `ID` 속성을 `Suppliers`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-126">Start by opening the `BatchUpdate.aspx` page, add a DataList control, and set its `ID` property to `Suppliers`.</span></span> <span data-ttu-id="dcbc6-127">DataList s 스마트 태그에서 `SuppliersDataSource`라는 새 ObjectDataSource 컨트롤을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-127">From the DataList s smart tag, opt to add a new ObjectDataSource control named `SuppliersDataSource`.</span></span>

<span data-ttu-id="dcbc6-128">[SuppliersDataSource 라는 새 ObjectDataSource를 만들 ![](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-128">[![Create a New ObjectDataSource Named SuppliersDataSource](performing-batch-updates-vb/_static/image5.png)](performing-batch-updates-vb/_static/image4.png)</span></span>

<span data-ttu-id="dcbc6-129">**그림 2**: `SuppliersDataSource` 라는 새 ObjectDataSource 만들기 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="dcbc6-129">**Figure 2**: Create a New ObjectDataSource Named `SuppliersDataSource` ([Click to view full-size image](performing-batch-updates-vb/_static/image6.png))</span></span>

<span data-ttu-id="dcbc6-130">`SuppliersBLL` 클래스 s `GetSuppliers()` 메서드를 사용 하 여 데이터를 검색 하도록 ObjectDataSource를 구성 합니다 (그림 3 참조).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-130">Configure the ObjectDataSource to retrieve data using the `SuppliersBLL` class s `GetSuppliers()` method (see Figure 3).</span></span> <span data-ttu-id="dcbc6-131">위의 자습서와 같이 ObjectDataSource를 통해 공급자 정보를 업데이트 하는 대신, 비즈니스 논리 계층에서 직접 작업 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-131">As with the preceding tutorial, rather than updating the supplier information through the ObjectDataSource, we'll work directly with the Business Logic Layer.</span></span> <span data-ttu-id="dcbc6-132">따라서 업데이트 탭에서 드롭다운 목록을 (없음)으로 설정 합니다 (그림 4 참조).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-132">Therefore, set the drop-down list to (None) in the UPDATE tab (see Figure 4).</span></span>

<span data-ttu-id="dcbc6-133">[GetSuppliers () 메서드를 사용 하 여 공급자 정보를 검색 ![](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-133">[![Retrieve Supplier Information Using the GetSuppliers() Method](performing-batch-updates-vb/_static/image8.png)](performing-batch-updates-vb/_static/image7.png)</span></span>

<span data-ttu-id="dcbc6-134">**그림 3**: `GetSuppliers()` 메서드를 사용 하 여 공급자 정보 검색 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="dcbc6-134">**Figure 3**: Retrieve Supplier Information Using the `GetSuppliers()` Method ([Click to view full-size image](performing-batch-updates-vb/_static/image9.png))</span></span>

<span data-ttu-id="dcbc6-135">[업데이트 탭에서 드롭다운 목록을 (없음)으로 설정 ![](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-135">[![Set the Drop-Down List to (None) in the UPDATE Tab](performing-batch-updates-vb/_static/image11.png)](performing-batch-updates-vb/_static/image10.png)</span></span>

<span data-ttu-id="dcbc6-136">**그림 4**: 업데이트 탭에서 드롭다운 목록을 (없음)으로 설정 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="dcbc6-136">**Figure 4**: Set the Drop-Down List to (None) in the UPDATE Tab ([Click to view full-size image](performing-batch-updates-vb/_static/image12.png))</span></span>

<span data-ttu-id="dcbc6-137">마법사를 완료 한 후 Visual Studio에서 자동으로 DataList s `ItemTemplate` 생성 하 여 데이터 소스에서 반환 하는 각 데이터 필드를 레이블 웹 컨트롤에 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-137">After completing the wizard, Visual Studio automatically generates the DataList s `ItemTemplate` to display each data field returned by the data source in a Label Web control.</span></span> <span data-ttu-id="dcbc6-138">대신 편집 인터페이스를 제공 하도록이 템플릿을 수정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-138">We need to modify this template so that it provides the editing interface instead.</span></span> <span data-ttu-id="dcbc6-139">`ItemTemplate`는 DataList의 스마트 태그에서 템플릿 편집 옵션을 사용 하거나 선언적 구문을 통해 직접 디자이너를 통해 사용자 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-139">The `ItemTemplate` can be customized through the Designer using the Edit Templates option from the DataList s smart tag or directly through the declarative syntax.</span></span>

<span data-ttu-id="dcbc6-140">공급자의 이름을 텍스트로 표시 하는 편집 인터페이스를 만들고 공급자의 주소, 구/군/시 및 국가 값에 대 한 텍스트 상자를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-140">Take a moment to create an editing interface that displays the supplier s name as text, but includes TextBoxes for the supplier s address, city, and country values.</span></span> <span data-ttu-id="dcbc6-141">이러한 변경을 수행한 후에는 페이지의 선언 구문이 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-141">After making these changes, your page s declarative syntax should look similar to the following:</span></span>

[!code-aspx[Main](performing-batch-updates-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="dcbc6-142">위의 자습서와 마찬가지로이 자습서의 DataList는 해당 뷰 상태를 사용 하도록 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-142">As with the preceding tutorial, the DataList in this tutorial must have its view state enabled.</span></span>

<span data-ttu-id="dcbc6-143">`ItemTemplate` I m에서 `SupplierPropertyLabel` 및 `SupplierPropertyValue`두 개의 새 CSS 클래스를 사용 합니다 .이 클래스는 `Styles.css` 클래스에 추가 되 고 `ProductPropertyLabel` 및 `ProductPropertyValue` CSS 클래스와 동일한 스타일 설정을 사용 하도록 구성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-143">In the `ItemTemplate` I m using two new CSS classes, `SupplierPropertyLabel` and `SupplierPropertyValue`, which have been added to the `Styles.css` class and configured to use the same style settings as the `ProductPropertyLabel` and `ProductPropertyValue` CSS classes.</span></span>

[!code-css[Main](performing-batch-updates-vb/samples/sample2.css)]

<span data-ttu-id="dcbc6-144">이러한 변경을 수행한 후 브라우저를 통해이 페이지를 방문 하세요.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-144">After making these changes, visit this page through a browser.</span></span> <span data-ttu-id="dcbc6-145">그림 5에 표시 된 것 처럼 각 DataList 항목은 공급자 이름을 텍스트로 표시 하 고 텍스트 상자를 사용 하 여 주소, 도시 및 국가를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-145">As Figure 5 shows, each DataList item displays the supplier name as text and uses TextBoxes to display the address, city, and country.</span></span>

<span data-ttu-id="dcbc6-146">[DataList의 각 공급자 ![편집할 수 있습니다.](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-146">[![Each Supplier in the DataList is Editable](performing-batch-updates-vb/_static/image14.png)](performing-batch-updates-vb/_static/image13.png)</span></span>

<span data-ttu-id="dcbc6-147">**그림 5**: DataList의 각 공급자를 편집할 수 있습니다 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image15.png)).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-147">**Figure 5**: Each Supplier in the DataList is Editable ([Click to view full-size image](performing-batch-updates-vb/_static/image15.png))</span></span>

## <a name="step-2-adding-an-update-all-button"></a><span data-ttu-id="dcbc6-148">2 단계: 모두 업데이트 단추 추가</span><span class="sxs-lookup"><span data-stu-id="dcbc6-148">Step 2: Adding an Update All Button</span></span>

<span data-ttu-id="dcbc6-149">그림 5의 각 공급 업체에는 해당 주소, 도시 및 국가 필드가 텍스트 상자에 표시 되지만 현재는 사용 가능한 업데이트 단추가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-149">While each supplier in Figure 5 has its address, city, and country fields displayed in a TextBox, there currently is no Update button available.</span></span> <span data-ttu-id="dcbc6-150">완전히 편집 가능한 DataLists을 사용 하 여 항목당 업데이트 단추를 사용 하는 대신, 페이지에는 클릭 시 DataList의 *모든* 레코드를 업데이트 하는 단일 업데이트 모두 단추가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-150">Rather than having an Update button per item, with fully editable DataLists there is typically a single Update All button on the page that, when clicked, updates *all* of the records in the DataList.</span></span> <span data-ttu-id="dcbc6-151">이 자습서에서는 페이지 맨 위에 1 개의 업데이트를 모두 추가 하 고, 아래쪽에 하나를 추가 합니다. 단추를 클릭 해도 동일한 효과가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-151">For this tutorial, let s add two Update All buttons - one at the top of the page and one at the bottom (although clicking either button will have the same effect).</span></span>

<span data-ttu-id="dcbc6-152">먼저 DataList 위에 단추 웹 컨트롤을 추가 하 고 `ID` 속성을 `UpdateAll1`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-152">Start by adding a Button Web control above the DataList and set its `ID` property to `UpdateAll1`.</span></span> <span data-ttu-id="dcbc6-153">그런 다음 두 번째 Button 웹 컨트롤을 DataList 아래에 추가 하 고 해당 `ID`을 `UpdateAll2`로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-153">Next, add the second Button Web control beneath the DataList, setting its `ID` to `UpdateAll2`.</span></span> <span data-ttu-id="dcbc6-154">두 단추의 `Text` 속성을 모두 업데이트로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-154">Set the `Text` properties for the two Buttons to Update All.</span></span> <span data-ttu-id="dcbc6-155">마지막으로 두 단추 `Click` 이벤트에 대 한 이벤트 처리기를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-155">Lastly, create event handlers for both Buttons `Click` events.</span></span> <span data-ttu-id="dcbc6-156">각 이벤트 처리기에서 업데이트 논리를 복제 하는 대신,를 사용 하면 이벤트 처리기가이 세 번째 메서드를 호출 하는 `UpdateAllSupplierAddresses`세 번째 메서드로 해당 논리를 리팩터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-156">Rather than duplicating the update logic in each of the event handlers, let s refactor that logic to a third method, `UpdateAllSupplierAddresses`, having the event handlers simply invoking this third method.</span></span>

[!code-vb[Main](performing-batch-updates-vb/samples/sample3.vb)]

<span data-ttu-id="dcbc6-157">그림 6은 업데이트 모두 단추가 추가 된 후의 페이지를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-157">Figure 6 shows the page after the Update All buttons have been added.</span></span>

<span data-ttu-id="dcbc6-158">[![두 업데이트 모두 페이지에 추가 되었습니다.](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-158">[![Two Update All Buttons have been Added to the Page](performing-batch-updates-vb/_static/image17.png)](performing-batch-updates-vb/_static/image16.png)</span></span>

<span data-ttu-id="dcbc6-159">**그림 6**: 페이지에 두 개의 업데이트 모두 단추가 추가 되었습니다 ([전체 크기 이미지를 보려면 클릭](performing-batch-updates-vb/_static/image18.png)).</span><span class="sxs-lookup"><span data-stu-id="dcbc6-159">**Figure 6**: Two Update All Buttons have been Added to the Page ([Click to view full-size image](performing-batch-updates-vb/_static/image18.png))</span></span>

## <a name="step-3-updating-all-of-the-suppliers-address-information"></a><span data-ttu-id="dcbc6-160">3 단계: 모든 공급자 주소 정보 업데이트</span><span class="sxs-lookup"><span data-stu-id="dcbc6-160">Step 3: Updating All of the Suppliers Address Information</span></span>

<span data-ttu-id="dcbc6-161">모든 DataList 항목을 편집 인터페이스를 표시 하 고 모두 업데이트 단추를 추가 하 여, 일괄 업데이트를 수행 하는 코드를 작성 하는 것만 남았습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-161">With all of the DataList s items displaying the editing interface and with the addition of the Update All buttons, all that remains is writing the code to perform the batch update.</span></span> <span data-ttu-id="dcbc6-162">특히 DataList s 항목을 반복 하 고 각 항목에 대해 `SuppliersBLL` 클래스 `UpdateSupplierAddress` 메서드를 호출 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-162">Specifically, we need to loop through the DataList s items and call the `SuppliersBLL` class s `UpdateSupplierAddress` method for each one.</span></span>

<span data-ttu-id="dcbc6-163">Datalist를 구성을 하는 `DataListItem` 인스턴스의 컬렉션은 DataList s [`Items` 속성](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx)을 통해 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-163">The collection of `DataListItem` instances that makeup the DataList can be accessed via the DataList s [`Items` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datalist.items.aspx).</span></span> <span data-ttu-id="dcbc6-164">`DataListItem`에 대 한 참조를 사용 하 여 `DataKeys` 컬렉션에서 해당 `SupplierID`를 가져오고 다음 코드에서 보여 주는 것 처럼 `ItemTemplate` 내에서 TextBox 웹 컨트롤을 프로그래밍 방식으로 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-164">With a reference to a `DataListItem`, we can grab the corresponding `SupplierID` from the `DataKeys` collection and programmatically reference the TextBox Web controls within the `ItemTemplate` as the following code illustrates:</span></span>

[!code-vb[Main](performing-batch-updates-vb/samples/sample4.vb)]

<span data-ttu-id="dcbc6-165">사용자가 업데이트 모두 단추 중 하나를 클릭 하면 `UpdateAllSupplierAddresses` 메서드가 `Suppliers` DataList의 각 `DataListItem`를 반복 하 고 `SuppliersBLL` 클래스의 `UpdateSupplierAddress` 메서드를 호출 하 여 해당 값을 전달 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-165">When the user clicks one of the Update All buttons, the `UpdateAllSupplierAddresses` method iterates through each `DataListItem` in the `Suppliers` DataList and calls the `SuppliersBLL` class s `UpdateSupplierAddress` method, passing in the corresponding values.</span></span> <span data-ttu-id="dcbc6-166">주소, 구/군/시 또는 국가 패스에 대해 입력 하지 않은 값은 `UpdateSupplierAddress` (빈 문자열이 아님)에 `Nothing` 값 이므로 기본 레코드의 필드에 대 한 데이터베이스가 `NULL` 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-166">A non-entered value for address, city, or country passes is a value of `Nothing` to `UpdateSupplierAddress` (rather than a blank string), which results in a database `NULL` for the underlying record s fields.</span></span>

> [!NOTE]
> <span data-ttu-id="dcbc6-167">향상 된 기능으로, 일괄 업데이트를 수행한 후에 몇 가지 확인 메시지를 제공 하는 상태 레이블 웹 컨트롤을 페이지에 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-167">As an enhancement, you may want to add a status Label Web control to the page that provides some confirmation message after the batch update is performed.</span></span>

## <a name="updating-only-those-addresses-that-have-been-modified"></a><span data-ttu-id="dcbc6-168">수정 된 주소만 업데이트</span><span class="sxs-lookup"><span data-stu-id="dcbc6-168">Updating Only Those Addresses That Have Been Modified</span></span>

<span data-ttu-id="dcbc6-169">이 자습서에 사용 되는 batch 업데이트 알고리즘은 주소 정보가 변경 되었는지 여부에 관계 없이 DataList의 *모든* 공급자에 대 한 `UpdateSupplierAddress` 메서드를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-169">The batch update algorithm used for this tutorial calls the `UpdateSupplierAddress` method for *every* supplier in the DataList, regardless of whether their address information has been changed.</span></span> <span data-ttu-id="dcbc6-170">이러한 블라인드 업데이트는 일반적으로 성능 문제가 아니지만 데이터베이스 테이블에 대 한 변경 내용을 다시 감사 하는 경우 불필요 한 레코드가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-170">While such blind updates aren't usually a performance issue, they can lead to superfluous records if you re auditing changes to the database table.</span></span> <span data-ttu-id="dcbc6-171">예를 들어 트리거를 사용 하 여 모든 `UPDATE` s를 `Suppliers` 테이블에 기록 하는 경우 사용자가 모두 업데이트 단추를 클릭 하면 사용자가 변경 했는지 여부에 관계 없이 시스템의 각 공급자에 대해 새 감사 레코드가 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-171">For example, if you use triggers to record all `UPDATE` s to the `Suppliers` table to an auditing table, every time a user clicks the Update All button a new audit record will be created for each supplier in the system, regardless of whether the user made any changes.</span></span>

<span data-ttu-id="dcbc6-172">ADO.NET DataTable 및 DataAdapter 클래스는 수정, 삭제 및 새 레코드만이 모든 데이터베이스 통신을 발생 하는 일괄 업데이트를 지원 하도록 설계 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-172">The ADO.NET DataTable and DataAdapter classes are designed to support batch updates where only modified, deleted, and new records results in any database communication.</span></span> <span data-ttu-id="dcbc6-173">DataTable의 각 행에는 행이 DataTable에 추가 되었는지, 삭제 되었는지, 수정 됨 또는 변경 되지 않은 상태로 유지 되는지를 나타내는 [`RowState` 속성이](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-173">Each row in the DataTable has a [`RowState` property](https://msdn.microsoft.com/library/system.data.datarow.rowstate.aspx) that indicates whether the row has been added to the DataTable, deleted from it, modified, or remains unchanged.</span></span> <span data-ttu-id="dcbc6-174">DataTable이 처음 채워질 때 모든 행이 변경 되지 않은 상태로 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-174">When a DataTable is initially populated, all rows are marked unchanged.</span></span> <span data-ttu-id="dcbc6-175">행 s 열의 값을 변경 하면 해당 행이 수정 된 것으로 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-175">Changing the value of any of the row s columns marks the row as modified.</span></span>

<span data-ttu-id="dcbc6-176">`SuppliersBLL` 클래스에서 먼저 단일 공급자 레코드에서 `SuppliersDataTable`으로 읽은 후 다음 코드를 사용 하 여 `Address`, `City`및 `Country` 열 값을 설정 하 여 지정 된 공급자의 주소 정보를 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-176">In the `SuppliersBLL` class we update the specified supplier s address information by first reading in the single supplier record into a `SuppliersDataTable` and then set the `Address`, `City`, and `Country` column values using the following code:</span></span>

[!code-vb[Main](performing-batch-updates-vb/samples/sample5.vb)]

<span data-ttu-id="dcbc6-177">이 코드 naively는 값이 변경 되었는지 여부에 관계 없이 `SuppliersDataTable`의 `SuppliersRow`에 전달 된 주소, 구/군/시 및 국가 값을 할당 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-177">This code naively assigns the passed-in address, city, and country values to the `SuppliersRow` in the `SuppliersDataTable` regardless of whether or not the values have changed.</span></span> <span data-ttu-id="dcbc6-178">이러한 수정으로 인해 `SuppliersRow` s `RowState` 속성이 수정 된 것으로 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-178">These modifications cause the `SuppliersRow` s `RowState` property to be marked as modified.</span></span> <span data-ttu-id="dcbc6-179">데이터 액세스 계층 s `Update` 메서드가 호출 되 면 `SupplierRow` 수정 되어 `UPDATE` 명령이 데이터베이스에 전송 되는 것을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-179">When the Data Access Layer s `Update` method is called, it sees that the `SupplierRow` has been modified and therefore sends an `UPDATE` command to the database.</span></span>

<span data-ttu-id="dcbc6-180">그러나이 메서드에 코드를 추가 하 여 전달 된 주소, 구/군/시 및 국가 값이 `SuppliersRow` 기존 값과 다를 경우에만 해당 값을 할당 한다고 가정해 보겠습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-180">Imagine, however, that we added code to this method to only assign the passed-in address, city, and country values if they differ from the `SuppliersRow` s existing values.</span></span> <span data-ttu-id="dcbc6-181">주소, 구/군/시 및 국가가 기존 데이터와 같은 경우에는 변경 내용이 적용 되지 않으며 `SupplierRow` s `RowState`는 변경 되지 않은 상태로 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-181">In the case where the address, city, and country are the same as the existing data, no changes will be made and the `SupplierRow` s `RowState` will be left marked as unchanged.</span></span> <span data-ttu-id="dcbc6-182">결과적으로 DAL s `Update` 메서드가 호출 되 면 `SuppliersRow` 수정 되지 않았기 때문에 데이터베이스를 호출 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-182">The net result is that when the DAL s `Update` method is called, no database call will be made because the `SuppliersRow` has not been modified.</span></span>

<span data-ttu-id="dcbc6-183">이러한 변경을 적용 하려면 전달 된 주소, 구/군/시 및 국가 값을 무조건 할당 하는 문을 다음 코드로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-183">To enact this change, replace the statements that blindly assign the passed-in address, city, and country values with the following code:</span></span>

[!code-vb[Main](performing-batch-updates-vb/samples/sample6.vb)]

<span data-ttu-id="dcbc6-184">이 추가 된 코드를 사용 하 여 DAL s `Update` 메서드는 주소 관련 값이 변경 된 레코드만을 위해 데이터베이스에 `UPDATE` 문을 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-184">With this added code, the DAL s `Update` method sends an `UPDATE` statement to the database for only those records whose address-related values have changed.</span></span>

<span data-ttu-id="dcbc6-185">또는 전달 된 주소 필드와 데이터베이스 데이터 사이에 차이가 있는지 여부를 추적 하 고, 없는 경우 DAL s `Update` 메서드에 대 한 호출을 무시 하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-185">Alternatively, we could keep track of whether there are any differences between the passed-in address fields and the database data and, if there are none, simply bypass the call to the DAL s `Update` method.</span></span> <span data-ttu-id="dcbc6-186">이 방법은 db direct 메서드를 다시 사용 하는 경우에 효과적으로 작동 합니다 .이 메서드는 `RowState`를 검사 하 여 데이터베이스 호출이 실제로 필요한 지 여부를 확인할 수 있는 `SuppliersRow` 인스턴스를 전달 하지 않기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-186">This approach works well if you re using the DB direct method, since the DB direct method isn t passed a `SuppliersRow` instance whose `RowState` can be checked to determine whether a database call is actually needed.</span></span>

> [!NOTE]
> <span data-ttu-id="dcbc6-187">`UpdateSupplierAddress` 메서드가 호출 될 때마다 업데이트 된 레코드에 대 한 정보를 검색 하기 위해 데이터베이스에 대 한 호출이 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-187">Each time the `UpdateSupplierAddress` method is invoked, a call is made to the database to retrieve information about the updated record.</span></span> <span data-ttu-id="dcbc6-188">그런 다음 데이터를 변경 하는 경우 데이터베이스에 대 한 다른 호출을 수행 하 여 테이블 행을 업데이트 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-188">Then, if there are any changes in data, another call to the database is made to update the table row.</span></span> <span data-ttu-id="dcbc6-189">이 워크플로는 `BatchUpdate.aspx` 페이지의 *모든* 변경 내용을 포함 하는 `EmployeesDataTable` 인스턴스를 허용 하는 `UpdateSupplierAddress` 메서드 오버 로드를 만들어 최적화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-189">This workflow could be optimized by creating an `UpdateSupplierAddress` method overload that accepts an `EmployeesDataTable` instance that has *all* of the changes from the `BatchUpdate.aspx` page.</span></span> <span data-ttu-id="dcbc6-190">그런 다음 데이터베이스에 대 한 호출을 수행 하 여 `Suppliers` 테이블의 모든 레코드를 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-190">Then, it could make one call to the database to get all of the records from the `Suppliers` table.</span></span> <span data-ttu-id="dcbc6-191">그런 다음 두 개의 결과 집합을 열거 하 고 변경 내용이 발생 한 레코드만 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-191">The two resultsets could then be enumerated and only those records where changes have occurred could be updated.</span></span>

## <a name="summary"></a><span data-ttu-id="dcbc6-192">요약</span><span class="sxs-lookup"><span data-stu-id="dcbc6-192">Summary</span></span>

<span data-ttu-id="dcbc6-193">이 자습서에서는 완전히 편집 가능한 DataList를 만드는 방법에 대해 알아보았습니다 .이를 통해 사용자는 여러 공급자의 주소 정보를 빠르게 수정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-193">In this tutorial we saw how to create a fully editable DataList, allowing a user to quickly modify the address information for multiple suppliers.</span></span> <span data-ttu-id="dcbc6-194">먼저 DataList s `ItemTemplate`의 공급자 주소, 구/군/시 및 국가 값에 대해 TextBox 웹 컨트롤을 편집 하는 인터페이스를 정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-194">We started by defining the editing interface a TextBox Web control for the supplier s address, city, and country values in the DataList s `ItemTemplate`.</span></span> <span data-ttu-id="dcbc6-195">다음에는 DataList의 위와 아래에 모두 업데이트 단추가 추가 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-195">Next, we added Update All buttons above and below the DataList.</span></span> <span data-ttu-id="dcbc6-196">사용자가 변경 내용을 적용 하 고 모두 업데이트 단추를 클릭 하면 `DataListItem` s가 열거 되 고 `SuppliersBLL` 클래스 `UpdateSupplierAddress` 메서드에 대 한 호출이 수행 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-196">After a user has made his changes and clicked one of the Update All buttons, the `DataListItem` s are enumerated and a call to the `SuppliersBLL` class s `UpdateSupplierAddress` method is made.</span></span>

<span data-ttu-id="dcbc6-197">행복 한 프로그래밍</span><span class="sxs-lookup"><span data-stu-id="dcbc6-197">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="dcbc6-198">작성자 정보</span><span class="sxs-lookup"><span data-stu-id="dcbc6-198">About the Author</span></span>

<span data-ttu-id="dcbc6-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)(7 개의 ASP/ASP. NET books 및 [4GuysFromRolla.com](http://www.4guysfromrolla.com)창립자)은 1998부터 Microsoft 웹 기술을 사용 하 여 작업 했습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-199">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="dcbc6-200">Scott은 독립 컨설턴트, 강사 및 기록기로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-200">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="dcbc6-201">최신 책은 [*24 시간 이내에 ASP.NET 2.0을 sams teach yourself*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)것입니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-201">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="dcbc6-202">mitchell@4GuysFromRolla.com에 도달할 수 있습니다 [.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-202">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="dcbc6-203">또는 블로그를 통해 [http://ScottOnWriting.NET](http://ScottOnWriting.NET)에서 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-203">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="dcbc6-204">특별히 감사 합니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-204">Special Thanks To</span></span>

<span data-ttu-id="dcbc6-205">이 자습서 시리즈는 많은 유용한 검토자가 검토 했습니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="dcbc6-206">이 자습서의 리드 검토자는 Zack Jones 및 켄은 Pespisa입니다.</span><span class="sxs-lookup"><span data-stu-id="dcbc6-206">Lead reviewers for this tutorial were Zack Jones and Ken Pespisa.</span></span> <span data-ttu-id="dcbc6-207">예정 된 MSDN 문서를 검토 하는 데 관심이 있나요?</span><span class="sxs-lookup"><span data-stu-id="dcbc6-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="dcbc6-208">그렇다면mitchell@4GuysFromRolla.com에서 줄을 삭제 [합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="dcbc6-209">[이전](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
> [다음](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="dcbc6-209">[Previous](an-overview-of-editing-and-deleting-data-in-the-datalist-vb.md)
[Next](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
title: (VB)를 삭제할 때 클라이언트 쪽 확인 추가 | Microsoft Docs
author: rick-anderson
description: 사용자는 지금까지 만든 인터페이스의 편집 단추 클릭을 의미 하는 경우 삭제 단추를 클릭 하 여 데이터를 실수로 삭제할 수 있습니다. 이 t...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 6331e02e-c465-4cdf-bd3f-f07680c289d6
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-client-side-confirmation-when-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: deae088d1daa63e2936aedf80eded18588b1ec60
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/01/2019
ms.locfileid: "57026900"
---
<a name="adding-client-side-confirmation-when-deleting-vb"></a><span data-ttu-id="c0a83-104">삭제할 때 클라이언트 쪽 확인 추가(VB)</span><span class="sxs-lookup"><span data-stu-id="c0a83-104">Adding Client-Side Confirmation When Deleting (VB)</span></span>
====================
<span data-ttu-id="c0a83-105">[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="c0a83-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="c0a83-106">[샘플 앱을 다운로드](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) 또는 [PDF 다운로드](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="c0a83-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_22_VB.exe) or [Download PDF](adding-client-side-confirmation-when-deleting-vb/_static/datatutorial22vb1.pdf)</span></span>

> <span data-ttu-id="c0a83-107">사용자는 지금까지 만든 인터페이스의 편집 단추 클릭을 의미 하는 경우 삭제 단추를 클릭 하 여 데이터를 실수로 삭제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-107">In the interfaces we've created so far, a user can accidentally delete data by clicking the Delete button when they meant to click the Edit button.</span></span> <span data-ttu-id="c0a83-108">이 자습서에서 삭제 단추를 클릭할 때 표시 되는 클라이언트 쪽 확인 대화 상자를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-108">In this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>


## <a name="introduction"></a><span data-ttu-id="c0a83-109">소개</span><span class="sxs-lookup"><span data-stu-id="c0a83-109">Introduction</span></span>

<span data-ttu-id="c0a83-110">지난 몇 가지 자습서를 통해에서는 ve를 사용 하 여 응용 프로그램 아키텍처, ObjectDataSource, 및 데이터 웹 컨트롤과 함께에서 삽입, 편집 및 삭제 기능을 제공 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-110">Over the past several tutorials we ve seen how to use our application architecture, ObjectDataSource, and the data Web controls in concert to provide inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="c0a83-111">에서는 검사 ve 인터페이스 삭제 하 고 삭제로 구성 된 지금 단추를 클릭 하 고 포스트백을 발생 시키는 ObjectDataSource가 호출 하는 경우 `Delete()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="c0a83-111">The deleting interfaces we ve examined thus far have been composed of a Delete button that, when clicked, causes a postback and invokes the ObjectDataSource s `Delete()` method.</span></span> <span data-ttu-id="c0a83-112">합니다 `Delete()` 메서드 다음으로 발급 하는 실제 데이터 액세스 계층에 호출을 전파 하는 비즈니스 논리 계층에서 구성 된 메서드를 호출 `DELETE` 데이터베이스로 문입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-112">The `Delete()` method then invokes the configured method from the Business Logic Layer, which propagates the call down to the Data Access Layer, issuing the actual `DELETE` statement to the database.</span></span>

<span data-ttu-id="c0a83-113">이 사용자 인터페이스에는 GridView, FormView DetailsView 컨트롤을 통해 레코드를 삭제 하는 방문자 수, 사용자가 삭제 단추를 클릭 하면 모든 종류를의 확인 없습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-113">While this user interface enables visitors to delete records through the GridView, DetailsView, or FormView controls, it lacks any sort of confirmation when the user clicks the Delete button.</span></span> <span data-ttu-id="c0a83-114">사용자가 클릭 하면 실수로 삭제 단추 클릭을 의미 하는 경우 편집, 업데이트 하려는 해당 레코드를 삭제할 수 대신 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-114">If a user accidentally clicks the Delete button when they meant to click Edit, the record they meant to update will instead be deleted.</span></span> <span data-ttu-id="c0a83-115">이 자습서에서는이 방지 하려면 삭제 단추를 클릭할 때 표시 되는 클라이언트 쪽 확인 대화 상자를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-115">To help prevent this, in this tutorial we'll add a client-side confirmation dialog box that appears when the Delete button is clicked.</span></span>

<span data-ttu-id="c0a83-116">JavaScript `confirm(string)` 함수 확인 두 단추-와 함께 제공 됩니다 (그림 1 참조)를 취소 하는 모달 대화 상자 내에서 텍스트 문자열 입력된 매개 변수를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-116">The JavaScript `confirm(string)` function displays its string input parameter as the text inside a modal dialog box that comes equipped with two buttons - OK and Cancel (see Figure 1).</span></span> <span data-ttu-id="c0a83-117">합니다 `confirm(string)` 어떤 단추에 따라 부울 값을 반환 하는 함수 (`true`확인을 클릭 하면, 및 `false` 취소 클릭 하는 경우).</span><span class="sxs-lookup"><span data-stu-id="c0a83-117">The `confirm(string)` function returns a Boolean value depending on what button is clicked (`true`, if the user clicks OK, and `false` if they click Cancel).</span></span>


![표시 됩니다는 모달 Messagebox 클라이언트 쪽 JavaScript confirm(string) 메서드](adding-client-side-confirmation-when-deleting-vb/_static/image1.png)

<span data-ttu-id="c0a83-119">**그림 1**: JavaScript `confirm(string)` 모달, 클라이언트 쪽 Messagebox를 표시 하는 메서드</span><span class="sxs-lookup"><span data-stu-id="c0a83-119">**Figure 1**: The JavaScript `confirm(string)` Method Displays a Modal, Client-Side Messagebox</span></span>


<span data-ttu-id="c0a83-120">값 없이 폼 전송 하는 동안 `false` 가 반환 되는 클라이언트측 이벤트 처리기에서 폼 제출을 취소 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-120">During a form submission, if a value of `false` is returned from a client-side event handler then the form submission is cancelled.</span></span> <span data-ttu-id="c0a83-121">이 기능을 사용 수 있다고 Delete 단추의 클라이언트측 `onclick` 이벤트 처리기에 대 한 호출의 값을 반환 `confirm("Are you sure you want to delete this product?")`합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-121">Using this feature, we can have the Delete button s client-side `onclick` event handler return the value of a call to `confirm("Are you sure you want to delete this product?")`.</span></span> <span data-ttu-id="c0a83-122">사용자가 [취소]를 클릭 하면 `confirm(string)` false에 취소 하려면 폼 제출을 발생을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-122">If the user clicks Cancel, `confirm(string)` will return false, thereby causing the form submission to cancel.</span></span> <span data-ttu-id="c0a83-123">다시 게시를 사용 하 여 t 작업이 적용 된 삭제 단추를 클릭 한 제품 삭제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-123">With no postback, the product whose Delete button was clicked won t be deleted.</span></span> <span data-ttu-id="c0a83-124">그러나 확인 대화 상자에서 확인을 클릭 하는 경우 포스트백 지날수록 계속 하 고 제품 삭제 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-124">If, however, the user clicks OK in the confirmation dialog box, the postback will continue unabated and the product will be deleted.</span></span> <span data-ttu-id="c0a83-125">참조 하세요 [JavaScript를 사용 하 여 s `confirm()` 컨트롤이 폼 제출을 방법](http://www.webreference.com/programming/javascript/confirm/) 이 기술에 대 한 자세한 내용은 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-125">Consult [Using JavaScript s `confirm()` Method to Control Form Submission](http://www.webreference.com/programming/javascript/confirm/) for more information on this technique.</span></span>

<span data-ttu-id="c0a83-126">필요한 클라이언트 측 스크립트 추가 CommandField를 사용할 때 보다 템플릿을 사용 하는 경우 약간 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-126">Adding the necessary client-side script differs slightly if using templates than when using a CommandField.</span></span> <span data-ttu-id="c0a83-127">따라서이 자습서에서는 살펴보겠습니다 FormView 및 GridView 예제입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-127">Therefore, in this tutorial we will look at both a FormView and GridView example.</span></span>

> [!NOTE]
> <span data-ttu-id="c0a83-128">클라이언트 쪽 확인 기술을 사용 하 여,이 자습서에 설명 된 것과 같은 가정 JavaScript를 지 원하는 브라우저를 사용 하 여 사용자가 방문 하는 있고 JavaScript를 사용 하도록 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-128">Using client-side confirmation techniques, like the ones discussed in this tutorial, assumes that your users are visiting with browsers that support JavaScript and that they have JavaScript enabled.</span></span> <span data-ttu-id="c0a83-129">특정 사용자에 대 한 true 이러한 가정을 하나 없으면 삭제 단추를 클릭 하는 즉시 포스트백을 발생 (확인 messagebox 표시 되지 않음).</span><span class="sxs-lookup"><span data-stu-id="c0a83-129">If either of these assumptions are not true for a particular user, clicking the Delete button will immediately cause a postback (not displaying a confirm messagebox).</span></span>


## <a name="step-1-creating-a-formview-that-supports-deletion"></a><span data-ttu-id="c0a83-130">1단계: 삭제를 지 원하는 FormView 만들기</span><span class="sxs-lookup"><span data-stu-id="c0a83-130">Step 1: Creating a FormView That Supports Deletion</span></span>

<span data-ttu-id="c0a83-131">FormView를 추가 하 여 시작 합니다 `ConfirmationOnDelete.aspx` 페이지를 `EditInsertDelete` 폴더를 통해 제품 정보를 다시 가져오는 새 ObjectDataSource에 바인딩하지는 `ProductsBLL` s 클래스 `GetProducts()` 메서드.</span><span class="sxs-lookup"><span data-stu-id="c0a83-131">Start by adding a FormView to the `ConfirmationOnDelete.aspx` page in the `EditInsertDelete` folder, binding it to a new ObjectDataSource that pulls back the product information via the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="c0a83-132">ObjectDataSource를 구성할 수도 있도록를 `ProductsBLL` s 클래스 `DeleteProduct(productID)` 메서드가 ObjectDataSource가 매핑되는 `Delete()` 메서드 드롭 다운 목록 (없음)로 INSERT 및 UPDATE 탭 있는지 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-132">Also configure the ObjectDataSource so that the `ProductsBLL` class s `DeleteProduct(productID)` method is mapped to the ObjectDataSource s `Delete()` method; ensure that the INSERT and UPDATE tabs drop-down lists are set to (None).</span></span> <span data-ttu-id="c0a83-133">마지막으로, FormView s 스마트 태그의 페이징 사용 확인란을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-133">Finally, check the Enable Paging checkbox in the FormView s smart tag.</span></span>

<span data-ttu-id="c0a83-134">이러한 단계 후 새 ObjectDataSource가 선언적 태그는 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-134">After these steps, the new ObjectDataSource s declarative markup will look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample1.aspx)]

<span data-ttu-id="c0a83-135">낙관적 동시성을 사용 하지 않는 이전 예제와 같이 잠시 ObjectDataSource가 지울 `OldValuesParameterFormatString` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-135">As in our past examples that did not use optimistic concurrency, take a moment to clear out the ObjectDataSource s `OldValuesParameterFormatString` property.</span></span>

<span data-ttu-id="c0a83-136">FormView s 삭제만 지 원하는 ObjectDataSource 컨트롤에 바인딩된 것 이므로 `ItemTemplate` 만 삭제 단추 없는 신규 및 업데이트 단추를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-136">Since it has been bound to an ObjectDataSource control that only supports deleting, the FormView s `ItemTemplate` offers only the Delete button, lacking the New and Update buttons.</span></span> <span data-ttu-id="c0a83-137">FormView s 선언적 태그에 포함 되어 있습니다를 불필요 `EditItemTemplate` 및 `InsertItemTemplate`를 제거할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-137">The FormView s declarative markup, however, includes a superfluous `EditItemTemplate` and `InsertItemTemplate`, which can be removed.</span></span> <span data-ttu-id="c0a83-138">잠시 사용자 지정 하는 `ItemTemplate` 하므로 즉 제품의 하위 집합만 데이터 필드를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-138">Take a moment to customize the `ItemTemplate` so that is shows only a subset of the product data fields.</span></span> <span data-ttu-id="c0a83-139">I ve 구성에서 s 제품 이름을 표시 하려면 마이닝는 `<h3>` 해당 공급 업체 이름, 범주 이름 (함께 삭제 단추) 위에 제목입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-139">I ve configured mine to show the product s name in an `<h3>` heading above its supplier and category names (along with the Delete button).</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample2.aspx)]

<span data-ttu-id="c0a83-140">이러한 변화를 통해 삭제 단추를 클릭 하 여 제품을 삭제 하는 기능을 사용 하 여 한 번에 한 제품 간을 전환 하려면 사용자를 허용 하는 웹 페이지를 완벽 하 게 작동 했습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-140">With these changes, we have a fully functional web page that allows a user to toggle through the products one at a time, with the ability to delete a product by simply clicking the Delete button.</span></span> <span data-ttu-id="c0a83-141">그림 2 브라우저를 통해 볼 때 지금 스크린샷을 진행 상황을 보여줍니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-141">Figure 2 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="c0a83-142">[![FormView 단일 제품에 대 한 정보를 보여 줍니다.](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="c0a83-142">[![The FormView Shows Information About a Single Product](adding-client-side-confirmation-when-deleting-vb/_static/image3.png)](adding-client-side-confirmation-when-deleting-vb/_static/image2.png)</span></span>

<span data-ttu-id="c0a83-143">**그림 2**: FormView 표시 정보에 대 한는 단일 제품 ([클릭 하 여 큰 이미지 보기](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="c0a83-143">**Figure 2**: The FormView Shows Information About a Single Product ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image4.png))</span></span>


## <a name="step-2-calling-the-confirmstring-function-from-the-delete-buttons-client-side-onclick-event"></a><span data-ttu-id="c0a83-144">2단계: 삭제 단추-클라이언트측 onclick 이벤트에서에서 confirm(string) 함수 호출</span><span class="sxs-lookup"><span data-stu-id="c0a83-144">Step 2: Calling the confirm(string) Function from the Delete Buttons Client-Side onclick Event</span></span>

<span data-ttu-id="c0a83-145">마지막 단계는 만든 FormView를 사용 하 여 구성 된 삭제 단추를 때가 방문자를 JavaScript에서 s 클릭 `confirm(string)` 함수가 호출 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-145">With the FormView created, the final step is to configure the Delete button such that when it s clicked by the visitor, the JavaScript `confirm(string)` function is invoked.</span></span> <span data-ttu-id="c0a83-146">단추나 LinkButton, ImageButton의 클라이언트 쪽에 클라이언트 측 스크립트 추가 `onclick` 이벤트를 사용 하 여 수행할 수 있습니다는 `OnClientClick property`, ASP.NET 2.0에는 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-146">Adding client-side script to a Button, LinkButton, or ImageButton s client-side `onclick` event can be accomplished through the use of the `OnClientClick property`, which is new to ASP.NET 2.0.</span></span> <span data-ttu-id="c0a83-147">값을 가질 것 이므로 `confirm(string)` 함수 반환이 속성을 설정 하기만 하면 됩니다. `return confirm('Are you certain that you want to delete this product?');`</span><span class="sxs-lookup"><span data-stu-id="c0a83-147">Since we want to have the value of the `confirm(string)` function returned, simply set this property to: `return confirm('Are you certain that you want to delete this product?');`</span></span>

<span data-ttu-id="c0a83-148">이 변경 후 삭제 LinkButton s 선언적 구문을 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-148">After this change the Delete LinkButton s declarative syntax should look something like:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample3.aspx)]

<span data-ttu-id="c0a83-149">S 모두 완료 되었습니다!</span><span class="sxs-lookup"><span data-stu-id="c0a83-149">That s all there is to it!</span></span> <span data-ttu-id="c0a83-150">그림 3 작업에서이 확인의 스크린 샷을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-150">Figure 3 shows a screen shot of this confirmation in action.</span></span> <span data-ttu-id="c0a83-151">확인 대화 상자를 엽니다 삭제 단추를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-151">Clicking the Delete button brings up the confirm dialog box.</span></span> <span data-ttu-id="c0a83-152">사용자가 취소 클릭 하면 포스트백 취소 되 고 제품 삭제 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-152">If the user clicks Cancel, the postback is cancelled and the product is not deleted.</span></span> <span data-ttu-id="c0a83-153">포스트백 계속 경우 단, 사용자가 확인 및 ObjectDataSource의 `Delete()` 메서드가 호출 되 면 삭제 하 고 데이터베이스 레코드의 정점입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-153">If, however, the user clicks OK, the postback continues and the ObjectDataSource s `Delete()` method is invoked, culminating in the database record being deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="c0a83-154">에 전달 된 문자열을 `confirm(string)` JavaScript 함수는 아포스트로피 (인용 부호 아님)를 사용 하 여 구분 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-154">The string passed into the `confirm(string)` JavaScript function is delimited with apostrophes (rather than quotation marks).</span></span> <span data-ttu-id="c0a83-155">JavaScript에서 문자열 문자 중 하나를 사용 하 여 구분할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-155">In JavaScript, strings can be delimited using either character.</span></span> <span data-ttu-id="c0a83-156">여기에서 사용 아포스트로피 문자열 구분 기호에 전달 되도록 `confirm(string)` 에 사용 되는 구분 기호를 사용 하 여 모호성을 발생 하지는 `OnClientClick` 속성 값입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-156">We use apostrophes here so that the delimiters for the string passed into `confirm(string)` do not introduce an ambiguity with the delimiters used for the `OnClientClick` property value.</span></span>


<span data-ttu-id="c0a83-157">[![확인은 이제 표시 된 경우 삭제 단추를 클릭](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="c0a83-157">[![A Confirmation is Now Displayed When Clicking the Delete Button](adding-client-side-confirmation-when-deleting-vb/_static/image6.png)](adding-client-side-confirmation-when-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="c0a83-158">**그림 3**: 확인은 이제 표시 된 경우 삭제 단추를 클릭 ([클릭 하 여 큰 이미지 보기](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="c0a83-158">**Figure 3**: A Confirmation is Now Displayed When Clicking the Delete Button ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image7.png))</span></span>


## <a name="step-3-configuring-the-onclientclick-property-for-the-delete-button-in-a-commandfield"></a><span data-ttu-id="c0a83-159">3단계: CommandField의 삭제 단추에 대 한 OnClientClick 속성을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-159">Step 3: Configuring the OnClientClick Property for the Delete Button in a CommandField</span></span>

<span data-ttu-id="c0a83-160">에서 작업할 때 단추나 LinkButton, ImageButton 템플릿에서 직접 확인 대화 상자와 연결할 수 있습니다이 간단히 구성 하 여 해당 `OnClientClick` JavaScript의 결과 반환할 속성 `confirm(string)` 함수입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-160">When working with a Button, LinkButton, or ImageButton directly in a template, a confirmation dialog box can be associated with it by simply configuring its `OnClientClick` property to return the results of the JavaScript `confirm(string)` function.</span></span> <span data-ttu-id="c0a83-161">그러나-추가 하는 필드 삭제 단추의 GridView 또는 DetailsView-CommandField 없는 `OnClientClick` 선언적으로 설정할 수 있는 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-161">However, the CommandField - which adds a field of Delete buttons to a GridView or DetailsView - does not have an `OnClientClick` property that can be set declaratively.</span></span> <span data-ttu-id="c0a83-162">대신 적절 한 GridView 또는 DetailsView s에 삭제 단추를 프로그래밍 방식으로 참조 해야 합니다 `DataBound` 이벤트 처리기를 설정 하 고 해당 `OnClientClick` 속성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-162">Instead, we must programmatically reference the Delete button in the GridView or DetailsView s appropriate `DataBound` event handler, and then set its `OnClientClick` property there.</span></span>

> [!NOTE]
> <span data-ttu-id="c0a83-163">S 삭제 단추를 설정 하는 경우 `OnClientClick` 속성에 적절 한 `DataBound` 이벤트 처리기에 액세스할 수는 데이터는 현재 레코드에 바인딩 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-163">When setting the Delete button s `OnClientClick` property in the appropriate `DataBound` event handler, we have access to the data was bound to the current record.</span></span> <span data-ttu-id="c0a83-164">즉, "Are you Chai 제품을 삭제 하 시겠습니까?" 확인 메시지와 같은 특정 레코드에 대 한 세부 정보를 포함 하도록 확장할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-164">This means we can extend the confirmation message to include details about the particular record, such as, "Are you sure you want to delete the Chai product?"</span></span> <span data-ttu-id="c0a83-165">이러한 사용자 지정 데이터 바인딩 구문을 사용 하 여 템플릿에서 가능 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-165">Such customization is also possible in templates using databinding syntax.</span></span>


<span data-ttu-id="c0a83-166">실제로 설정 된 `OnClientClick` CommandField, let s에에서 삭제 단추에 대 한 속성 페이지에 GridView를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-166">To practice setting the `OnClientClick` property for the Delete button(s) in a CommandField, let s add a GridView to the page.</span></span> <span data-ttu-id="c0a83-167">이 GridView FormView 사용 하는 동일한 ObjectDataSource 컨트롤을 사용 하도록 구성 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-167">Configure this GridView to use the same ObjectDataSource control that the FormView uses.</span></span> <span data-ttu-id="c0a83-168">GridView의 BoundFields 제품의 이름, 범주 및 공급자만 포함 하도록 제한할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-168">Also limit the GridView s BoundFields to only include the product s name, category, and supplier.</span></span> <span data-ttu-id="c0a83-169">마지막으로, GridView가 스마트 태그에서 삭제 사용 확인란을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-169">Lastly, check the Enable Deleting checkbox from the GridView s smart tag.</span></span> <span data-ttu-id="c0a83-170">이렇게를 CommandField GridView s에 추가 됩니다 `Columns` 컬렉션과 해당 `ShowDeleteButton` 속성으로 설정 `true`합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-170">This will add a CommandField to the GridView s `Columns` collection with its `ShowDeleteButton` property set to `true`.</span></span>

<span data-ttu-id="c0a83-171">다음과 같이 변경한 후 GridView가 선언적 태그는 다음과 같이 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-171">After making these changes, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample4.aspx)]

<span data-ttu-id="c0a83-172">CommandField GridView s에서 프로그래밍 방식으로 액세스할 수 있는 단일 삭제 LinkButton 인스턴스가 포함 `RowDataBound` 이벤트 처리기입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-172">The CommandField contains a single Delete LinkButton instance that can be accessed programmatically from the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="c0a83-173">설정할 수 있습니다 참조 되 면 해당 `OnClientClick` 속성 적절 하 게 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-173">Once referenced, we can set its `OnClientClick` property accordingly.</span></span> <span data-ttu-id="c0a83-174">에 대 한 이벤트 처리기 만들기는 `RowDataBound` 다음 코드를 사용 하 여 이벤트:</span><span class="sxs-lookup"><span data-stu-id="c0a83-174">Create an event handler for the `RowDataBound` event using the following code:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample5.vb)]

<span data-ttu-id="c0a83-175">이 이벤트 처리기는 데이터 행 (해당 삭제 단추에 있는)를 사용 하 여 작동 하 고 삭제 단추를 프로그래밍 방식으로 참조 하 여 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-175">This event handler works with data rows (those that will have the Delete button) and begins by programmatically referencing the Delete button.</span></span> <span data-ttu-id="c0a83-176">일반적인 패턴을 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-176">In general use the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample6.vb)]

<span data-ttu-id="c0a83-177">*ButtonType* 유형 CommandField-단추나 LinkButton, imagebutton이 사용 되는 단추입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-177">*ButtonType* is the type of button being used by the CommandField - Button, LinkButton, or ImageButton.</span></span> <span data-ttu-id="c0a83-178">기본적으로 CommandField Linkbutton을를 사용 하지만 CommandField s를 통해 사용자 지정할 수 있습니다이 `ButtonType property`합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-178">By default, the CommandField uses LinkButtons, but this can be customized via the CommandField s `ButtonType property`.</span></span> <span data-ttu-id="c0a83-179">합니다 *commandFieldIndex* GridView s 내 CommandField의 서 수 인덱스 `Columns` 컬렉션 반면 합니다 *controlIndex* CommandField s에 삭제 단추의 인덱스 `Controls` 컬렉션입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-179">The *commandFieldIndex* is the ordinal index of the CommandField within the GridView s `Columns` collection, whereas the *controlIndex* is the index of the Delete button within the CommandField s `Controls` collection.</span></span> <span data-ttu-id="c0a83-180">합니다 *controlIndex* 값은 CommandField 다른 단추를 기준으로 단추의 위치에 따라 달라 집니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-180">The *controlIndex* value depends on the button s position relative to other buttons in the CommandField.</span></span> <span data-ttu-id="c0a83-181">예를 들어 삭제 단추는 CommandField에 표시 되는 단추를 사용 하는 경우 인덱스 0 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-181">For example, if the only button displayed in the CommandField is the Delete button, use an index of 0.</span></span> <span data-ttu-id="c0a83-182">그러나 있는 s 삭제 단추 앞에 오는 편집 단추를 사용의 인덱스 2입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-182">If, however, there s an Edit button that precedes the Delete button, use an index of 2.</span></span> <span data-ttu-id="c0a83-183">삭제 단추 전에 CommandField 하 여 두 개의 추가 되기 때문에 2의 인덱스가 사용 되는 이유는: 편집 단추와는 LiteralControl s 편집 및 삭제 단추 사이의 공간을 추가 하는 데 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-183">The reason an index of 2 is used is because two controls are added by the CommandField before the Delete button: the Edit button and a LiteralControl that s used to add some space between the Edit and Delete buttons.</span></span>

<span data-ttu-id="c0a83-184">특정 예제는 CommandField Linkbutton을 사용 하 여을 가장 왼쪽 필드에 있는 한 *commandFieldIndex* 0입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-184">For our particular example, the CommandField uses LinkButtons and, being the left-most field, has a *commandFieldIndex* of 0.</span></span> <span data-ttu-id="c0a83-185">다른 단추가 없습니다 있지만 CommandField에서 삭제 단추를 없으므로 사용 하 여는 *controlIndex* 0입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-185">Since there are no other buttons but the Delete button in the CommandField, we use a *controlIndex* of 0.</span></span>

<span data-ttu-id="c0a83-186">CommandField에서 삭제 단추를 참조 한 후 다음 현재 GridView 행에 바인딩된 제품에 대 한 정보를 얻을 것입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-186">After referencing the Delete button in the CommandField, we next grab information about the product bound to the current GridView row.</span></span> <span data-ttu-id="c0a83-187">마지막으로, s 삭제 단추를 설정 했습니다 `OnClientClick`의 제품 이름을 포함 하는 적절 한 JavaScript에는 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-187">Finally, we set the Delete button s `OnClientClick` property to the appropriate JavaScript, which includes the product s name.</span></span> <span data-ttu-id="c0a83-188">JavaScript 문자열에 전달 되므로 `confirm(string)` 함수의 제품 이름 내에 나타나는 모든 아포스트로피를 이스케이프 처리 해야 했습니다 아포스트로피를 사용 하 여 구분 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-188">Since the JavaScript string passed into the `confirm(string)` function is delimited using apostrophes we must escape any apostrophes that appear within the product s name.</span></span> <span data-ttu-id="c0a83-189">S 제품 이름에 아포스트로피가 사용 하 여 이스케이프 되는 특히 "`\'`"입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-189">In particular, any apostrophes in the product s name are escaped with "`\'`".</span></span>

<span data-ttu-id="c0a83-190">이러한 변경 내용 전체를 사용 하 여 사용자 지정된 확인 대화 상자 (그림 4 참조) 하는 GridView 디스플레이에서 삭제 단추를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-190">With these changes complete, clicking on a Delete button in the GridView displays a customized confirmation dialog box (see Figure 4).</span></span> <span data-ttu-id="c0a83-191">으로 FormView에서 확인 messagebox를 사용 하 여 취소를 클릭 하면 포스트백 취소 되 삭제가 발생을 방지 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-191">As with the confirmation messagebox from the FormView, if the user clicks Cancel the postback is cancelled, thereby preventing the deletion from occurring.</span></span>

> [!NOTE]
> <span data-ttu-id="c0a83-192">이 기술은 프로그래밍 방식으로 액세스 한 DetailsView에서 CommandField 있는 삭제 단추의 데도 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-192">This technique can also be used to programmatically access the Delete button in the CommandField in a DetailsView.</span></span> <span data-ttu-id="c0a83-193">그러나 DetailsView, d 만들어야에 대 한 이벤트 처리기를 `DataBound` DetailsView 없으므로 이벤트는 `RowDataBound` 이벤트입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-193">For the DetailsView, however, you d create an event handler for the `DataBound` event, since the DetailsView does not have a `RowDataBound` event.</span></span>


<span data-ttu-id="c0a83-194">[![사용자 지정된 확인 대화 상자를 표시 GridView의 삭제 단추를 클릭 합니다.](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="c0a83-194">[![Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box](adding-client-side-confirmation-when-deleting-vb/_static/image9.png)](adding-client-side-confirmation-when-deleting-vb/_static/image8.png)</span></span>

<span data-ttu-id="c0a83-195">**그림 4**: 사용자 지정 확인 대화 상자를 표시 GridView의 삭제 단추를 클릭 하면 ([클릭 하 여 큰 이미지 보기](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="c0a83-195">**Figure 4**: Clicking the GridView s Delete Button Displays a Customized Confirmation Dialog Box ([Click to view full-size image](adding-client-side-confirmation-when-deleting-vb/_static/image10.png))</span></span>


## <a name="using-templatefields"></a><span data-ttu-id="c0a83-196">TemplateFields 사용</span><span class="sxs-lookup"><span data-stu-id="c0a83-196">Using TemplateFields</span></span>

<span data-ttu-id="c0a83-197">CommandField의 단점 중 하나는 인덱싱을 통해 해당 단추에 액세스 해야 하 고 결과 개체는 (단추, LinkButton, 또는 ImageButton) 단추를 적절 한 형식으로 캐스팅 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-197">One of the disadvantages of the CommandField is that its buttons must be accessed through indexing and that the resulting object must be cast to the appropriate button type (Button, LinkButton, or ImageButton).</span></span> <span data-ttu-id="c0a83-198">"매직 넘버" 및 하드 코드 된 형식을 사용 하 여 런타임 시까지 검색 될 수 없는 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-198">Using "magic numbers" and hard-coded types invites problems that cannot be discovered until runtime.</span></span> <span data-ttu-id="c0a83-199">예를 들어, 사용자 또는 다른 개발자에 게 (예: 편집 단추) 나중에 특정 시점 또는 변경 CommandField에 새 단추를 추가 하는 경우는 `ButtonType` 속성을 기존 코드는 여전히 오류 없이 컴파일되지만 페이지를 방문 하는 예외를 일으킬 수 또는 코드를 작성 하는 방법 및 적용 된 변경 내용에 따라 예기치 않은 동작입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-199">For example, if you, or another developer, adds new buttons to the CommandField at some point in the future (such as an Edit button) or changes the `ButtonType` property, the existing code will still compile without error, but visiting the page may cause an exception or unexpected behavior, depending on how your code was written and what changes were made.</span></span>

<span data-ttu-id="c0a83-200">GridView 및 DetailsView의 CommandFields TemplateFields 변환 하는 또 다른 방법은 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-200">An alternative approach is to convert the GridView and DetailsView s CommandFields into TemplateFields.</span></span> <span data-ttu-id="c0a83-201">사용 하 여 templatefield로 생성 됩니다는 `ItemTemplate` 는 LinkButton (단추 또는 ImageButton)는 CommandField의 각 단추에 있는 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-201">This will generate a TemplateField with an `ItemTemplate` that has a LinkButton (or Button or ImageButton) for each button in the CommandField.</span></span> <span data-ttu-id="c0a83-202">이러한 단추 `OnClientClick` FormView, 향상 된 것 또는 적절 한에 프로그래밍 방식으로 액세스할 수 있습니다 속성 선언적으로 할당할 수 있습니다 `DataBound` 패턴을 사용 하 여 이벤트 처리기:</span><span class="sxs-lookup"><span data-stu-id="c0a83-202">These buttons `OnClientClick` properties can be assigned declaratively, as we saw with the FormView, or can be programmatically accessed in the appropriate `DataBound` event handler using the following pattern:</span></span>


[!code-vb[Main](adding-client-side-confirmation-when-deleting-vb/samples/sample7.vb)]

<span data-ttu-id="c0a83-203">여기서 *controlID* s 단추의 값인 `ID` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-203">Where *controlID* is the value of the button s `ID` property.</span></span> <span data-ttu-id="c0a83-204">이 패턴 여전히 하드 코드 된 형식에 대 한 필요한 캐스팅 하는 동안 해당 필요가 인덱싱에 대 한 레이아웃을 런타임 오류가 발생 하지 않고 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-204">While this pattern still requires a hard-coded type for the cast, it removes the need for indexing, allowing for the layout to change without resulting in a runtime error.</span></span>

## <a name="summary"></a><span data-ttu-id="c0a83-205">요약</span><span class="sxs-lookup"><span data-stu-id="c0a83-205">Summary</span></span>

<span data-ttu-id="c0a83-206">JavaScript `confirm(string)` 함수는 제어 양식 제출 워크플로 일반적으로 사용 되는 기술입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-206">The JavaScript `confirm(string)` function is a commonly used technique for controlling form submission workflow.</span></span> <span data-ttu-id="c0a83-207">를 실행 하는 경우 함수는 OK 및 Cancel 단추를 포함 하는 모달, 클라이언트 쪽 대화 상자를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-207">When executed, the function displays a modal, client-side dialog box that includes two buttons, OK and Cancel.</span></span> <span data-ttu-id="c0a83-208">확인을 클릭 하면 합니다 `confirm(string)` 함수에서 반환 `true`; 취소를 클릭 하면 반환 `false`합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-208">If the user clicks OK, the `confirm(string)` function returns `true`; clicking Cancel returns `false`.</span></span> <span data-ttu-id="c0a83-209">제출 프로세스 중 이벤트 처리기를 반환 하는 경우 폼 제출을 취소 하려면 브라우저의 동작을 사용 하 여이 기능을 결합 `false`, 레코드를 삭제 하는 경우 확인 messagebox를 표시 하려면 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-209">This functionality, coupled with a browser s behavior to cancel a form submission if an event handler during the submission process returns `false`, can be used to display a confirmation messagebox when deleting a record.</span></span>

<span data-ttu-id="c0a83-210">`confirm(string)` 함수를 단추 웹 컨트롤의 클라이언트 쪽을 사용 하 여 연결할 수 있습니다 `onclick` 이벤트 처리기가의 컨트롤을 통해 `OnClientClick` 속성입니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-210">The `confirm(string)` function can be associated with a Button Web control s client-side `onclick` event handler through the control s `OnClientClick` property.</span></span> <span data-ttu-id="c0a83-211">템플릿-FormView의 템플릿 중 하나 또는 DetailsView 또는 GridView-TemplateField 중 하나에서 삭제 단추를 사용 하 여 작업 하는 경우이 속성 선언적으로 또는 프로그래밍 방식으로이 자습서에서 살펴본 것 처럼 합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-211">When working with a Delete button in a template - either in one of the FormView s templates or in a TemplateField in the DetailsView or GridView - this property can be set either declaratively or programmatically, as we saw in this tutorial.</span></span>

<span data-ttu-id="c0a83-212">즐거운 프로그래밍!</span><span class="sxs-lookup"><span data-stu-id="c0a83-212">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="c0a83-213">저자 소개</span><span class="sxs-lookup"><span data-stu-id="c0a83-213">About the Author</span></span>

<span data-ttu-id="c0a83-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), 7 ASP/ASP.NET 서적의 저자 이자 설립자입니다 [4GuysFromRolla.com](http://www.4guysfromrolla.com), 1998 Microsoft 웹 기술을 사용 하 여 왔습니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-214">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="c0a83-215">Scott는 독립 컨설턴트, 강사, 그리고 기록기로 작동합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-215">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="c0a83-216">최근 저서는 [ *Sams 설명 직접 ASP.NET 2.0 24 시간 동안의*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-216">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="c0a83-217">그에 도달할 수 있습니다 [ mitchell@4GuysFromRolla.com합니다.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="c0a83-217">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="c0a83-218">찾을 수 있는 저자의 블로그를 통해 또는 [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)합니다.</span><span class="sxs-lookup"><span data-stu-id="c0a83-218">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="c0a83-219">[이전](implementing-optimistic-concurrency-vb.md)
> [다음](limiting-data-modification-functionality-based-on-the-user-vb.md)</span><span class="sxs-lookup"><span data-stu-id="c0a83-219">[Previous](implementing-optimistic-concurrency-vb.md)
[Next](limiting-data-modification-functionality-based-on-the-user-vb.md)</span></span>

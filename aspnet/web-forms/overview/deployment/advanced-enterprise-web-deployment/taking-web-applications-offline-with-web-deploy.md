---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
title: 웹 배포를 사용 하 여 웹 응용 프로그램을 오프 라인 상태로 만들기 Microsoft Docs
author: jrjlee
description: 이 항목에서는 인터넷 정보 서비스 (IIS) 웹 Depl를 사용 하 여 자동화 된 배포 기간 동안 웹 응용 프로그램을 오프 라인으로 전환 하는 방법을 설명 합니다.
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 3e9f6e7d-8967-4586-94d5-d3a122f12529
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/taking-web-applications-offline-with-web-deploy
msc.type: authoredcontent
ms.openlocfilehash: ba60664a0c3daa0650cd7e7cfc4ab9da08df3440
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/06/2020
ms.locfileid: "78422213"
---
# <a name="taking-web-applications-offline-with-web-deploy"></a><span data-ttu-id="044d0-103">웹 배포를 통해 웹 애플리케이션을 오프라인으로 전환</span><span class="sxs-lookup"><span data-stu-id="044d0-103">Taking Web Applications Offline with Web Deploy</span></span>

<span data-ttu-id="044d0-104">[Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="044d0-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="044d0-105">PDF 다운로드</span><span class="sxs-lookup"><span data-stu-id="044d0-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="044d0-106">이 항목에서는 인터넷 정보 서비스 (IIS) 웹 배포 도구 (웹 배포)를 사용 하 여 자동화 된 배포 기간 동안 웹 응용 프로그램을 오프 라인으로 전환 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-106">This topic describes how to take a web application offline for the duration of an automated deployment using the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span> <span data-ttu-id="044d0-107">웹 응용 프로그램을 검색 하는 사용자는 배포가 완료 될 때까지 *오프 라인 .htm 파일\_응용* 프로그램으로 리디렉션됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-107">Users who browse to the web application are redirected to an *App\_offline.htm* file until the deployment is complete.</span></span>

<span data-ttu-id="044d0-108">이 항목에서는 Fabrikam, i n c. 라는 가상 회사의 엔터프라이즈 배포 요구 사항을 기반으로 하는 일련의 자습서의 일부를 형성 합니다. 이 자습서 시리즈에서는 샘플 솔루션&#x2014;&#x2014;을 사용 [하 여](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)ASP.NET MVC 3 응용 프로그램, Windows Communication Foundation (WCF) 서비스 및 데이터베이스 프로젝트를 비롯 한 현실적인 복잡성의 웹 응용 프로그램을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="044d0-109">이러한 자습서의 핵심에 나오는 배포 방법은 [프로젝트 파일 이해](../web-deployment-in-the-enterprise/understanding-the-project-file.md)에 설명 된 프로젝트 파일을 이해 하는 방법에 설명 되어 있습니다 .이는 빌드 프로세스가 모든 대상 환경에 적용&#x2014;되는 빌드 명령을 포함 하는 두 개의 프로젝트 파일과 환경 특정 빌드 및 배포 설정을 포함 하는 프로젝트 파일에 의해 제어 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="044d0-110">빌드 시 환경 관련 프로젝트 파일은 환경에 관계 없는 프로젝트 파일에 병합 되어 전체 빌드 명령 집합을 형성 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="task-overview"></a><span data-ttu-id="044d0-111">작업 개요</span><span class="sxs-lookup"><span data-stu-id="044d0-111">Task Overview</span></span>

<span data-ttu-id="044d0-112">여러 시나리오에서 데이터베이스 또는 웹 서비스와 같은 관련 구성 요소를 변경 하는 동안 웹 응용 프로그램을 오프 라인 상태로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-112">In a lot of scenarios, you'll want to take a web application offline while you make changes to related components, like databases or web services.</span></span> <span data-ttu-id="044d0-113">일반적으로 IIS 및 ASP.NET에서는 IIS 웹 사이트 또는 웹 응용 프로그램의 루트 폴더에 라는\_이름의 파일을 배치 하 여이를 수행 합니다 *.*</span><span class="sxs-lookup"><span data-stu-id="044d0-113">Typically, in IIS and ASP.NET, you accomplish this by placing a file named *App\_offline.htm* in the root folder of the IIS website or web application.</span></span> <span data-ttu-id="044d0-114">*앱\_오프 라인 .htm* 파일은 표준 HTML 파일 이며 일반적으로 유지 관리로 인해 사이트를 일시적으로 사용할 수 없음을 사용자에 게 알리는 간단한 메시지를 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-114">The *App\_offline.htm* file is a standard HTML file and will usually contain a simple message advising the user that the site is temporarily unavailable due to maintenance.</span></span> <span data-ttu-id="044d0-115">*앱\_오프 라인 .htm* 파일이 웹 사이트의 루트 폴더에 있는 동안 IIS는 모든 요청을 파일에 자동으로 리디렉션합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-115">While the *App\_offline.htm* file exists in the root folder of the website, IIS will automatically redirect any requests to the file.</span></span> <span data-ttu-id="044d0-116">업데이트를 완료 한 후에는 *오프 라인 .htm 파일\_앱* 을 제거 하 고 웹 사이트에서 평소와 같은 요청 처리를 다시 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-116">When you've finished making updates, you remove the *App\_offline.htm* file and the website resumes serving requests as usual.</span></span>

<span data-ttu-id="044d0-117">웹 배포를 사용 하 여 대상 환경에 대 한 자동 또는 단일 단계 배포를 수행 하는 경우에는 앱을 추가 및 제거 하 고 *오프 라인 .htm 파일\_* 배포 프로세스에 통합 하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-117">When you use Web Deploy to perform automated or single-step deployments to a target environment, you may want to incorporate adding and removing the *App\_offline.htm* file into your deployment process.</span></span> <span data-ttu-id="044d0-118">이렇게 하려면 다음과 같은 개략적인 작업을 완료 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-118">To do this, you'll need to complete these high-level tasks:</span></span>

- <span data-ttu-id="044d0-119">배포 프로세스를 제어 하는 데 사용 하는 Microsoft Build Engine (MSBuild) 프로젝트 파일에서 배포 작업을 시작 하기 전에 응용 프로그램을 *오프 라인 .htm 파일\_* 대상 서버에 복사 하는 msbuild 대상을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-119">In the Microsoft Build Engine (MSBuild) project file that you use to control the deployment process, create an MSBuild target that copies an *App\_offline.htm* file to the destination server before any deployment tasks begin.</span></span>
- <span data-ttu-id="044d0-120">모든 배포 작업이 완료 되 면 대상 서버에서 *오프 라인 .htm 파일\_앱* 을 제거 하는 또 다른 MSBuild 대상을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-120">Add another MSBuild target that removes the *App\_offline.htm* file from the destination server when all deployment tasks are complete.</span></span>
- <span data-ttu-id="044d0-121">웹 응용 프로그램 프로젝트에서 웹 배포 호출 될 때 *앱\_오프 라인 .htm* 파일이 배포 패키지에 추가 되도록 하는 *..* n e t 파일을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-121">In the web application project, create a *.wpp.targets* file that ensures that an *App\_offline.htm* file is added to the deployment package when Web Deploy is invoked.</span></span>

<span data-ttu-id="044d0-122">이 항목에서는 이러한 절차를 수행 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-122">This topic will show you how to perform these procedures.</span></span> <span data-ttu-id="044d0-123">이 항목의 작업 및 연습에서는 웹 응용 프로그램 프로젝트가 하나 이상 포함 된 솔루션을 이미 만들었고 사용자 지정 프로젝트 파일을 사용 하 여 [엔터프라이즈의 웹 배포](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md)에 설명 된 대로 배포 프로세스를 제어 하는 것으로 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-123">The tasks and walkthroughs in this topic assume that you've already created a solution that contains at least one web application project, and that you use a custom project file to control the deployment process as described in [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md).</span></span> <span data-ttu-id="044d0-124">또는 [연락처 관리자](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) 샘플 솔루션을 사용 하 여 항목의 예제를 따를 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-124">Alternatively, you can use the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution to follow the examples in the topic.</span></span>

## <a name="adding-an-app_offline-file-to-a-web-application-project"></a><span data-ttu-id="044d0-125">웹 응용 프로그램 프로젝트에 앱\_오프 라인 파일 추가</span><span class="sxs-lookup"><span data-stu-id="044d0-125">Adding an App\_Offline File to a Web Application Project</span></span>

<span data-ttu-id="044d0-126">완료 해야 하는 첫 번째 작업은 웹 응용 프로그램 프로젝트에 *앱\_오프 라인* 파일을 추가 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-126">The first task you need to complete is to add an *App\_offline* file to your web application project:</span></span>

- <span data-ttu-id="044d0-127">파일이 개발 프로세스를 방해 하지 않도록 방지 하려면 (응용 프로그램을 영구적으로 오프 라인으로 설정 하지 않음), *앱\_오프 라인*으로 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-127">To prevent the file from interfering with the development process (you don't want your application to be permanently offline), you should call it something other than *App\_offline.htm*.</span></span> <span data-ttu-id="044d0-128">예를 들어 파일 앱의 이름을 *offline-template\_* 로 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-128">For example, you could name the file *App\_offline-template.htm*.</span></span>
- <span data-ttu-id="044d0-129">파일이 있는 그대로 배포 되지 않도록 하려면 빌드 작업을 **None**으로 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-129">To prevent the file from being deployed as-is, you should set the build action to **None**.</span></span>

<span data-ttu-id="044d0-130">**웹 응용 프로그램 프로젝트에 앱\_오프 라인 파일을 추가 하려면**</span><span class="sxs-lookup"><span data-stu-id="044d0-130">**To add an App\_offline file to a web application project**</span></span>

1. <span data-ttu-id="044d0-131">Visual Studio 2010에서 솔루션을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-131">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="044d0-132">**솔루션 탐색기** 창에서 웹 응용 프로그램 프로젝트를 마우스 오른쪽 단추로 클릭 하 고 **추가**를 가리킨 다음 **새 항목**을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-132">In the **Solution Explorer** window, right-click your web application project, point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="044d0-133">**새 항목 추가** 대화 상자에서 **HTML 페이지**를 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-133">In the **Add New Item** dialog box, select **HTML Page**.</span></span>
4. <span data-ttu-id="044d0-134">**이름** 상자에 **App\_offline-template**를 입력 한 다음 **추가**를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-134">In the **Name** box, type **App\_offline-template.htm**, and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image1.png)
5. <span data-ttu-id="044d0-135">몇 가지 간단한 HTML을 추가 하 여 응용 프로그램을 사용할 수 없음을 사용자에 게 알리고 파일을 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-135">Add some simple HTML to inform users that the application is unavailable, and then save the file.</span></span> <span data-ttu-id="044d0-136">서버 쪽 태그 (예: "asp:" 접두사가 붙은 태그)는 포함 하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="044d0-136">Do not include any server-side tags (for example, any tags that are prefixed with "asp:").</span></span> 

    ![](taking-web-applications-offline-with-web-deploy/_static/image2.png)
6. <span data-ttu-id="044d0-137">**솔루션 탐색기** 창에서 새 파일을 마우스 오른쪽 단추로 클릭 한 다음 **속성**을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-137">In the **Solution Explorer** window, right-click the new file, and then click **Properties**.</span></span>
7. <span data-ttu-id="044d0-138">**속성** 창의 **빌드 작업** 행에서 **없음**을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-138">In the **Properties** window, in the **Build Action** row, select **None**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image3.png)

## <a name="deploying-and-deleting-an-app_offline-file"></a><span data-ttu-id="044d0-139">오프 라인 파일\_앱 배포 및 삭제</span><span class="sxs-lookup"><span data-stu-id="044d0-139">Deploying and Deleting an App\_Offline File</span></span>

<span data-ttu-id="044d0-140">다음 단계는 배포 프로세스를 시작할 때 대상 서버에 파일을 복사 하 고 끝에 제거 하는 배포 논리를 수정 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-140">The next step is to modify your deployment logic to copy the file to the destination server at the start of the deployment process and remove it at the end.</span></span>

> [!NOTE]
> <span data-ttu-id="044d0-141">다음 절차에서는 [프로젝트 파일 이해](../web-deployment-in-the-enterprise/understanding-the-project-file.md)에 설명 된 대로 사용자 지정 MSBuild 프로젝트 파일을 사용 하 여 배포 프로세스를 제어 하는 것으로 가정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-141">The next procedure assumes that you're using a custom MSBuild project file to control your deployment process, as described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span> <span data-ttu-id="044d0-142">Visual Studio에서 직접 배포 하는 경우에는 다른 방법을 사용 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-142">If you're deploying direct from Visual Studio, you'll need to use a different approach.</span></span> <span data-ttu-id="044d0-143">Sayed Ibrahim Hashimi [는 게시 하는 동안 웹 앱을 오프 라인으로 전환 하는 방법에 대](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx)한 이러한 접근 방식을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-143">Sayed Ibrahim Hashimi describes one such approach in [How to Take Your Web App Offline During Publishing](http://sedodream.com/2012/01/08/HowToTakeYourWebAppOfflineDuringPublishing.aspx).</span></span>

<span data-ttu-id="044d0-144">*앱\_오프 라인* 파일을 대상 IIS 웹 사이트에 배포 하려면 [웹 배포 **contentpath** 공급자](https://technet.microsoft.com/library/dd569034(WS.10).aspx)를 사용 하 여 msdeploy.exe를 호출 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-144">To deploy an *App\_offline* file to a destination IIS website, you need to invoke MSDeploy.exe using the [Web Deploy **contentPath** provider](https://technet.microsoft.com/library/dd569034(WS.10).aspx).</span></span> <span data-ttu-id="044d0-145">**Contentpath** 공급자는 실제 디렉터리 경로와 iis 웹 사이트 또는 응용 프로그램 경로를 지원 합니다. 그러면 Visual Studio 프로젝트 폴더와 iis 웹 응용 프로그램 간에 파일을 동기화 하는 데 이상적인 선택이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-145">The **contentPath** provider supports both physical directory paths and IIS website or application paths, which makes it the ideal choice for synchronizing a file between a Visual Studio project folder and an IIS web application.</span></span> <span data-ttu-id="044d0-146">파일을 배포 하려면 다음과 같이 Msdeploy.exe 명령을 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-146">To deploy the file, your MSDeploy command should resemble this:</span></span>

[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample1.cmd)]

<span data-ttu-id="044d0-147">배포 프로세스가 끝날 때 대상 사이트에서 파일을 제거 하려면 다음 명령을 명령과 같이 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-147">To remove the file from the destination site at the end of the deployment process, your MSDeploy command should resemble this:</span></span>

[!code-console[Main](taking-web-applications-offline-with-web-deploy/samples/sample2.cmd)]

<span data-ttu-id="044d0-148">빌드 및 배포 프로세스의 일부로 이러한 명령을 자동화 하려면 사용자 지정 MSBuild 프로젝트 파일에 통합 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-148">To automate these commands as part of a build and deployment process, you need to integrate them into your custom MSBuild project file.</span></span> <span data-ttu-id="044d0-149">다음 절차에서는이 작업을 수행 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-149">The next procedure describes how to do this.</span></span>

<span data-ttu-id="044d0-150">**앱\_오프 라인 파일을 배포 및 삭제 하려면**</span><span class="sxs-lookup"><span data-stu-id="044d0-150">**To deploy and delete an App\_offline file**</span></span>

1. <span data-ttu-id="044d0-151">Visual Studio 2010에서 배포 프로세스를 제어 하는 MSBuild 프로젝트 파일을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-151">In Visual Studio 2010, open the MSBuild project file that controls your deployment process.</span></span> <span data-ttu-id="044d0-152">[Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) 샘플 솔루션에서이는 *게시 proj* 파일입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-152">In the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) sample solution, this is the *Publish.proj* file.</span></span>
2. <span data-ttu-id="044d0-153">루트 **프로젝트** 요소에서 새 **PropertyGroup** 요소를 만들어 *앱\_오프 라인* 배포에 대 한 변수를 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-153">In the root **Project** element, create a new **PropertyGroup** element to store variables for the *App\_offline* deployment:</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample3.xml)]
3. <span data-ttu-id="044d0-154">**SourceRoot** 속성은 *Publish. proj* 파일의 다른 위치에 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-154">The **SourceRoot** property is defined elsewhere in the *Publish.proj* file.</span></span> <span data-ttu-id="044d0-155">이는&#x2014; *게시 proj* 파일의 위치를 기준으로 하 여 현재 경로를 기준으로 하는 소스 콘텐츠에 대 한 루트 폴더의 위치를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-155">It indicates the location of the root folder for the source content relative to the current path&#x2014;in other words, relative to the location of the *Publish.proj* file.</span></span>
4. <span data-ttu-id="044d0-156">**Contentpath** 공급자는 상대 파일 경로를 허용 하지 않으므로 배포할 수 있으려면 먼저 원본 파일의 절대 경로를 가져와야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-156">The **contentPath** provider will not accept relative file paths, so you need to get an absolute path to your source file before you can deploy it.</span></span> <span data-ttu-id="044d0-157">[ConvertToAbsolutePath](https://msdn.microsoft.com/library/bb882668.aspx) 작업을 사용 하 여이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-157">You can use the [ConvertToAbsolutePath](https://msdn.microsoft.com/library/bb882668.aspx) task to do this.</span></span>
5. <span data-ttu-id="044d0-158">**GetAppOfflineAbsolutePath**라는 새 **Target** 요소를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-158">Add a new **Target** element named **GetAppOfflineAbsolutePath**.</span></span> <span data-ttu-id="044d0-159">이 대상 내에서 **ConvertToAbsolutePath** 작업을 사용 하 여 프로젝트 폴더에 있는 *앱\_오프 라인 템플릿* 파일의 절대 경로를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-159">Within this target, use the **ConvertToAbsolutePath** task to get an absolute path to the *App\_offline-template* file in your project folder.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample4.xml)]
6. <span data-ttu-id="044d0-160">이 대상은 프로젝트 폴더에서 *앱\_오프 라인 템플릿* 파일에 대 한 상대 경로를 사용 하 여 새 속성에 절대 파일 경로로 저장 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-160">This target takes the relative path to the *App\_offline-template* file in your project folder and saves it to a new property as an absolute file path.</span></span> <span data-ttu-id="044d0-161">**BeforeTargets** 특성은이 대상이 다음 단계에서 만들 **Deployappoffline** 대상 보다 먼저 실행 되도록 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-161">The **BeforeTargets** attribute specifies that you want this target to execute before the **DeployAppOffline** target, which you'll create in the next step.</span></span>
7. <span data-ttu-id="044d0-162">**Deployappoffline**이라는 새 대상을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-162">Add a new target named **DeployAppOffline**.</span></span> <span data-ttu-id="044d0-163">이 대상 내에서 *앱\_오프 라인* 파일을 대상 웹 서버에 배포 하는 msdeploy.exe 명령을 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-163">Within this target, invoke the MSDeploy.exe command that deploys your *App\_offline* file to the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample5.xml)]
8. <span data-ttu-id="044d0-164">이 예제에서 **ContactManagerIisPath** 속성은 프로젝트 파일의 다른 위치에 정의 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-164">In this example, the **ContactManagerIisPath** property is defined elsewhere in the project file.</span></span> <span data-ttu-id="044d0-165">이는 단순히 *[Iis 웹 사이트 이름]/[응용 프로그램 이름]* 형식의 IIS 응용 프로그램 경로입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-165">This is simply an IIS application path, in the form *[IIS Website Name]/[Application Name]*.</span></span> <span data-ttu-id="044d0-166">사용자는 대상에 조건을 포함 하 여 속성 값을 변경 하거나 명령줄 매개 변수를 제공 하 여 *오프 라인 배포를\_오프 라인* 으로 전환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-166">Including a condition in the target enables users to switch the *App\_offline* deployment on or off by changing a property value or providing a command-line parameter.</span></span>
9. <span data-ttu-id="044d0-167">**Deleteappoffline**이라는 새 대상을 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-167">Add a new target named **DeleteAppOffline**.</span></span> <span data-ttu-id="044d0-168">이 대상 내에서 대상 웹 서버에서 *앱\_오프 라인* 파일을 제거 하는 msdeploy.exe 명령을 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-168">Within this target, invoke the MSDeploy.exe command that removes your *App\_offline* file from the destination web server.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample6.xml)]
10. <span data-ttu-id="044d0-169">최종 작업은 프로젝트 파일을 실행 하는 동안 적절 한 지점에서 이러한 새 대상을 호출 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-169">The final task is to invoke these new targets at appropriate points during the execution of your project file.</span></span> <span data-ttu-id="044d0-170">다양 한 방법으로이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-170">You can do this in various ways.</span></span> <span data-ttu-id="044d0-171">예를 들어, *Publish. proj* 파일에서 **FullPublishDependsOn** 속성은 **fullpublish** 기본 대상이 호출 될 때 순서 대로 실행 해야 하는 대상 목록을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-171">For example, in the *Publish.proj* file, the **FullPublishDependsOn** property specifies a list of targets that must be executed in order when the **FullPublish** default target is invoked.</span></span>
11. <span data-ttu-id="044d0-172">게시 프로세스의 적절 한 지점에서 **deployappoffline** 및 **deleteappoffline** 대상을 호출 하도록 MSBuild 프로젝트 파일을 수정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-172">Modify your MSBuild project file to invoke the **DeployAppOffline** and **DeleteAppOffline** targets at appropriate points in the publishing process.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample7.xml)]

<span data-ttu-id="044d0-173">사용자 지정 MSBuild 프로젝트 파일을 실행 하면 성공적으로 빌드한 후 *응용 프로그램\_오프 라인* 파일이 서버에 즉시 배포 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-173">When you run your custom MSBuild project file, the *App\_offline* file will be deployed to the server immediately after a successful build.</span></span> <span data-ttu-id="044d0-174">모든 배포 작업이 완료 되 면 서버에서 삭제 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-174">It will then be deleted from the server once all the deployment tasks are complete.</span></span>

## <a name="adding-an-app_offline-file-to-deployment-packages"></a><span data-ttu-id="044d0-175">배포 패키지에 앱\_오프 라인 파일 추가</span><span class="sxs-lookup"><span data-stu-id="044d0-175">Adding an App\_Offline File to Deployment Packages</span></span>

<span data-ttu-id="044d0-176">배포를 구성 하는 방법에 따라 대상에 웹 패키지를 배포할 때 *앱\_* 와 같은 대상 IIS 웹 응용 프로그램&#x2014;&#x2014;의 모든 기존 콘텐츠를 자동으로 삭제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-176">Depending on how you configure your deployment, any existing content at the destination IIS web application&#x2014;like the *App\_offline.htm* file&#x2014;may be deleted automatically when you deploy a web package to the destination.</span></span> <span data-ttu-id="044d0-177">*응용 프로그램\_오프 라인 .htm* 파일이 배포 기간 동안 그대로 유지 되도록 하려면 배포 프로세스를 시작할 때 직접 파일을 배포 하는 것 외에도 웹 배포 패키지 자체 내에 파일을 포함 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-177">To ensure that the *App\_offline.htm* file remains in place for the duration of the deployment, you need to include the file within the web deployment package itself in addition to deploying the file directly at the start of the deployment process.</span></span>

- <span data-ttu-id="044d0-178">이 항목의 이전 작업을 수행한 후에는 *앱\_오프 라인 .htm* 파일을 다른 파일 이름으로 ( *앱\_offline-template*) 사용 하 여 웹 응용 프로그램 프로젝트에 추가 하 고 빌드 작업을 **없음**으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-178">If you've followed the previous tasks in this topic, you'll have added the *App\_offline.htm* file to your web application project under a different filename (we used *App\_offline-template.htm*) and you'll have set the build action to **None**.</span></span> <span data-ttu-id="044d0-179">이러한 변경은 파일이 개발 및 디버깅을 방해 하지 않도록 방지 하기 위해 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-179">These changes are necessary to prevent the file from interfering with development and debugging.</span></span> <span data-ttu-id="044d0-180">따라서 *앱\_오프 라인 .htm* 파일이 웹 배포 패키지에 포함 되도록 패키징 프로세스를 사용자 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-180">As a result, you need to customize the packaging process to ensure that the *App\_offline.htm* file is included in the web deployment package.</span></span>

<span data-ttu-id="044d0-181">웹 게시 파이프라인 (WPP)은 **FilesForPackagingFromProject** 라는 항목 목록을 사용 하 여 웹 배포 패키지에 포함 되어야 하는 파일 목록을 작성 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-181">The Web Publishing Pipeline (WPP) uses an item list named **FilesForPackagingFromProject** to build a list of files that should be included in the web deployment package.</span></span> <span data-ttu-id="044d0-182">이 목록에 사용자 고유의 항목을 추가 하 여 웹 패키지의 콘텐츠를 사용자 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-182">You can customize the contents of your web packages by adding your own items to this list.</span></span> <span data-ttu-id="044d0-183">이렇게 하려면 다음과 같은 개략적인 단계를 완료 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-183">To do this, you need to complete these high-level steps:</span></span>

1. <span data-ttu-id="044d0-184">프로젝트 파일과 동일한 폴더에 *[project name]. wpp. .targets* 라는 사용자 지정 프로젝트 파일을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-184">Create a custom project file named *[project name].wpp.targets* in the same folder as your project file.</span></span>

    > [!NOTE]
    > <span data-ttu-id="044d0-185">웹 응용 프로그램 프로젝트&#x2014;파일과 동일한 *폴더 (예*&#x2014;: 빌드 및 배포 프로세스를 제어 하는 데 사용 하는 사용자 지정 프로젝트 파일)와 동일한 폴더에 있어야 *합니다.*</span><span class="sxs-lookup"><span data-stu-id="044d0-185">The *.wpp.targets* file needs to go in the same folder as your web application project file&#x2014;for example, *ContactManager.Mvc.csproj*&#x2014;rather than in the same folder as any custom project files you use to control the build and deployment process.</span></span>
2. <span data-ttu-id="044d0-186">**CopyAllFilesToSingleFolderForPackage** 파일 *에서* *실행 되는 새* MSBuild 대상을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-186">In the *.wpp.targets* file, create a new MSBuild target that executes *before* the **CopyAllFilesToSingleFolderForPackage** target.</span></span> <span data-ttu-id="044d0-187">패키지에 포함할 항목의 목록을 작성 하는 WPP 대상입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-187">This is the WPP target that builds a list of things to include in the package.</span></span>
3. <span data-ttu-id="044d0-188">새 대상에서 **ItemGroup** 요소를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-188">In the new target, create an **ItemGroup** element.</span></span>
4. <span data-ttu-id="044d0-189">**ItemGroup** 요소에서 **FilesForPackagingFromProject** 항목을 추가 하 고 *오프 라인 .htm 파일\_앱* 을 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-189">In the **ItemGroup** element, add a **FilesForPackagingFromProject** item and specify the *App\_offline.htm* file.</span></span>

<span data-ttu-id="044d0-190">이 *파일은* 다음과 유사 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-190">The *.wpp.targets* file should resemble this:</span></span>

[!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample8.xml)]

<span data-ttu-id="044d0-191">다음은이 예의 핵심 사항입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-191">These are the key points of note in this example:</span></span>

- <span data-ttu-id="044d0-192">**BeforeTargets** 특성은 **CopyAllFilesToSingleFolderForPackage** 대상 바로 앞에서 실행 되도록 지정 하 여이 대상을 WPP에 삽입 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-192">The **BeforeTargets** attribute inserts this target into the WPP by specifying that it should be executed immediately before the **CopyAllFilesToSingleFolderForPackage** target.</span></span>
- <span data-ttu-id="044d0-193">**FilesForPackagingFromProject** 항목은 **DestinationRelativePath** 메타 데이터 값을 사용 하 여 목록에 추가 된 파일의 이름을 *app\_offline-template* 에서 *app\_오프 라인* 으로 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-193">The **FilesForPackagingFromProject** item uses the **DestinationRelativePath** metadata value to rename the file from *App\_offline-template.htm* to *App\_offline.htm* as it's added to the list.</span></span>

<span data-ttu-id="044d0-194">다음 절차에서는 웹 응용 프로그램 프로젝트에이 *.* n e t .targets 파일을 추가 하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-194">The next procedure shows you how to add this *.wpp.targets* file to a web application project.</span></span>

<span data-ttu-id="044d0-195">**웹 배포 패키지에. n e t .targets 파일을 추가 하려면**</span><span class="sxs-lookup"><span data-stu-id="044d0-195">**To add a .wpp.targets file to a web deployment package**</span></span>

1. <span data-ttu-id="044d0-196">Visual Studio 2010에서 솔루션을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-196">Open your solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="044d0-197">**솔루션 탐색기** 창에서 웹 응용 프로그램 프로젝트 노드를 마우스 오른쪽 단추로 클릭 하 고 (예 **:),** **추가**를 가리킨 다음 **새 항목**을 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-197">In the **Solution Explorer** window, right-click your web application project node (for example, **ContactManager.Mvc**), point to **Add**, and then click **New Item**.</span></span>
3. <span data-ttu-id="044d0-198">**새 항목 추가** 대화 상자에서 **XML 파일** 템플릿을 선택 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-198">In the **Add New Item** dialog box, select the **XML File** template.</span></span>
4. <span data-ttu-id="044d0-199">**이름** 상자에 \*[project Name] \* \* \* *..* t a g e \* (예: **의사**(...))를 입력 한 다음 **추가**를 클릭 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-199">In the **Name** box, type *[project name]\*\*\*.wpp.targets*\* (for example, **ContactManager.Mvc.wpp.targets**), and then click **Add**.</span></span>

    ![](taking-web-applications-offline-with-web-deploy/_static/image4.png)

    > [!NOTE]
    > <span data-ttu-id="044d0-200">프로젝트의 루트 노드에 새 항목을 추가 하는 경우 해당 파일은 프로젝트 파일과 동일한 폴더에 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-200">If you add a new item to the root node of a project, the file is created in the same folder as the project file.</span></span> <span data-ttu-id="044d0-201">Windows 탐색기에서 폴더를 열어이를 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-201">You can verify this by opening the folder in Windows Explorer.</span></span>
5. <span data-ttu-id="044d0-202">파일에서 앞에서 설명한 MSBuild 태그를 추가 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-202">In the file, add the MSBuild markup described previously.</span></span>

    [!code-xml[Main](taking-web-applications-offline-with-web-deploy/samples/sample9.xml)]
6. <span data-ttu-id="044d0-203">*[Project name] .targets .targets* 파일을 저장 한 후 닫습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-203">Save and close the *[project name].wpp.targets* file.</span></span>

<span data-ttu-id="044d0-204">다음 번에 웹 응용 프로그램 프로젝트를 빌드하고 패키지할 때 WPP는 *wpp 파일을* 자동으로 검색 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-204">The next time you build and package your web application project, the WPP will automatically detect the *.wpp.targets* file.</span></span> <span data-ttu-id="044d0-205">*앱\_offline-template* 파일은 결과 웹 배포 패키지에 *앱\_오프 라인 .htm*으로 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-205">The *App\_offline-template.htm* file will be included in the resulting web deployment package as *App\_offline.htm*.</span></span>

> [!NOTE]
> <span data-ttu-id="044d0-206">배포가 실패 하면 *앱\_오프 라인 .htm* 파일이 그대로 유지 되 고 응용 프로그램이 오프 라인 상태로 유지 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-206">If your deployment fails, the *App\_offline.htm* file will remain in place and your application will remain offline.</span></span> <span data-ttu-id="044d0-207">이는 일반적으로 원하는 동작입니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-207">This is typically the desired behavior.</span></span> <span data-ttu-id="044d0-208">응용 프로그램을 다시 온라인 상태로 전환 하려면 웹 서버에서 *오프 라인 .htm 파일\_앱* 을 삭제할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-208">To bring your application back online, you can delete the *App\_offline.htm* file from your web server.</span></span> <span data-ttu-id="044d0-209">또는 오류를 수정 하 고 성공적인 배포를 실행 하는 경우 *앱\_오프 라인 .htm* 파일이 제거 됩니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-209">Alternatively, if you correct any errors and run a successful deployment, the *App\_offline.htm* file will be removed.</span></span>

## <a name="conclusion"></a><span data-ttu-id="044d0-210">결론</span><span class="sxs-lookup"><span data-stu-id="044d0-210">Conclusion</span></span>

<span data-ttu-id="044d0-211">이 항목에서는 배포 하는\_동안 응용 프로그램을 오프 라인으로 전환 하는 방법에 대해 설명 했습니다 *.* 배포 프로세스 시작 시 대상 서버에 응용 프로그램을 오프 라인으로 설정 하 고 끝에 해당 파일을 제거 하는 방법을 설명 합니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-211">This topic described how to take a web application offline for the duration of a deployment, by publishing an *App\_offline.htm* file to the destination server at the start of the deployment process and removing it at the end.</span></span> <span data-ttu-id="044d0-212">또한 웹 배포 패키지에 *\_응용 프로그램을 오프 라인 .htm* 파일에 포함 하는 방법도 살펴보았습니다.</span><span class="sxs-lookup"><span data-stu-id="044d0-212">It also covered how to include an *App\_offline.htm* file in a web deployment package.</span></span>

## <a name="further-reading"></a><span data-ttu-id="044d0-213">추가 참고 자료</span><span class="sxs-lookup"><span data-stu-id="044d0-213">Further Reading</span></span>

<span data-ttu-id="044d0-214">패키징 및 배포 프로세스에 대 한 자세한 내용은 [웹 응용 프로그램 프로젝트 빌드 및 패키징](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [웹 패키지 배포에 대 한 매개 변수 구성](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md)및 [웹 패키지 배포](../web-deployment-in-the-enterprise/deploying-web-packages.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="044d0-214">For more information on the packaging and deployment process, see [Building and Packaging Web Application Projects](../web-deployment-in-the-enterprise/building-and-packaging-web-application-projects.md), [Configuring Parameters for Web Package Deployment](../web-deployment-in-the-enterprise/configuring-parameters-for-web-package-deployment.md), and [Deploying Web Packages](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span></span>

<span data-ttu-id="044d0-215">이러한 자습서에서 설명 하는 사용자 지정 MSBuild 프로젝트 파일 방법을 사용 하지 않고 Visual Studio에서 직접 웹 응용 프로그램을 게시 하는 경우 게시 하는 동안 약간 다른 방법을 사용 하 여 응용 프로그램을 오프 라인으로 전환 해야 합니다. 프로세스.</span><span class="sxs-lookup"><span data-stu-id="044d0-215">If you publish your web applications directly from Visual Studio, rather than using the custom MSBuild project file approach described in these tutorials, you'll need to use a slightly different approach to take your application offline during the publishing process.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="044d0-216">[이전](excluding-files-and-folders-from-deployment.md)
> [다음](running-windows-powershell-scripts-from-msbuild-project-files.md)</span><span class="sxs-lookup"><span data-stu-id="044d0-216">[Previous](excluding-files-and-folders-from-deployment.md)
[Next](running-windows-powershell-scripts-from-msbuild-project-files.md)</span></span>
